(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    416286,       9768]
NotebookOptionsPosition[    407792,       9659]
NotebookOutlinePosition[    408232,       9677]
CellTagsIndexPosition[    408189,       9674]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<Global`*\>\"", "]"}], "]"}], ">", "0"}], ",", 
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"myDir", "=", "\"\<C:\\\\Mathematica Works\>\""}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetDirectory", "[", "myDir", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"errTol", "=", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Get", "[", "\"\<InteriorPointMethod`\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Get", "[", "\"\<Cplex4Mathematica`\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Get", "[", "\"\<Cplex4MathematicaMIQP`\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Get", "[", "\"\<ParametricPolyApp`\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Get", "[", "\"\<SQPMathematica`\>\"", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\n", 
    RowBox[{"(*", 
     RowBox[{"install", " ", "cplex"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Get", "[", "\"\<NETLink`\>\"", "]"}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"UninstallNET", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"InstallNET", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "pathConcert", "=", 
     "\"\<D:\\\\IBM\\\\ILOG\\\\CPLEX_Studio126\\\\cplex\\\\bin\\\\x64_win64\\\
\\ILOG.Concert.dll\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "pathCPLEX", "=", 
     "\"\<D:\\\\IBM\\\\ILOG\\\\CPLEX_Studio126\\\\cplex\\\\bin\\\\x64_win64\\\
\\ILOG.CPLEX.dll\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"LoadNETAssembly", "[", "pathConcert", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LoadNETAssembly", "[", "pathCPLEX", "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8464090015119715`*^9, {3.846462368912285*^9, 3.8464623705243654`*^9}, {
   3.858223760380421*^9, 3.858223784457062*^9}, 3.858294500094973*^9},
 FontFamily->"Consolas",
 CellLabel->
  "(\:8c03\:8bd5) \
In[291]:=",ExpressionUUID->"a0609b4a-ef88-470a-b985-c9e50793f85a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"**", "**"}], "**", "**", "**", "**", "**"}], "**", "**", "**", 
     "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "function"}], " ", 
    RowBox[{
     RowBox[{"formulation", "**", "**", "**"}], "**", "**", "**", "**", "**", 
     "**", "**", "**", "**"}], "*", "**"}], "**********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CapaPriceDistributionProgram", "[", 
     RowBox[{
     "flagCapa_", ",", "CapaGivenVal_", ",", "horizonDispatch_", ",", 
      "periodDispatch_", 
      RowBox[{"(*", 
       RowBox[{",", "priceInner_", ",", "priceH2Inner_"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{",", "pricePurch_"}], "*)"}], ",", "IRRLower_", ",", 
      "IRRUpper_", ",", "nDiscret_", ",", "boundarypriceInner_", ",", 
      "boundarypriceH2Inner_", ",", "itrdays_", ",", "flagGrid_", ",", 
      "ExchangeRate_", ",", "periodTOU_", ",", "flagTOUH_", ",", "TOUHYear_", 
      ",", "priceFITGVal_", ",", "flagTOUHPurch_", ",", "TOUHYearPurch_", ",",
       "pricePurchGVal_", ",", "priceNH3_", ",", "ratepAEMin_", ",", 
      "LoadNH3Min_", ",", "rateDiscount_", ",", "flagOverShootLimit_", ",", 
      "RateTimeOverShoot_", ",", "coeffPunish_", ",", "flagMMA_", ",", 
      "ConstCapacityMonth_", ",", "flagConnected_", ",", "flagBatExist_", ",",
       "flagPlace_", ",", " ", 
      RowBox[{"(*", 
       RowBox[{
       "WTS_", ",", "flagWTS_", ",", "Gridratio_", ",", "flagGridratio_", 
        ","}], "*)"}], "buffer_", ",", "flagbuffer_", ",", " ", "EL_", ",", 
      " ", "flagEL_", ",", " ", "constG2L_", ",", " ", "ETotal_", ",", " ", 
      "yitaP2H_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**"}], "*", " ", "System", " ", 
        RowBox[{"Modeling", " ", "**", "**", "**"}], "*", 
        RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}]}], 
       "*******)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Battery", "/", "Li"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"capacityBattery", "=", "0.1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PbatMax", "=", "1000"}], ";", 
       RowBox[{"(*", 
        RowBox[{"35", "MW"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"PbatMin", "=", 
        RowBox[{"-", "0.1"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"35", "MW"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EbatMax", "=", "0.1"}], ";", 
       RowBox[{"(*", 
        RowBox[{"35", "MWh"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SOCiniVal", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SOCMin", "=", "0.1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SOCMax", "=", "0.9"}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsCtrlBat", "=", 
        RowBox[{"{", 
         RowBox[{"PbatCh", ",", "PbatDisc"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsStateBat", "=", 
        RowBox[{"{", "ESOC", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"boolsBatA", "=", 
        RowBox[{"{", "boolsBat", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equStateBat", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"alphaBat", "=", 
        RowBox[{"0.5", "*", 
         RowBox[{
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"-", "2"}]}], "/", "24"}], "/", "3600"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"betaBatCh", "=", "0.95"}], ";", "\[IndentingNewLine]", 
       RowBox[{"betaBatDisc", "=", 
        RowBox[{"1", "/", "0.95"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsCapaBatA", "=", 
        RowBox[{"{", "varsCapaBat", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MaxPbatA", "=", 
        RowBox[{"{", "MaxPbat", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equStateBat", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "alphaBat"}], "*", "ESOC"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"betaBatDisc", " ", "PbatDisc"}], "-", 
              RowBox[{"betaBatCh", " ", "PbatCh"}]}], ")"}], "/", "3600"}]}], 
          "//", "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(*", 
         RowBox[{
         "No", " ", "Battery", " ", "in", " ", "this", " ", "research"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"varsCtrlBat", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"varsStateBat", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"equStateBat", "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Alkaline", " ", "electrolyzer"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"varsCtrlAE", "=", 
        RowBox[{"{", 
         RowBox[{"pAE", ",", "pAEInner", ",", "pAEPurch"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yitaH2", "=", "yitaP2H"}], ";", 
       RowBox[{"(*", 
        RowBox[{"5", 
         RowBox[{"kwh", "/", "Nm3"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"equAE", "=", 
        RowBox[{
         RowBox[{"yitaH2", "*", " ", "qH2In", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsCapaAEA", "=", 
        RowBox[{"{", "varsCapaAE", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Hydrogen", " ", "Buffer", " ", "Tank"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"varsnStoMaxA", "=", 
        RowBox[{"{", "varsnStoMax", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsStateSto", "=", 
        RowBox[{"{", "nSto", "}"}]}], ";", 
       RowBox[{"(*", "Nm3", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCtrlSto", "=", 
        RowBox[{"{", 
         RowBox[{"qH2In", ",", "qH2Out"}], "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Nm3", "/", "h"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"equStateSto", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equStateSto", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"qH2In", "-", "qH2Out"}], ")"}], "/", "3600"}], "//", 
          "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsCapaHSA", "=", 
        RowBox[{"{", "varsCapaHS", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"obtain", " ", "N2", " ", "from", " ", "the", " ", 
         RowBox[{"air", "/", "Pressure"}], " ", "Swing", " ", "Adsorption", 
         RowBox[{"(", "PSA", ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCtrlPSA", "=", 
        RowBox[{"{", "pPSA", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equPSA", "=", 
        RowBox[{"{", 
         RowBox[{"0", "*", "qH2Out"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"equPSA", "=", 
          RowBox[{"{", 
           RowBox[{"1.064", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "4"}], ")"}]}], "*", "qH2Out"}], "}"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Synthetic", " ", 
          RowBox[{"Ammonia", "/", "Haber"}]}], "-", 
         RowBox[{"Bosch", " ", "synthesis", 
          RowBox[{"(", "HBS", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCtrlHBS", "=", 
        RowBox[{"{", "pHBS", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equHBS", "=", 
        RowBox[{"{", 
         RowBox[{"2.9", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "4"}], ")"}]}], "*", "qH2Out"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"equHBS", "=", 
          RowBox[{"{", 
           RowBox[{"0.5", "*", "4.316", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "4"}], ")"}]}], "*", "qH2Out"}], "}"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ConstMWh2t", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "/", "3"}], "*", "200", "*", 
          RowBox[{"1000", "/", "22.4"}], "*", "17", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"varsCtrlSA", "=", 
        RowBox[{"{", 
         RowBox[{"pSA", ",", "pSAInner", ",", "pSAPurch"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Slow", " ", "Dynamics"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsStateA", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"varsStateSto", ",", 
          RowBox[{"If", "[", 
           RowBox[{"flagBatExist", ",", "varsStateBat", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsCtrlA", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "varsCtrlSto", ",", "varsCtrlAE", ",", "varsCtrlPSA", ",", 
          "varsCtrlHBS", ",", "varsCtrlSA", ",", 
          RowBox[{"If", "[", 
           RowBox[{"flagBatExist", ",", "varsCtrlBat", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equStateA", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"equStateSto", ",", 
          RowBox[{"If", "[", 
           RowBox[{"flagBatExist", ",", "equStateBat", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"varsStateA", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"varsStateBat", ",", "varsStateSto"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"varsCtrlA", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
           "varsCtrlBat", ",", "varsCtrlSto", ",", "varsCtrlAE", ",", 
            "varsCtrlPSA", ",", "varsCtrlHBS"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"equStateA", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"equStateBat", ",", "equStateSto"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"pwA", "=", 
        RowBox[{"{", "pw1", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pvA", "=", 
        RowBox[{"{", "pv1", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pwCurtA", "=", 
        RowBox[{"{", "pwCurt", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pwCurtA", "=", 
        RowBox[{"{", "pwCurt", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pPurchA", "=", 
        RowBox[{"{", "pPurch", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"boolsCurtA", "=", 
          RowBox[{"{", "boolsCurt", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"boolsPurchA", "=", 
          RowBox[{"{", "boolsPurch", "}"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"boolsExchangeA", "=", 
        RowBox[{"{", "boolsExchange", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsCapaRenA", "=", 
        RowBox[{"{", 
         RowBox[{"varsCapaWind", ",", "varsCapaSolar"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Capacity", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCapaA", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "varsCapaRenA", ",", "varsCapaAEA", ",", "varsCapaHSA", ",", 
          "varsCapaBatA", ",", "MaxPbatA"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"flagNormData", "=", "False"}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"True", "-", 
          RowBox[{"normal", " ", "data"}]}], ";", 
         RowBox[{"False", "-", 
          RowBox[{"real", " ", "data", " ", "in", " ", "Gansu"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"choose", " ", "wind"}], "+", 
         RowBox[{"pv", " ", "data"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"flagPlace", "==", "2"}], ","}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neimeng", " ", "real", " ", "data"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"PV", " ", "generation"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"periodSolar", "=", "3600"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
           "\"\<C:\\\\Users\\\\LJR\\\\Desktop\\\\code\\\\code\\\\core\\\\RE.\
xlsx\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Data\>\"", ",", "flagPlace", ",", 
              RowBox[{"1", ";;", "8760"}], ",", 
              RowBox[{"2", ";;", "2"}]}], "}"}]}], "]"}], "//", "Transpose"}],
          "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"betaSolar", "=", "0.608"}], ";"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{")", "*", "0.24"}], "-", 
           RowBox[{"1675.85", "h"}]}], ";", " ", 
          RowBox[{"0.312", "-", 
           RowBox[{"1700", "h"}]}], ";", " ", 
          RowBox[{"0.608", "-", 
           RowBox[{"1800", "h"}]}]}], "*)"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"psolarToNorm", "=", "tmp"}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"betaSolar", " ", 
                 RowBox[{"tmp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}]}]}], 
               ")"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Max generation of Wind power is: \>\"", ",", 
         RowBox[{"Max", "[", "psolarToNorm", "]"}], ",", "\"\< p.u.\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AUHS", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "psolarToNorm", "]"}], "/", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"3600", "/", "periodSolar"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Annual ultilization hours of pv is: \>\"", ",", "AUHS", ",", 
         "\"\< h\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"wind", " ", "generation"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"periodWind", "=", "3600"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
           "\"\<C:\\\\Users\\\\LJR\\\\Desktop\\\\code\\\\code\\\\core\\\\RE.\
xlsx\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Data\>\"", ",", "flagPlace", ",", 
              RowBox[{"1", ";;", "8760"}], ",", 
              RowBox[{"1", ";;", "1"}]}], "}"}]}], "]"}], "//", "Transpose"}],
          "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"betaWind", "=", "0.7625"}], ";"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"0.361", "-", 
          RowBox[{"3300", "h"}]}], ";", " ", 
         RowBox[{"0.7625", "-", 
          RowBox[{"3500", "h"}]}], ";", " ", 
         RowBox[{"0.8221", "-", 
          RowBox[{"3625", "h"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pwindToNorm", "=", "tmp"}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"betaWind", " ", 
                 RowBox[{"tmp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}]}]}], 
               ")"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Max generation of PV is: \>\"", ",", 
         RowBox[{"Max", "[", "pwindToNorm", "]"}], ",", "\"\< p.u.\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AUHW", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "pwindToNorm", "]"}], "/", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"3600", "/", "periodWind"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Annual ultilization hours of Wind power is: \>\"", ",", "AUHW", 
         ",", "\"\< h\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"]", ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**"}], "*", " ", "Year", " ", "ahead", " ", 
         RowBox[{"Dispatch", " ", "**", "**", "**"}], "*", 
         RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}]}], 
        "*******)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"periodDispatch", "=", 
          RowBox[{"1", "*", "4", "*", "900"}]}], " ", ";"}], " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"time", " ", "interval"}], ",", " ", 
          RowBox[{"typically", " ", "be", " ", "1", "h"}]}], "*)"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"periodNH3Dispatch", "=", 
        RowBox[{"itrdays", 
         RowBox[{"(*", 
          RowBox[{"*", "24"}], "*)"}], "*", "3600"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"period", " ", "of", " ", "Synthetic", " ", "Ammonia"}], ",",
          " ", 
         RowBox[{"typically", " ", "be", " ", "1", " ", "day"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"horizonDispatch", "=", 
          RowBox[{"365", "*", "24", "*", "3600"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"horizonAll", "=", "horizonDispatch"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tothours", "=", 
        RowBox[{"horizonDispatch", "/", "3600"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nDispatch", "=", 
        RowBox[{"horizonDispatch", "/", "periodDispatch"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ttrans", "=", 
        RowBox[{"2", "*", "3600"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Time", " ", "Constant", " ", "of", " ", "Synthetic", " ", "Ammonia", 
         " ", "is", " ", "2", 
         RowBox[{"h", "/", "4"}], "h"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nAll", "=", 
        RowBox[{"horizonAll", "/", "periodDispatch"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "wind", " ", "and", " ", "solar", " ", "power", " ", "process"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ftmp", "[", "i_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"psolarToNorm", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", " ", 
                RowBox[{"periodDispatch", "/", "periodSolar"}]}], "+", "1"}], 
              ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], " ", 
               RowBox[{"periodDispatch", "/", "periodSolar"}]}], ",", "1"}], 
             "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pvNormMeanValAll", "=", 
        RowBox[{"Parallelize", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"ftmp", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"nAll", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pvNormMeanValAll", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pvNormMeanValAll", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", "0", ",", 
            RowBox[{"pvNormMeanValAll", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"pvNormMeanValAll", "//", "Length"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pwNormMeanValAll", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pwindToNorm", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", " ", 
                RowBox[{"periodDispatch", "/", "periodWind"}]}], "+", "1"}], 
              ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], 
               RowBox[{"periodDispatch", "/", "periodWind"}]}], ",", "1"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"nAll", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TOUHYearMeanValAll", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagTOUH", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TOUHYear", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", " ", 
                  RowBox[{"periodDispatch", "/", "periodTOU"}]}], "+", "1"}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], 
                 RowBox[{"periodDispatch", "/", "periodTOU"}]}], ",", "1"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"nAll", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFITGVal", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"nAll", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TOUHYearPurchMeanValAll", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagTOUHPurch", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TOUHYearPurch", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", " ", 
                  RowBox[{"periodDispatch", "/", "periodTOU"}]}], "+", "1"}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], 
                 RowBox[{"periodDispatch", "/", "periodTOU"}]}], ",", "1"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"nAll", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePurchGVal", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"nAll", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
         " ", "Controller", " ", "Objective", " ", "Function", " ", "and", 
         " ", 
         RowBox[{"Limits", " ", "**", "**", "**"}], "*", 
         RowBox[{"**", "**", "**", "**"}]}], "*****)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"InfDef", "=", 
        RowBox[{"10", "^", "9"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"weight", " ", "of", " ", "multi"}], "-", "agents"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"weightRen", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"weightAEHS", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"weightSA", "=", "1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Capacity", " ", "Given"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"varsCapaWindGVal", "=", 
        RowBox[{"CapaGivenVal", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"(*", "200", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCapaSolarGVal", "=", 
        RowBox[{"CapaGivenVal", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"(*", "200", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCapaAEGVal", "=", 
        RowBox[{"CapaGivenVal", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", 
       RowBox[{"(*", "100", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCapaHSGVal", "=", 
        RowBox[{"CapaGivenVal", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"10", "^", "5"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCapaBatGVal", "=", 
        RowBox[{"CapaGivenVal", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", 
       RowBox[{"(*", "MWh", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsCapaBatEnergyGVal", "=", 
        RowBox[{"varsCapaBatGVal", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsCapaBatPowerGVal", "=", 
        RowBox[{"varsCapaBatGVal", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"varsWTS", "=", "WTS"}], ";", "\[IndentingNewLine]", 
         RowBox[{"varsGridratio", "=", "Gridratio"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"varsbuffer", "=", "buffer"}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsEL", "=", "EL"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"parameter", " ", "of", " ", 
          RowBox[{"price", ":", " ", 
           RowBox[{"ep", "-", 
            RowBox[{"\:ffe5", "/", "MWh"}]}]}]}], ";", " ", 
         RowBox[{"H2", "-", 
          RowBox[{"\:ffe5", "/", "Nm3"}]}], ";", " ", 
         RowBox[{"NH3", "-", 
          RowBox[{"\:ffe5", "/", "t"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"priceFIT", "=", 
          RowBox[{"0.2829", "*", 
           RowBox[{"10", "^", "3"}]}]}], ";"}], 
        RowBox[{"(*", 
         RowBox[{"feed", "-", "in", "-", "tariff"}], "*)"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"pricePurch", "=", 
          RowBox[{"0.42", "*", 
           RowBox[{"10", "^", "3"}]}]}], ";"}], 
        RowBox[{"(*", 
         RowBox[{"electricity", " ", "price"}], "*)"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"priceNH3", "=", "3060"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"priceInnerA", "=", 
        RowBox[{"{", "priceInner", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceH2InnerA", "=", 
        RowBox[{"{", "priceH2Inner", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceFITA", "=", 
        RowBox[{"{", "priceFIT", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pricePurchA", "=", 
        RowBox[{"{", "pricePurch", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"priceInner", "=", 
          RowBox[{"0.178", "*", 
           RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"priceH2Inner", "=", "1.27"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "signal", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flagRenCapa", "=", 
        RowBox[{"flagCapa", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"True", "-", "optimal"}], ";", " ", 
         RowBox[{"False", "-", "given"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flagWindCapa", "=", 
        RowBox[{"flagRenCapa", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagSolarCapa", "=", 
        RowBox[{"flagRenCapa", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagAECapa", "=", 
        RowBox[{"flagCapa", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"True", "-", "optimal"}], ";", " ", 
         RowBox[{"False", "-", "given"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flagHSCapa", "=", 
        RowBox[{"flagCapa", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"True", "-", "optimal"}], ";", " ", 
         RowBox[{"False", "-", "given"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flagBatCapa", "=", 
        RowBox[{"flagCapa", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"True", "-", "optimal"}], ";", " ", 
         RowBox[{"False", "-", "given"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flagBatCapaEnergy", "=", 
        RowBox[{"flagBatCapa", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagBatCapaPower", "=", 
        RowBox[{"flagBatCapa", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"FlagWTS", "=", "flagWTS"}], ";", "\[IndentingNewLine]", 
         RowBox[{"FlagGridratio", "=", "flagGridratio"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Flagbuffer", "=", "flagbuffer"}], ";", "\[IndentingNewLine]", 
       RowBox[{"FlagEL", "=", "flagEL"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Operation", " ", "parameters"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Alkaline", " ", "Electrolyzor"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ratepAEMin", "=", "0.05"}], ";"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "considering", " ", "Unit", " ", "Commitment", " ", "of", " ", 
           "AEs"}], ";", " ", 
          RowBox[{"single", "-", "0.2"}], ";", 
          RowBox[{"UC", "-", "0.05"}], ";"}], "*)"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"RateOverShoot", "=", "0.0"}], ";", 
       RowBox[{"(*", 
        RowBox[{"overshoot", " ", "rate", " ", "of", " ", "AE"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Hydrogen", " ", 
         RowBox[{"Storage", "/", "buffer"}], " ", "tank"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"yitaMin", "=", "0.1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"yitaMax", "=", "0.9"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Synthetic", " ", "Ammonia"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"LoadNH3Min", "=", "0.3"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LimitRampingNH3", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"itrdays", "=", "1"}], ";"}], 
        RowBox[{"(*", 
         RowBox[{"1", " ", "day"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"exchange", " ", "to", " ", 
         RowBox[{"grid", ":", " ", "net"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ExchangeRate", "=", "0.2"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Economic", " ", "parameters"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"rateDiscount", "=", "0.06"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"OperationYearsRen", "=", "20"}], ";", "\[IndentingNewLine]", 
       RowBox[{"OperationYearsAEHS", "=", "15"}], ";", "\[IndentingNewLine]", 
       RowBox[{"OperationYearsSA", "=", "20"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Investment", ":", " ", 
         RowBox[{
          RowBox[{"W\:ffe5", "/", "MW"}], " ", "or", " ", 
          RowBox[{"W\:ffe5", "/", "Nm3"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ISInit", "=", "400"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ISOM", "=", 
        RowBox[{"ISInit", "*", "0.02"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IWInit", "=", "600"}], ";", "\[IndentingNewLine]", 
       RowBox[{"IWOM", "=", 
        RowBox[{"IWInit", "*", "0.02"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IAEInit", "=", "300"}], ";", "\[IndentingNewLine]", 
       RowBox[{"IAEOM", "=", 
        RowBox[{"IAEInit", "*", "0.03"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IHSInit", "=", 
        RowBox[{"500", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "4"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IHSOM", "=", 
        RowBox[{"IHSInit", "*", "0.02"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ISAInit", "=", 
        RowBox[{"2.6", "*", 
         RowBox[{"10", "^", "4"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ISAOM", "=", 
        RowBox[{"0.03", " ", "ISAInit"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IBatInit", "=", "180"}], ";", 
       RowBox[{"(*", 
        RowBox[{"W\:ffe5", "/", "MWh"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"IBatOM", "=", 
        RowBox[{"0.01", "IBatInit"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ISAInit", "=", "260"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ISAOM", "=", 
          RowBox[{"ISAInit", "*", "0.02"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ConstG2L", "=", "constG2L"}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"4.84", "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "4"}]}]}], "//", "N"}], ";"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"nH2", " ", "To", " ", "mNH3"}], ";", " ", 
         RowBox[{"t", "/", "Nm3"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ConstG2LH2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"1000", "/", "22.4"}], "*", "2", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}]}], "//", "N"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"nH2", " ", "To", " ", "mH2"}], ";", " ", 
         RowBox[{"t", "/", "Nm3"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ConstCapacityMonth", "=", 
          RowBox[{"33", "*", 
           RowBox[{
            RowBox[{"10", "^", "3"}], "/", 
            RowBox[{"10", "^", "4"}]}]}]}], ";"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:5bb9\:91cf\:8d39\:6309\:7167\:6700\:5927\:9700\:91cf", "-", 
           RowBox[{"\:53ef\:4f18\:5316", ":", 
            RowBox[{
             RowBox[{"W\:ffe5", "/", "MW"}], "/", "year"}]}]}], ",", " ", 
          RowBox[{"or", " ", "33", 
           RowBox[{
            RowBox[{"\:ffe5", "/", "kW"}], "/", "month"}]}]}], "*)"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"ConstCapacityYear", "=", 
        RowBox[{"12", " ", "ConstCapacityMonth"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yitaA2H", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5.322", "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "5"}], ")"}]}]}], "+", 
            RowBox[{"2.698", "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "4"}], ")"}]}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"5", "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "3"}]}]}], ")"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ERenTotal", "=", 
        RowBox[{"400", "*", 
         RowBox[{"10", "^", "4"}]}]}], ";", 
       RowBox[{"(*", "MWh", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pwCurtMax", "=", 
        RowBox[{
         RowBox[{"ERenTotal", "/", "AUHS"}], "+", 
         RowBox[{"ERenTotal", "/", "AUHW"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pPurchMax", "=", "pwCurtMax"}], ";", 
       RowBox[{"(*", 
        RowBox[{"big", " ", "enough"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"priceH2O", "=", "9.0"}], ";", 
       RowBox[{"(*", 
        RowBox[{"\:ffe5", "/", "t"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CoeffmH2TomH2O", "=", "10"}], ";", 
       RowBox[{"(*", 
        RowBox[{"t", "/", "t"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CoeffmNH3TomH2O", "=", "2"}], ";", 
       RowBox[{"(*", 
        RowBox[{"t", "/", "t"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Capacity", " ", "Recovery", " ", "Factor"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CRF", "[", 
         RowBox[{"r_", ",", "n_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"r", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "r"}], ")"}], "^", "n"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", "r"}], ")"}], "^", "n"}], "-", "1"}], 
             ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"OverShoot", " ", "Processing"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pAELA", "=", 
        RowBox[{"{", "pAEL", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pAEHA", "=", 
        RowBox[{"{", "pAEH", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"boolsOSA", "=", 
        RowBox[{"{", "boolsOS", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"0", "-", 
          RowBox[{"normal", " ", "range"}]}], ";", " ", 
         RowBox[{"1", "-", 
          RowBox[{"overshoot", " ", "range"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"varsboolsOSXpAELA", "=", 
        RowBox[{"{", "varsboolsOSXpAEL", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsboolsOSXpAEHA", "=", 
        RowBox[{"{", "varsboolsOSXpAEH", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncpAE", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "pAE", "-", "pAEL", "+", "varsboolsOSXpAEL", "-", 
           "varsboolsOSXpAEH"}], ",", 
          RowBox[{"qH2In", "-", 
           RowBox[{
            RowBox[{"1000", "/", "5"}], " ", "pAEL"}], "+", 
           RowBox[{
            RowBox[{"1000", "/", "5"}], " ", "varsboolsOSXpAEL"}], "-", 
           RowBox[{
            RowBox[{"1000", "/", "5"}], " ", "varsboolsOSXpAEH"}]}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Big", " ", "M", " ", "method"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"10", "^", "4"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"limitFuncBigM", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pAEL", "-", 
             RowBox[{"M", 
              RowBox[{"(", 
               RowBox[{"1", "-", "boolsOS"}], ")"}]}], "-", 
             "varsboolsOSXpAEL"}], ",", 
            RowBox[{"varsboolsOSXpAEL", "-", "pAEL", "-", 
             RowBox[{"M", 
              RowBox[{"(", 
               RowBox[{"1", "-", "boolsOS"}], ")"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "M"}], " ", "boolsOS"}], "-", "varsboolsOSXpAEL"}],
             ",", 
            RowBox[{"varsboolsOSXpAEL", "-", 
             RowBox[{"M", " ", "boolsOS"}]}], ",", " ", 
            RowBox[{
             RowBox[{"ratepAEMin", " ", "varsCapaAE"}], "-", "pAEL"}], ",", 
            RowBox[{"pAEL", "-", "varsCapaAE"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pAEH", "-", 
             RowBox[{"M", 
              RowBox[{"(", 
               RowBox[{"1", "-", "boolsOS"}], ")"}]}], "-", 
             "varsboolsOSXpAEH"}], ",", 
            RowBox[{"varsboolsOSXpAEH", "-", "pAEH", "-", 
             RowBox[{"M", 
              RowBox[{"(", 
               RowBox[{"1", "-", "boolsOS"}], ")"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "M"}], " ", "boolsOS"}], "-", "varsboolsOSXpAEH"}],
             ",", 
            RowBox[{"varsboolsOSXpAEH", "-", 
             RowBox[{"M", " ", "boolsOS"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "4"}]}]}], ")"}], "varsCapaAE"}], "-", "pAEH"}],
             ",", 
            RowBox[{"pAEH", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "RateOverShoot"}], ")"}], "varsCapaAE"}]}]}],
            "}"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "-", "boolsOS"}], ",", 
             RowBox[{"boolsOS", "-", "1"}]}], "}"}]}], "*)"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"multi", "-", 
         RowBox[{"agents", " ", 
          RowBox[{"object", ":", " ", 
           RowBox[{
            RowBox[{"minimize", " ", "net", " ", "cost"}], "-", 
            "W\:ffe5"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"fFuncRenInvest", "=", 
          RowBox[{"weightRen", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"CRF", "[", 
               RowBox[{"rateDiscount", ",", "OperationYearsRen"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ISInit", " ", "varsCapaSolar"}], "+", 
                RowBox[{"IWInit", " ", "varsCapaWind"}], "+", 
                RowBox[{"1", "*", 
                 RowBox[{"10", "^", "4"}]}]}], ")"}]}], "+", 
             RowBox[{"ISOM", " ", "varsCapaSolar"}], "+", 
             RowBox[{"IWOM", " ", "varsCapaWind"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fFuncAEHSInvest", "=", 
          RowBox[{"weightAEHS", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"CRF", "[", 
               RowBox[{"rateDiscount", ",", "OperationYearsAEHS"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"IAEInit", "+", "IAEOM"}], ")"}], "varsCapaAE"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"IHSInit", "+", "IHSOM"}], ")"}], "varsCapaHS"}]}], 
               ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "RateOverShoot"}], ")"}], "varsCapaAE", " ", 
              "ConstCapacity"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fFuncSAInvest", "=", 
          RowBox[{"weightSA", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"CRF", "[", 
              RowBox[{"rateDiscount", ",", "OperationYearsSA"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2.6", "*", 
                RowBox[{"10", "^", "4"}]}], "+", 
               RowBox[{"0.03", " ", "2.6", "*", 
                RowBox[{"10", "^", "4"}]}]}], ")"}]}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ISAInit", "+", "ISAOM"}], ")"}], "varsCapaAE"}], "+", 
              RowBox[{"yitaA2H", 
               RowBox[{"(", 
                RowBox[{"1", "+", "RateOverShoot"}], ")"}], "varsCapaAE", " ",
                "ConstCapacity"}]}], "*)"}], ")"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fFuncRenInvest", "=", 
        RowBox[{"weightRen", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CRF", "[", 
            RowBox[{"rateDiscount", ",", "OperationYearsRen"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "ISInit", ")"}], "varsCapaSolar"}], "+", 
             RowBox[{
              RowBox[{"(", "IWInit", ")"}], "varsCapaWind"}], "+", 
             RowBox[{"5", "*", 
              RowBox[{"10", "^", "4"}]}]}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncAEHSInvest", "=", 
        RowBox[{"weightAEHS", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CRF", "[", 
            RowBox[{"rateDiscount", ",", "OperationYearsAEHS"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "IAEInit", ")"}], "varsCapaAE"}], "+", 
             RowBox[{
              RowBox[{"(", "IHSInit", ")"}], "varsCapaHS"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"flagBatExist", ",", 
               RowBox[{"IBatInit", " ", "varsCapaBat"}], ",", "0"}], "]"}]}], 
            ")"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"+", 
             RowBox[{"(", 
              RowBox[{"1", "+", "RateOverShoot"}], ")"}]}], "varsCapaAE", " ",
             "ConstCapacity"}], "*)"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncSAInvest", "=", 
        RowBox[{"weightSA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CRF", "[", 
            RowBox[{"rateDiscount", ",", "OperationYearsSA"}], "]"}], 
           "ISAInit"}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ISAInit", "+", "ISAOM"}], ")"}], "varsCapaAE"}], "+", 
            RowBox[{"yitaA2H", 
             RowBox[{"(", 
              RowBox[{"1", "+", "RateOverShoot"}], ")"}], "varsCapaAE", " ", 
             "ConstCapacity"}]}], "*)"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncPart1", "=", 
        RowBox[{"weightRen", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "priceInner"}], " ", 
            RowBox[{"periodDispatch", "/", "3600"}], "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "4"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"varsCapaSolar", " ", "pv1"}], "+", 
              RowBox[{"varsCapaWind", " ", "pw1"}], "-", "pwCurt"}], ")"}]}], 
           "-", 
           RowBox[{"priceFIT", " ", 
            RowBox[{"periodDispatch", "/", "3600"}], "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "4"}]}], " ", "pwCurt"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncPart2", "=", 
        RowBox[{"weightAEHS", " ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"periodDispatch", "/", "3600"}], "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "4"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"priceInner", " ", "pAEInner"}], "+", 
             RowBox[{"pricePurch", " ", "pAEPurch"}], "+", 
             RowBox[{
             "priceH2O", " ", "CoeffmH2TomH2O", " ", "ConstG2LH2", " ", 
              "qH2Out"}], "-", 
             RowBox[{"priceH2Inner", " ", "qH2Out"}]}], ")"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncPart3", "=", 
        RowBox[{"weightSA", " ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"periodDispatch", "/", "3600"}], "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "4"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"priceInner", " ", "pSAInner"}], "+", 
             RowBox[{"pricePurch", " ", "pSAPurch"}], "+", 
             RowBox[{"priceH2Inner", " ", "qH2Out"}], "+", 
             RowBox[{
             "priceH2O", " ", "CoeffmNH3TomH2O", " ", "ConstG2L", " ", 
              "qH2Out"}], "-", 
             RowBox[{"priceNH3", " ", "ConstG2L", " ", "qH2Out"}]}], ")"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncTot", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "4"}]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pricePurch", " ", "pPurch"}], " ", "-", 
           RowBox[{"priceFIT", " ", "pwCurt"}], "-", 
           RowBox[{"priceNH3", " ", "ConstG2L", " ", "qH2Out"}], "+", 
           RowBox[{
           "priceH2O", " ", "CoeffmH2TomH2O", " ", "ConstG2LH2", " ", 
            "qH2Out"}], "+", 
           RowBox[{
           "priceH2O", " ", "CoeffmNH3TomH2O", " ", "ConstG2L", " ", 
            "qH2Out"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncPart1", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"varsCapaSolar", " ", "pv1"}], "+", 
             RowBox[{"varsCapaWind", " ", "pw1"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"flagBatExist", ",", 
               RowBox[{"PbatDisc", "-", "PbatCh"}], ",", "0"}], "]"}], "+", 
             "pPurch", "-", "pwCurt", "-", "pAE", "-", "pSA"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"varsCapaSolar", " ", "pv1"}], "+", 
             RowBox[{"varsCapaWind", " ", "pw1"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"flagBatExist", ",", 
               RowBox[{"PbatDisc", "-", "PbatCh"}], ",", "0"}], "]"}], "-", 
             "pwCurt", "-", "pAEInner", "-", "pSAInner"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pPurch", "-", "pAEPurch", "-", "pSAPurch"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pAE", "-", "pAEInner", "-", "pAEPurch"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pSA", "-", "pSAInner", "-", "pSAPurch"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pSA", "-", "pPSA", "-", "pHBS"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"flagOverShootLimit", ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"pAE", "-", "equAE"}]}], "]"}], ",", 
           RowBox[{"varsCtrlPSA", "-", "equPSA"}], ",", 
           RowBox[{"varsCtrlHBS", "-", "equHBS"}]}], "}"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPartCapa1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"flagWindCapa", ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"varsCapaWind", "-", "varsCapaWindGVal"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"flagSolarCapa", ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"varsCapaSolar", "-", "varsCapaSolarGVal"}], "}"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CapaAESingale", "=", "5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsIntegerAEA", "=", 
        RowBox[{"{", "varsIntegerAE", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPartCapa2", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagAECapa", ",", 
          RowBox[{"{", 
           RowBox[{"varsCapaAE", "-", 
            RowBox[{"CapaAESingale", " ", "varsIntegerAE"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"varsCapaAE", "-", "varsCapaAEGVal"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPartCapa3", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagHSCapa", ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"varsCapaHS", "-", "varsCapaHSGVal"}], " ", "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPartCapa4", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagBatExist", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"flagBatCapaEnergy", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varsCapaBat", "-", "varsCapaBatEnergyGVal"}], "}"}]}],
              "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"flagBatCapaPower", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"MaxPbat", "-", "varsCapaBatPowerGVal"}], "}"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"limitFuncPart1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"0", "-", "varsCtrlA"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"LoadNH3Min", " ", 
              RowBox[{"1000", "/", "yitaH2"}], "  ", "varsCapaAE"}], "-", 
             "qH2Out"}], ",", " ", 
            RowBox[{
             RowBox[{"ratepAEMin", " ", "varsCapaAE"}], "-", "pAE"}], ",", 
            RowBox[{"pAE", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "RateOverShoot"}], ")"}], "varsCapaAE"}]}], 
            ",", 
            RowBox[{
             RowBox[{"yitaMin", " ", "varsCapaHS"}], "-", "nSto"}], ",", 
            RowBox[{"nSto", "-", 
             RowBox[{"yitaMax", " ", "varsCapaHS"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "-", "pwCurt"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"pwCurt", "-", 
               RowBox[{"boolsExchange", " ", "pwCurtMax"}]}], ","}], "*)"}], 
            RowBox[{"0", "-", "pPurch"}]}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"pPurch", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "boolsExchange"}], ")"}], "pPurchMax"}]}]}],
             "*)"}], "}"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"flagBatExist", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PbatCh", "-", "MaxPbat"}], ",", 
              RowBox[{"PbatCh", "-", 
               RowBox[{"boolsBat", " ", "PbatMax"}]}], ",", 
              RowBox[{"PbatDisc", "-", "MaxPbat"}], ",", 
              RowBox[{"PbatDisc", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "boolsBat"}], " ", ")"}], "PbatMax"}]}], 
              ",", 
              RowBox[{
               RowBox[{"SOCMin", " ", "varsCapaBat"}], "-", "ESOC"}], ",", 
              RowBox[{"ESOC", "-", 
               RowBox[{"SOCMax", " ", "varsCapaBat"}]}]}], "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"limitFuncPartCapa1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "flagWindCapa"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", "-", "varsCapaWind"}], "}"}]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "flagSolarCapa"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", "-", "varsCapaSolar"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"limitFuncPartCapa2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "flagAECapa"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", "-", "varsCapaAE"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"limitFuncPartCapa3", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "flagHSCapa"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", "-", "varsCapaHS"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"limitFuncPartCapa4", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagBatExist", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "flagBatCapaEnergy"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", "-", "varsCapaBat"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"limitFuncPartCapa5", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagBatExist", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "flagBatCapaPower"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", "-", "MaxPbat"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"D", "[", 
         RowBox[{"equStateA", ",", 
          RowBox[{"{", "varsStateA", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B", "=", 
        RowBox[{"D", "[", 
         RowBox[{"equStateA", ",", 
          RowBox[{"{", "varsCtrlA", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"0", "===", 
            RowBox[{"Chop", "[", 
             RowBox[{"Expand", "[", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"A", ".", "varsStateA"}], "+", 
                  RowBox[{"B", ".", "varsCtrlA"}], "-", "equStateA"}], ")"}], 
                "^", "2"}], "]"}], "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<System Not Linear!\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AD", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MatrixExp", "[", 
           RowBox[{"A", " ", "periodDispatch"}], "]"}], "//", "Chop"}], "//", 
         "SparseArray"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"steps", "=", "50"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"MatrixExp", "[", 
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{"periodDispatch", "-", "#"}], ")"}]}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"periodDispatch", "/", "steps"}], " ", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "steps"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"Most", "[", "tmp1", "]"}], "+", 
            RowBox[{"Rest", "[", "tmp1", "]"}]}], "]"}], 
          RowBox[{"periodDispatch", "/", 
           RowBox[{"(", 
            RowBox[{"2", "steps"}], ")"}]}]}], "//", "Chop"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BD", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", ".", "B"}], "//", "Chop"}], "//", "SparseArray"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**"}], "*", 
         RowBox[{"**", "**", "**", "**", "**", "**"}], "*", " ", 
         "dispatching", " ", 
         RowBox[{"formulation", " ", "**", "**", "**"}], "*", 
         RowBox[{"**", "**", "**", "**", "**", "**"}], "*"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"varsStateDisp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
              RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
           "varsStateA"}], ",", 
          RowBox[{"{", 
           RowBox[{"itr", ",", "0", ",", "nDispatch"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"varsCtrlDisp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
              RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
           "varsCtrlA"}], ",", 
          RowBox[{"{", 
           RowBox[{"itr", ",", "0", ",", 
            RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsboolsBatDisp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
              RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
           "boolsBatA"}], ",", 
          RowBox[{"{", 
           RowBox[{"itr", ",", "0", ",", 
            RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsqH2OutDisp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<qH2Out\>\"", "<>", "\"\<Disp\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"horizonDispatch", "/", "periodNH3Dispatch"}], "-", 
            "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pwCurtDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "pwCurtA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pPurchDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "pPurchA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsboolsExchangeDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "boolsExchangeA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pAELDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "pAELA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pAEHDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "pAEHA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsboolsOSDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "boolsOSA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsboolsOSXpAELDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "varsboolsOSXpAELA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsboolsOSXpAEHDisp", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<D\>\"", "<>", 
               RowBox[{"ToString", "[", "itr", "]"}]}], "]"}], "&"}], "/@", 
            "varsboolsOSXpAEHA"}], ",", 
           RowBox[{"{", 
            RowBox[{"itr", ",", "0", ",", 
             RowBox[{"nDispatch", "-", "1"}]}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tss", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Boundary", " ", "conditions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pvNormMeanVal", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pvNormMeanValAll", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", "0", ",", 
            RowBox[{"pvNormMeanValAll", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"pvNormMeanValAll", "//", "Length"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pwNormMeanVal", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pwNormMeanValAll", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", "0", ",", 
            RowBox[{"pwNormMeanValAll", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"pwNormMeanValAll", "//", "Length"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"TOUHYearMeanVal", "=", "TOUHYearMeanValAll"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TOUHYearPurchMeanVal", "=", "TOUHYearPurchMeanValAll"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Stage1", ":", " ", 
         RowBox[{"capacity", " ", "optimization"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "objective", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fFuncDisp1", "=", 
        RowBox[{
         RowBox[{"ISOM", " ", "varsCapaSolar"}], "+", 
         RowBox[{"IWOM", " ", "varsCapaWind"}], "+", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fFuncPart1", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pricePurch", "\[Rule]", 
                    RowBox[{"TOUHYearPurchMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"priceFIT", "\[Rule]", 
                   RowBox[{"TOUHYearMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pv1", "\[Rule]", 
                  RowBox[{"pvNormMeanVal", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"pw1", "\[Rule]", 
                 RowBox[{"pwNormMeanVal", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"pwCurt", "\[Rule]", 
                RowBox[{"pwCurtDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"pPurch", "\[Rule]", 
               RowBox[{"pPurchDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nDispatch"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncDisp2", "=", 
        RowBox[{"(*", 
         RowBox[{"645", "+"}], "*)"}], 
        RowBox[{
         RowBox[{"IAEOM", " ", "varsCapaAE"}], "+", 
         RowBox[{"IHSOM", " ", "varsCapaHS"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{"flagBatExist", ",", 
           RowBox[{"IBatOM", " ", "varsCapaBat"}], ",", "0"}], "]"}], "+", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fFuncPart2", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pricePurch", "\[Rule]", 
                    RowBox[{"TOUHYearPurchMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"priceFIT", "\[Rule]", 
                   RowBox[{"TOUHYearMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pv1", "\[Rule]", 
                  RowBox[{"pvNormMeanVal", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"pw1", "\[Rule]", 
                 RowBox[{"pwNormMeanVal", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"pwCurt", "\[Rule]", 
                RowBox[{"pwCurtDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"pPurch", "\[Rule]", 
               RowBox[{"pPurchDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nDispatch"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncDisp3", "=", 
        RowBox[{"(*", 
         RowBox[{"1275", "+"}], "*)"}], 
        RowBox[{"ISAOM", "+", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fFuncPart3", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pricePurch", "\[Rule]", 
                    RowBox[{"TOUHYearPurchMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"priceFIT", "\[Rule]", 
                   RowBox[{"TOUHYearMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pv1", "\[Rule]", 
                  RowBox[{"pvNormMeanVal", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"pw1", "\[Rule]", 
                 RowBox[{"pwNormMeanVal", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"pwCurt", "\[Rule]", 
                RowBox[{"pwCurtDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"pPurch", "\[Rule]", 
               RowBox[{"pPurchDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nDispatch"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncTotDisp", "=", 
        RowBox[{"(*", 
         RowBox[{"645", "+", "1275", "+"}], "*)"}], 
        RowBox[{
         RowBox[{"ISOM", " ", "varsCapaSolar"}], "+", 
         RowBox[{"IWOM", " ", "varsCapaWind"}], "+", 
         RowBox[{"IAEOM", " ", "varsCapaAE"}], "+", 
         RowBox[{"IHSOM", " ", "varsCapaHS"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{"flagBatExist", ",", 
           RowBox[{"IBatOM", " ", "varsCapaBat"}], ",", "0"}], "]"}], "+", 
         "ISAOM", "+", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fFuncTot", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pricePurch", "\[Rule]", 
                    RowBox[{"TOUHYearPurchMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"priceFIT", "\[Rule]", 
                   RowBox[{"TOUHYearMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pv1", "\[Rule]", 
                  RowBox[{"pvNormMeanVal", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"pw1", "\[Rule]", 
                 RowBox[{"pwNormMeanVal", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"pwCurt", "\[Rule]", 
                RowBox[{"pwCurtDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"pPurch", "\[Rule]", 
               RowBox[{"pPurchDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nDispatch"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncDispRen", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fFuncRenInvest", "+", "fFuncDisp1"}], "//", "Expand"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncDispAEHS", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fFuncAEHSInvest", "+", "fFuncDisp2"}], "//", "Expand"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncDispSA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fFuncSAInvest", "+", "fFuncDisp3"}], "//", "Expand"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncDisp", "=", 
        RowBox[{"fFuncDispRen", "+", "fFuncDispAEHS", "+", "fFuncDispSA"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncPunish", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagOverShootLimit", ",", 
          RowBox[{"coeffPunish", " ", 
           RowBox[{"Total", "[", "varsboolsOSDisp", "]"}]}], ",", "0"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Capacity", " ", "cost"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DayInMonthList", "=", 
        RowBox[{"{", 
         RowBox[{
         "31", ",", "28", ",", "31", ",", "30", ",", "31", ",", "30", ",", 
          "31", ",", "31", ",", "30", ",", "31", ",", "30", ",", "31"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nMonth", "=", 
        RowBox[{"DayInMonthList", "//", "Length"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MaxpPurchA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<MaxpPurch\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "nMonth", "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmpPoints", "=", 
        RowBox[{"24", "*", 
         RowBox[{"3600", "/", "periodDispatch"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmpList", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tmpPoints", " ", 
            RowBox[{"Total", "[", 
             RowBox[{"DayInMonthList", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "#"}], "]"}], "]"}], "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", "nMonth", "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"endPoint", "=", 
        RowBox[{"horizonDispatch", "/", "periodDispatch"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncCapacityCost", "=", 
        RowBox[{"ConstCapacityMonth", " ", 
         RowBox[{"Total", "[", "MaxpPurchA", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncCapacityLimit", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"itr", "=", "1"}], ",", 
         RowBox[{"itr", "<=", "nMonth"}], ",", 
         RowBox[{"itr", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"itr", "==", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"gFuncCapacityLimit", ",", 
              RowBox[{
               RowBox[{"pPurchDisp", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"tmpList", "[", 
                   RowBox[{"[", "itr", "]"}], "]"}]}], "]"}], "]"}], "-", 
               RowBox[{"MaxpPurchA", "[", 
                RowBox[{"[", "itr", "]"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"gFuncCapacityLimit", ",", 
              RowBox[{
               RowBox[{"pPurchDisp", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", "+", 
                   RowBox[{"tmpList", "[", 
                    RowBox[{"[", 
                    RowBox[{"itr", "-", "1"}], "]"}], "]"}]}], ";;", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"tmpList", "[", 
                    RowBox[{"[", "itr", "]"}], "]"}], ",", "endPoint"}], 
                   "]"}]}], "]"}], "]"}], "-", 
               RowBox[{"MaxpPurchA", "[", 
                RowBox[{"[", "itr", "]"}], "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncDispSingle", "=", 
        RowBox[{
        "fFuncTotDisp", "+", "fFuncRenInvest", "+", "fFuncAEHSInvest", "+", 
         "fFuncSAInvest", "+", "fFuncPunish", "+", "fFuncCapacityCost"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncDisp", "=", 
        RowBox[{"fFuncDisp1", "+", "fFuncDisp2", "+", "fFuncDisp3"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"inequality", " ", "constraints"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"IRRLower", "=", "0.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IRRUpper", "=", "0.3"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"flagCurt", "=", 
        RowBox[{"flagGrid", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagPurch", "=", 
        RowBox[{"flagGrid", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagNetCurt", "=", 
        RowBox[{"flagGrid", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RateCurt", "=", 
        RowBox[{"ExchangeRate", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RatePurch", "=", 
        RowBox[{"ExchangeRate", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RateNetCurt", "=", 
        RowBox[{"ExchangeRate", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncGrid1", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagCurt", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Total", "[", "pwCurtDisp", "]"}], "-", 
            RowBox[{"RateCurt", " ", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"varsCapaWind", " ", "pwNormMeanVal"}], "+", 
               RowBox[{"varsCapaSolar", " ", "pvNormMeanVal"}]}], "]"}]}]}], 
           "}"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncGrid2", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagPurch", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Total", "[", "pPurchDisp", "]"}], "-", 
            RowBox[{"RatePurch", " ", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"varsCapaWind", " ", "pwNormMeanVal"}], "+", 
               RowBox[{"varsCapaSolar", " ", "pvNormMeanVal"}]}], "]"}]}]}], 
           "}"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncGrid3", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagNetCurt", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Total", "[", "pwCurtDisp", "]"}], "-", 
            RowBox[{"Total", "[", "pPurchDisp", "]"}], "-", 
            RowBox[{"RateNetCurt", " ", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"varsCapaWind", " ", "pwNormMeanVal"}], "+", 
               RowBox[{"varsCapaSolar", " ", "pvNormMeanVal"}]}], "]"}]}]}], 
           "}"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Big", "-", 
         RowBox[{"M", " ", "contraints"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"gFuncBigM", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagOverShootLimit", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"limitFuncBigM", "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"pAEL", "\[Rule]", 
                   RowBox[{"pAELDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pAEH", "\[Rule]", 
                  RowBox[{"pAEHDisp", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"boolsOS", "\[Rule]", 
                 RowBox[{"varsboolsOSDisp", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"varsboolsOSXpAEL", "\[Rule]", 
                RowBox[{"varsboolsOSXpAELDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"varsboolsOSXpAEH", "\[Rule]", 
               RowBox[{"varsboolsOSXpAEHDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncOverShootTimeLimit", "=", 
        RowBox[{"(*", 
         RowBox[{"{", "}"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{"flagOverShootLimit", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Total", "[", "varsboolsOSDisp", "]"}], "-", 
            RowBox[{"RateTimeOverShoot", " ", "nDispatch"}]}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Limit", " ", "of", " ", "continuted", " ", "overshoot"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagOverShootLimit", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TimeOSContinuetedMax", "=", "6"}], ";", 
          RowBox[{"(*", "hours", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"NOSContinuetedMax", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{"TimeOSContinuetedMax", "*", 
             RowBox[{"3600", "/", "periodDispatch"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gFuncContOS", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"itr", "=", "1"}], ",", 
            RowBox[{"itr", "<=", "nDispatch"}], ",", 
            RowBox[{"itr", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"itr", "+", "NOSContinuetedMax", "-", "1"}], ">", 
                "nDispatch"}], ",", 
               RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"gFuncContOS", ",", 
               RowBox[{
                RowBox[{"varsboolsOSDisp", "[", 
                 RowBox[{"[", 
                  RowBox[{"itr", ";;", 
                   RowBox[{"itr", "+", "NOSContinuetedMax", "-", "1"}]}], 
                  "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{"NOSContinuetedMax", "-", "1"}], ")"}]}]}], "]"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gFuncContOS", "=", 
           RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"buy", "/", 
          RowBox[{"(", 
           RowBox[{"buy", "+", "Inner"}], ")"}]}], "<", 
         RowBox[{"50", "%"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ratePurchMax", "=", "0.49"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmpInner", "=", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"varsCapaA", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "pwNormMeanValAll"}], "+", 
          RowBox[{
           RowBox[{"varsCapaA", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "pvNormMeanValAll"}], "-", 
          "pwCurtDisp"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmpPurch", "=", 
        RowBox[{"Total", "[", "pPurchDisp", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncRatePurchLimit", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "ratePurchMax"}], ")"}], "tmpPurch"}], "-", 
          RowBox[{"ratePurchMax", " ", "tmpInner"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncpPurchLimit", "=", 
        RowBox[{"pPurchDisp", "-", 
         RowBox[{"0.75", " ", "varsCapaAE"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncDisp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"limitFuncPart1", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"pv1", "\[Rule]", 
                    RowBox[{"pvNormMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"pw1", "\[Rule]", 
                    RowBox[{"pwNormMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pwCurt", "\[Rule]", 
                    RowBox[{"pwCurtDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"pPurch", "\[Rule]", 
                   RowBox[{"pPurchDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"boolsExchangeA", "\[Rule]", 
                  RowBox[{"varsboolsExchangeDisp", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"boolsBatA", "\[Rule]", 
                 RowBox[{"varsboolsBatDisp", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", 
            "limitFuncPartCapa1", ",", "limitFuncPartCapa2", ",", 
            "limitFuncPartCapa3", ",", "limitFuncPartCapa4", ",", 
            "limitFuncPartCapa5", ",", 
            RowBox[{
             RowBox[{"LoadNH3Min", " ", 
              RowBox[{"1000", "/", "yitaH2"}], "  ", "varsCapaAE"}], "-", 
             "varsqH2OutDisp"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "LimitRampingNH3"}], " ", 
              RowBox[{"1000", "/", "yitaH2"}], "  ", "varsCapaAE"}], "-", 
             RowBox[{"Differences", "[", "varsqH2OutDisp", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Differences", "[", "varsqH2OutDisp", "]"}], "-", 
             RowBox[{"LimitRampingNH3", " ", 
              RowBox[{"1000", "/", "yitaH2"}], "  ", "varsCapaAE"}]}], ",", 
            "gFuncGrid1", ",", "gFuncGrid2", ",", "gFuncGrid3", ",", 
            "gFuncBigM", ",", "gFuncOverShootTimeLimit", ",", "gFuncContOS", 
            RowBox[{"(*", 
             RowBox[{",", "gFuncRatePurchLimit"}], "*)"}], ",", 
            "gFuncCapacityLimit"}], 
           RowBox[{"(*", 
            RowBox[{",", "gFuncpPurchLimit"}], "*)"}], "]"}], "//", 
          "Flatten"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"flexibility", " ", "of", " ", "Synthetic", " ", "Ammonia"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qH2OutinitVal", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"varsCtrlDisp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ntmp1", "=", 
        RowBox[{"periodNH3Dispatch", "/", "periodDispatch"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ntmp2", "=", 
        RowBox[{"horizonDispatch", "/", "periodNH3Dispatch"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncPart2", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "ntmp2"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"backward", " ", 
                 RowBox[{"difference", ":", " ", 
                  RowBox[{"x", 
                   RowBox[{"(", "t", ")"}]}]}]}], "=", 
                RowBox[{"x", 
                 RowBox[{"(", "0", ")"}]}]}], ",", 
               RowBox[{"0", "<", "t", "\[LessEqual]", "T"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"hFuncPart2", ",", 
                RowBox[{
                 RowBox[{"tmp", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "ntmp1"}], "]"}], "]"}], "-", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"qH2OutinitVal", "-", 
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "t"}], "/", "Ttrans"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", 
                    RowBox[{"periodNH3Dispatch", "-", "periodDispatch"}], ",",
                     "periodDispatch"}], "}"}]}], "]"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"hFuncPart2", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", " ", "ntmp1"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}], " ", "ntmp1"}]}], "]"}], 
                    "]"}], "-", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "t"}], "/", "Ttrans"}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", 
                    RowBox[{"periodNH3Dispatch", "-", "periodDispatch"}], ",",
                     "periodDispatch"}], "}"}]}], "]"}]}], "//", "Expand"}]}],
                 "]"}], ";"}]}], "\[IndentingNewLine]", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"Forward", " ", 
                RowBox[{"difference", ":", " ", 
                 RowBox[{"x", 
                  RowBox[{"(", "t", ")"}]}]}]}], "=", 
               RowBox[{"x", 
                RowBox[{"(", "T", ")"}]}]}], ",", 
              RowBox[{"0", "<", "t", "\[LessEqual]", "T"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"hFuncPart2", ",", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "ntmp1"}], "]"}], "]"}], "-", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"varsqH2OutDisp", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"qH2OutinitVal", "-", 
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "t"}], "/", "Ttrans"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "t", ",", "periodDispatch", ",", "periodNH3Dispatch", ",", 
                   "periodDispatch"}], "}"}]}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"hFuncPart2", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"tmp", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", " ", "ntmp1"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}], " ", "ntmp1"}]}], "]"}], 
                  "]"}], "-", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "t"}], "/", "Ttrans"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "periodDispatch", ",", "periodNH3Dispatch", ",",
                     "periodDispatch"}], "}"}]}], "]"}]}], "//", "Expand"}]}],
               "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"Central", " ", 
                RowBox[{"difference", ":", " ", 
                 RowBox[{"x", 
                  RowBox[{"(", "t", ")"}]}]}]}], "=", 
               RowBox[{"x", 
                RowBox[{"(", 
                 RowBox[{"T", "/", "2"}], ")"}]}]}], ",", 
              RowBox[{"0", "<", "t", "\[LessEqual]", "T"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"hFuncPart2", ",", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "ntmp1"}], "]"}], "]"}], "-", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"qH2OutinitVal", "-", 
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "t"}], "/", "Ttrans"}], "]"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", 
                    RowBox[{"0.5", " ", "periodDispatch"}], ",", 
                    RowBox[{"periodNH3Dispatch", "-", 
                    RowBox[{"0.5", " ", "periodDispatch"}]}], ",", 
                    "periodDispatch"}], "}"}]}], "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"hFuncPart2", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", " ", "ntmp1"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}], " ", "ntmp1"}]}], "]"}], 
                   "]"}], "-", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"varsqH2OutDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "t"}], "/", "Ttrans"}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"0.5", " ", "periodDispatch"}], ",", 
                    RowBox[{"periodNH3Dispatch", "-", 
                    RowBox[{"0.5", " ", "periodDispatch"}]}], ",", 
                    "periodDispatch"}], "}"}]}], "]"}]}], "//", "Expand"}]}], 
               "]"}], ";"}]}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPart2", "=", 
        RowBox[{"hFuncPart2", "//", "Flatten"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "initial", " ", "and", " ", "terminal", " ", "state", " ", "of", " ", 
         "buffer", " ", "tank"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nStoiniVal", "=", 
        RowBox[{"0.5", " ", "varsCapaHS"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EOSCinitVal", "=", 
        RowBox[{"0.5", " ", "varsCapaBat"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPart3", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"varsStateDisp", "//", "First"}], ")"}], "-", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "nStoiniVal", "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"flagBatExist", ",", 
               RowBox[{"{", "EOSCinitVal", "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"varsStateDisp", "//", "First"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"varsStateDisp", "//", "Last"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"hFuncPart4", "=", 
          RowBox[{"If", "[", 
           RowBox[{"flagRenCapa", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"varsCapaWind", " ", "AUHW"}], "+", 
              RowBox[{"varsCapaSolar", " ", "AUHS"}], "-", "ERenTotal"}], 
             "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ENH3Total", "=", "ETotal"}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"258", "w", " ", "t", " ", "NH3"}], "+", "CH3OH"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncPart4", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"flagWindCapa", "||", "flagSolarCapa"}], ",", 
          RowBox[{"{", 
           RowBox[{"ENH3Total", "-", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], "ConstG2L", " ", 
             RowBox[{"Total", "[", 
              RowBox[{"varsCtrlDisp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "}"}], 
          ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPart5", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagOverShootLimit", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"hFuncpAE", "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"pAEL", "\[Rule]", 
                   RowBox[{"pAELDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pAEH", "\[Rule]", 
                  RowBox[{"pAEHDisp", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"boolsOS", "\[Rule]", 
                 RowBox[{"varsboolsOSDisp", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"varsboolsOSXpAEL", "\[Rule]", 
                RowBox[{"varsboolsOSXpAELDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"varsboolsOSXpAEH", "\[Rule]", 
               RowBox[{"varsboolsOSXpAEHDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPart6", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagConnected", ",", 
          RowBox[{"{", "}"}], ",", "pPurchDisp"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"hFuncPart7", "=", 
          RowBox[{"{", 
           RowBox[{"varsCapaWind", "+", "varsCapaSolar", "-", 
            RowBox[{"1.2", "varsCapaAE"}]}], "}"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", "0.05"}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncPart7", "=", 
        RowBox[{"{", 
         RowBox[{"varsCapaWind", "-", 
          RowBox[{"rate", " ", "varsCapaSolar"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"equality", " ", "constraints"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\:8d1f\:8377\:80fd\:8017", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ELoad", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{"Total", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "8"}], "]"}], "]"}]}], ")"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncDisp", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"AD", ".", 
               RowBox[{"varsStateDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "+", 
              RowBox[{"BD", ".", 
               RowBox[{"varsCtrlDisp", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "-", 
              RowBox[{"varsStateDisp", "[", 
               RowBox[{"[", 
                RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"hFuncPart1", "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"pv1", "\[Rule]", 
                   RowBox[{"pvNormMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"pw1", "\[Rule]", 
                  RowBox[{"pwNormMeanVal", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{"pwCurt", "\[Rule]", 
                 RowBox[{"pwCurtDisp", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"pPurch", "\[Rule]", 
                RowBox[{"pPurchDisp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", "hFuncPartCapa1", 
           ",", "hFuncPartCapa2", ",", "hFuncPartCapa3", ",", 
           "hFuncPartCapa4", ",", "hFuncPart2", ",", "hFuncPart3", ",", 
           "hFuncPart4", ",", "hFuncPart5", ",", "hFuncPart6", ",", 
           RowBox[{"{", 
            RowBox[{"ENH3Total", "-", 
             RowBox[{
              RowBox[{"periodDispatch", "/", "3600"}], "ConstG2L", " ", 
              RowBox[{"Total", "[", 
               RowBox[{"varsCtrlDisp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "}"}], 
           ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"FlagWTS", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "varsWTS"}], " ", ")"}], 
                  "varsCapaWind"}], "-", 
                 RowBox[{"varsWTS", " ", "varsCapaSolar"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"FlagGridratio", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"periodDispatch", "/", "3600"}], 
                  RowBox[{"Total", "[", "pPurchDisp", "]"}]}], "-", 
                 RowBox[{"varsGridratio", " ", "ELoad"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], ","}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{"Flagbuffer", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varsCapaA", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"varsbuffer", "/", "ConstG2L"}], "*", "ENH3Total"}]}],
               "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"FlagEL", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varsCapaA", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", "varsEL"}], "}"}], ",", 
             " ", 
             RowBox[{"{", "}"}]}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "hFuncPart7"}], "*)"}], "]"}], "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"hFuncDisp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"AD", ".", 
                  RowBox[{"varsStateDisp", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "+", 
                 RowBox[{"BD", ".", 
                  RowBox[{"varsCtrlDisp", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "-", 
                 RowBox[{"varsStateDisp", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"hFuncPart1", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsCtrlA", "->", 
                    RowBox[{"varsCtrlDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsStateA", "->", 
                    RowBox[{"varsStateDisp", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "]"}]}], "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"pv1", "\[Rule]", 
                    RowBox[{"pvNormMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"pw1", "\[Rule]", 
                    RowBox[{"pwNormMeanVal", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pwCurt", "\[Rule]", 
                    RowBox[{"pwCurtDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"pPurch", "\[Rule]", 
                   RowBox[{"pPurchDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "nDispatch"}], "]"}]}], ",", 
              "hFuncPartCapa1", ",", "hFuncPartCapa2", ",", "hFuncPartCapa3", 
              ",", "hFuncPart2", ",", "hFuncPart3", ",", "hFuncPart4"}], 
             "]"}], "//", "N"}], "//", "Flatten"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Decision", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsOverShoot", "=", 
        RowBox[{"If", "[", 
         RowBox[{"flagOverShootLimit", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
           "pAELDisp", ",", "pAEHDisp", ",", "varsboolsOSXpAELDisp", ",", 
            "varsboolsOSXpAEHDisp"}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varsDisp", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
          "varsCtrlDisp", ",", "varsStateDisp", ",", "pwCurtDisp", ",", 
           "pPurchDisp", ",", "varsqH2OutDisp", ",", "varsCapaA", ",", 
           "varsOverShoot", ",", "MaxpPurchA"}], "]"}], "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"varsDisp", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
            "varsCtrlDisp", ",", "varsStateDisp", ",", "pwCurtDisp", ",", 
             "pPurchDisp", ",", "varsqH2OutDisp", ",", 
             RowBox[{"If", "[", 
              RowBox[{"flagRenCapa", ",", "varsCapaRenA", ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"flagAECapa", ",", "varsCapaAEA", ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"flagHSCapa", ",", "varsCapaHSA", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}], "//", "Flatten"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boolsDisp", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"varsboolsExchangeDisp", ",", 
           RowBox[{"If", "[", 
            RowBox[{"flagBatExist", ",", "varsboolsBatDisp", ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"flagOverShootLimit", ",", "varsboolsOSDisp", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsInteger", "=", "varsIntegerAEA"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flagMMA", "==", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"solve", " ", "dispatch", " ", "problem"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Solving\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bSolved", "=", "False"}], ";", "\[IndentingNewLine]", 
          RowBox[{"relaxVal", "=", "LoadNH3MinVal"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"flagRepeat", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"using", " ", "gurobi"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"!", "bSolved"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"fFunc", "=", 
               RowBox[{"fFuncDispSingle", "//", "Chop"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"hFunc", "=", 
               RowBox[{"hFuncDisp", "//", "Chop"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"gFunc", "=", 
               RowBox[{
                RowBox[{"gFuncDisp", "//", "Flatten"}], "//", "Chop"}]}], 
              ";"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"gFunc", "=", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"hFunc", ",", 
                   RowBox[{"gFuncDisp", "/.", 
                    RowBox[{"LoadNH3Min", "\[Rule]", "relaxVal"}]}], ",", 
                   "boolsDisp"}], "]"}], "//", "Chop"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"gLower", "=", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"hFunc", "//", "Length"}], "}"}]}], "]"}], ",", 
                   "gLowerDisp", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"boolsDisp", "//", "Length"}], "}"}]}], "]"}]}], 
                  "]"}], "//", "Chop"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"gUpper", "=", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"hFunc", "//", "Length"}], "}"}]}], "]"}], ",", 
                   "gUpperDisp", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"boolsDisp", "//", "Length"}], "}"}]}], "]"}]}], 
                  "]"}], "//", "Chop"}]}]}], "*)"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"vars", "=", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"varsDisp", ",", "boolsDisp", ",", "varsInteger"}], 
                "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"varsDef", "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Element", "[", 
                   RowBox[{
                    RowBox[{"varsDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "Reals"}], "]"}], 
                  "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"varsDisp", "//", "Length"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Element", "[", 
                   RowBox[{
                    RowBox[{"boolsDisp", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "Integers"}], "]"}], 
                  "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"boolsDisp", "//", "Length"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Element", "[", 
                   RowBox[{
                    RowBox[{"varsInteger", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "Integers"}], "]"}], 
                  "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"varsInteger", "//", "Length"}], "]"}]}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "\"\<Start!\>\"", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "\"\<Stage 1:\>\"", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tsGurobi", "=", 
              RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"cRuleStage1", "=", 
              RowBox[{
               RowBox[{"LinearOptimization", "[", 
                RowBox[{"fFunc", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"hFunc", "==", "0"}], ",", 
                   RowBox[{"gFunc", "\[VectorLessEqual]", "0"}]}], "}"}], ",",
                  "varsDef", ",", 
                 RowBox[{"Method", "\[Rule]", "\"\<Gurobi\>\""}]}], "]"}], "//",
                "Dispatch"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<All time used in optimization by gurobi: \>\"", ",", 
               RowBox[{
                RowBox[{"AbsoluteTime", "[", "]"}], "-", "tsGurobi"}], ",", 
               "Red"}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"First", "[", "varsDisp", "]"}], ")"}], "/.", 
                 "cRuleStage1"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bSolved", "=", "True"}], ";", 
                RowBox[{"Break", "[", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"relaxVal", "=", 
                 RowBox[{"LoadNH3MinVal", "+", 
                  RowBox[{"0.002", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagRepeat", "+=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<RelaxVal: \>\"", ",", "relaxVal"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"flagRepeat", ">", "0"}], ",", 
               RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"bSolved", "==", "False"}], ",", 
            RowBox[{"Abort", "[", "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"using", " ", "gurobi", " ", "by", " ", "matlab"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"varsAll", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"varsDisp", ",", "boolsDisp", ",", "varsInteger"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"varsAll", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"varsDisp", ",", "boolsDisp", ",", "varsInteger"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"varsValAll", "=", 
           RowBox[{
            RowBox[{"Import", "[", "\"\<D:\\\\val.mat\>\"", "]"}], "//", 
            "Flatten"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cRuleStage1", "=", 
           RowBox[{"Dispatch", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"varsAll", "->", "varsValAll"}], "]"}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"varsCapaVal", "=", 
        RowBox[{"varsCapaA", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nNH3Max", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "/", "3"}], "/", "3600"}], "*", "periodDispatch", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
           "cRuleStage1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"mNH3Max", "=", 
          RowBox[{"nNH3Max", "*", 
           RowBox[{"1000", "/", "22.4"}], "*", "17", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "6"}], ")"}]}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"mNH3Max", "=", 
        RowBox[{"ConstG2L", " ", 
         RowBox[{"periodDispatch", "/", "3600"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "/.", " ", 
           "cRuleStage1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nH2Max", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
           "cRuleStage1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mH2Max", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
           "cRuleStage1"}], ")"}], "ConstG2LH2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qH2InDispValAll", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"qH2OutDispValAll", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"qH2OutDispatchValAll", "=", 
        RowBox[{"varsqH2OutDisp", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pAEDispValAll", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pPSADispValAll", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "6"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pHBSDispValAll", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "7"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pSADispValAll", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "8"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagBatExist", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PbatChDispValAll", "=", 
           RowBox[{
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "2"}]}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"PbatDiscDispValAll", "=", 
           RowBox[{
            RowBox[{"varsCtrlDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"PbatDispValAll", "=", 
           RowBox[{"PbatDiscDispValAll", "-", "PbatChDispValAll"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ESOCDispValAll", "=", 
           RowBox[{
            RowBox[{"varsStateDisp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", 
            "cRuleStage1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"SOCDispValAll", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"varsCapaVal", "[", 
               RowBox[{"[", "5", "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{"10", "^", 
                RowBox[{"-", "3"}]}], ")"}]}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "nDispatch"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"ESOCDispValAll", "/", 
              RowBox[{"varsCapaVal", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"boolsBatDispValAll", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"varsboolsBatDisp", "//", "Flatten"}], ")"}], "/.", 
            "cRuleStage1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nStoDispValAll", "=", 
        RowBox[{
         RowBox[{"varsStateDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"boolsExchangeDispValAll", "=", 
        RowBox[{"varsboolsExchangeDisp", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispValAll", "=", 
        RowBox[{"pwCurtDisp", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispValAll", "=", 
        RowBox[{"pPurchDisp", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pAEInnerDispValAllStage1", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pAEPurchDispValAllStage1", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "5"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pSAInnerDispValAllStage1", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "9"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pSAPurchDispValAllStage1", "=", 
        RowBox[{
         RowBox[{"varsCtrlDisp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "10"}], "]"}], "]"}], "/.", "cRuleStage1"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ERenFinal", "=", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "pwNormMeanValAll"}], "+", 
          RowBox[{
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "pvNormMeanValAll"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"EwCurt", "=", " ", 
        RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"EInner", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"periodDispatch", "/", "3600"}], " ", "ERenFinal"}], "-", 
           RowBox[{
            RowBox[{"periodDispatch", "/", "3600"}], " ", 
            RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}]}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EPurch", "=", " ", 
        RowBox[{"Total", "[", "pPurchDispValAll", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EAE", "=", " ", 
        RowBox[{"Total", "[", "pAEDispValAll", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ESA", "=", " ", 
        RowBox[{"Total", "[", "pSADispValAll", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nH2", "=", " ", 
        RowBox[{"Total", "[", "qH2OutDispValAll", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EInner", "=", 
        RowBox[{
         RowBox[{"-", "EPurch"}], "+", "EAE", "+", "ESA"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Total power generation in a year is:\>\"", ",", 
         RowBox[{
          RowBox[{"periodDispatch", "/", "3600"}], " ", "ERenFinal"}], ",", 
         "\"\< MWh\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<year ahead dispatch finished! \>\"", ",", 
         "\"\<The maximum production of NH3 in a year is: \>\"", ",", 
         "nNH3Max", ",", "\"\< Nm3 = \>\"", ",", "mNH3Max", ",", 
         "\"\< t\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Total H2 production in a year is: \>\"", ",", "nH2Max", ",", 
         "\"\< Nm3, i.e. \>\"", ",", "mH2Max", ",", "\"\< t\>\""}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagWindCapa", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Optimal Capacity of Wind power is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< MW\>\""}], "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Given Capacity of Wind power is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< MW\>\""}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagSolarCapa", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Optimal Capacity of Solar power is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< MW\>\""}], "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Given Capacity of Solar power is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< MW\>\""}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagAECapa", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Optimal Capacity of Alkaline Electrolyzers is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "\"\< MW\>\""}], "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Given Capacity of Wind power is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "\"\< MW\>\""}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"bufferTime", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"varsCapaVal", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"mNH3Max", "/", "ConstG2L"}], ")"}]}], "*", "8760"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagHSCapa", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Optimal Capacity of Buffer Tank is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           "\"\< Nm3, i.e. buffer time is: \>\"", ",", "bufferTime", ",", 
           "\"\< h\>\""}], "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Given Capacity of Wind power is: \>\"", ",", 
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           "\"\< Nm3, i.e. buffer time is: \>\"", ",", 
           RowBox[{
            RowBox[{"varsCapaVal", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1000", "/", "yitaH2"}], " ", 
              RowBox[{"varsCapaVal", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], " ", ")"}]}], ",", 
           "\"\< h\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"flagBatExist", ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"flagBatCapaEnergy", ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Optimal Capacity of Battery is: \>\"", ",", 
              RowBox[{"varsCapaVal", "[", 
               RowBox[{"[", "5", "]"}], "]"}], ",", "\"\< MWh\>\""}], "]"}], 
            ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Given Capacity of Battery is: \>\"", ",", 
              RowBox[{"varsCapaVal", "[", 
               RowBox[{"[", "5", "]"}], "]"}], ",", "\"\< MWh\>\""}], "]"}]}],
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Total curtailment of wind power in a year is: \>\"", ",", 
         RowBox[{
          RowBox[{"periodDispatch", "/", "3600"}], " ", 
          RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}], ",", 
         "\"\< MWh. Rate: \>\"", ",", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"pwCurtDispValAll", "/", "ERenFinal"}], "]"}], "//", 
          "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Total Power purchase from grid in a year is: \>\"", ",", 
         RowBox[{
          RowBox[{"periodDispatch", "/", "3600"}], " ", 
          RowBox[{"Total", "[", "pPurchDispValAll", "]"}]}], ",", 
         "\"\< MWh. Rate: \>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "pPurchDispValAll", "]"}], "/", 
           "ERenFinal"}], "//", "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Net Profit of the whole system\:ff1a \>\"", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"fFuncDispSingle", "/.", "cRuleStage1"}], ")"}]}], "/", 
          RowBox[{"10", "^", "4"}]}], ",", "\"\< *10^8 \:ffe5\>\""}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"(*", 
       RowBox[{"Stage2", ":", " ", 
        RowBox[{"price", " ", "optimization"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"varsEAEA", "=", 
        RowBox[{"{", 
         RowBox[{"EAEInner", ",", "EAEPurch"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsESAA", "=", 
        RowBox[{"{", 
         RowBox[{"ESAInner", ",", "ESAPurch"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pAEInnerDisp", "=", 
        RowBox[{"varsCtrlDisp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pAEPurchDisp", "=", 
        RowBox[{"varsCtrlDisp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "5"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pSAInnerDisp", "=", 
        RowBox[{"varsCtrlDisp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "9"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pSAPurchDisp", "=", 
        RowBox[{"varsCtrlDisp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "10"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Distribution", " ", "of", " ", "total", " ", "capacity", " ", 
         "cost"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CapaCostVal", "=", 
        RowBox[{"fFuncCapacityCost", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rateCapaCostAEA", "=", 
        RowBox[{"{", "rateCapaCostAE", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rateCapaCostSAA", "=", 
        RowBox[{"{", "rateCapaCostSA", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hFuncCapaCost", "=", 
        RowBox[{"{", 
         RowBox[{"rateCapaCostAE", "+", "rateCapaCostSA", "-", "1"}], "}"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncCapaCost", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0", "-", "rateCapaCostAE"}], ",", 
          RowBox[{"0", "-", "rateCapaCostSA"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MaxpAEPurchA", "=", 
        RowBox[{"{", "MaxpAEPurch", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MaxpSAPurchA", "=", 
        RowBox[{"{", "MaxpSAPurch", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pPurchMaxVal", "=", 
        RowBox[{"Max", "[", "pPurchDispValAll", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncCapacityCostStage2", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pAEPurchDisp", "-", "MaxpAEPurch"}], ",", 
          RowBox[{"pSAPurchDisp", "-", "MaxpSAPurch"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"{", 
            RowBox[{"MaxpAEPurch", "-", "pPurchMaxVal"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"MaxpSAPurch", "-", "pPurchMaxVal"}], "}"}]}], "*)"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"hFuncStage2Part1", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EAEInner", "+", "EAEPurch", "-", "EAE"}], ",", 
            RowBox[{"ESAInner", "+", "ESAPurch", "-", "ESA"}], ",", 
            RowBox[{"EAEInner", "+", "ESAInner", "-", "EInner"}], ",", 
            RowBox[{"EAEPurch", "+", "ESAPurch", "-", "EPurch"}]}], "}"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"hFuncStage2Part1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EAEInner", "-", 
           RowBox[{"Total", "[", "pAEInnerDisp", "]"}]}], ",", 
          RowBox[{"EAEPurch", "-", 
           RowBox[{"Total", "[", "pAEPurchDisp", "]"}]}], ",", 
          RowBox[{"ESAInner", "-", 
           RowBox[{"Total", "[", "pSAInnerDisp", "]"}]}], ",", 
          RowBox[{"ESAPurch", "-", 
           RowBox[{"Total", "[", "pSAPurchDisp", "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncStage2Part2", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pAEInnerDisp", "+", "pAEPurchDisp", "-", "pAEDispValAll"}],
           ",", 
          RowBox[{"pSAInnerDisp", "+", "pSAPurchDisp", "-", "pSADispValAll"}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{
            "pAEInnerDisp", "+", "pSAInnerDisp", "-", "pPurchDispValAll", "-",
              "pAEDispValAll", "-", "pSADispValAll"}]}], "*)"}], ",", 
          RowBox[{
          "pAEPurchDisp", "+", "pSAPurchDisp", "-", "pPurchDispValAll"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncStage2Part1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"0", "-", "pAEInnerDisp"}], ",", 
          RowBox[{"0", "-", "pAEPurchDisp"}], ",", 
          RowBox[{"0", "-", "pSAInnerDisp"}], ",", 
          RowBox[{"0", "-", "pSAPurchDisp"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"bilinear", " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boolsepIA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<boolsepI\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"nDiscret", "-", "1"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"boolspH2IA", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<boolspH2I\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"nDiscret", "-", "1"}]}], "]"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncprice", "=", 
        RowBox[{"{", 
         RowBox[{"priceInner", "-", 
          RowBox[{"boundarypriceInner", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"boundarypriceInner", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"boundarypriceInner", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "nDiscret"}], 
           " ", 
           RowBox[{"Total", "[", "boolsepIA", "]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"priceH2Inner", "-", 
            RowBox[{"boundarypriceH2Inner", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"boundarypriceH2Inner", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"boundarypriceH2Inner", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "nDiscret"}], 
             " ", 
             RowBox[{"Total", "[", "boolspH2IA", "]"}]}]}]}], "*)"}], "}"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncprice", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"boundarypriceInner", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "priceInner"}], ",", 
          RowBox[{"priceInner", "-", 
           RowBox[{"boundarypriceInner", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"boundarypriceH2Inner", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "priceH2Inner"}], ",", 
          RowBox[{"priceH2Inner", "-", 
           RowBox[{"boundarypriceH2Inner", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"boolsepIXEAEInnerA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<X\>\"", "<>", 
            "\"\<EAEInner\>\""}], "]"}], "&"}], "/@", "boolsepIA"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"boolsepIXESAInnerA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<X\>\"", "<>", 
            "\"\<ESAInner\>\""}], "]"}], "&"}], "/@", "boolsepIA"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"big", "-", 
         RowBox[{"M", " ", "method"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"10", "^", "8"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"notice", " ", "EAE", " ", 
         RowBox[{"10", "^", "5"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"gFuncBigMPart1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EAEInner", "-", 
           RowBox[{"M", 
            RowBox[{"(", 
             RowBox[{"1", "-", "boolsepIA"}], ")"}]}], "-", 
           "boolsepIXEAEInnerA"}], ",", 
          RowBox[{"boolsepIXEAEInnerA", "-", "EAEInner", "-", 
           RowBox[{"M", 
            RowBox[{"(", 
             RowBox[{"1", "-", "boolsepIA"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "M"}], " ", "boolsepIA"}], "-", 
           "boolsepIXEAEInnerA"}], ",", 
          RowBox[{"boolsepIXEAEInnerA", "-", 
           RowBox[{"M", " ", "boolsepIA"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncBigMPart2", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"ESAInner", "-", 
           RowBox[{"M", 
            RowBox[{"(", 
             RowBox[{"1", "-", "boolsepIA"}], ")"}]}], "-", 
           "boolsepIXESAInnerA"}], ",", 
          RowBox[{"boolsepIXESAInnerA", "-", "ESAInner", "-", 
           RowBox[{"M", 
            RowBox[{"(", 
             RowBox[{"1", "-", "boolsepIA"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "M"}], " ", "boolsepIA"}], "-", 
           "boolsepIXESAInnerA"}], ",", 
          RowBox[{"boolsepIXESAInnerA", "-", 
           RowBox[{"M", " ", "boolsepIA"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "investment", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"InvestRen", "=", 
        RowBox[{"fFuncRenInvest", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InvestAEHS", "=", 
        RowBox[{"fFuncAEHSInvest", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InvestSA", "=", 
        RowBox[{"fFuncSAInvest", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"operation", " ", "profit"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"fFuncOPRen", "=", 
          RowBox[{
           RowBox[{"periodDispatch", "/", "3600"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"priceInner", 
               RowBox[{"(", 
                RowBox[{"ERenFinal", "-", "EwCurt"}], ")"}]}], "+", 
              RowBox[{"priceFIT", " ", "EwCurt"}]}], ")"}], "/", 
            RowBox[{"10", "^", "4"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fFuncOPAEHS", "=", 
          RowBox[{
           RowBox[{"periodDispatch", "/", "3600"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"priceH2Inner", " ", "nH2"}], "-", 
              RowBox[{"priceInner", " ", "EAEInner"}], "-", 
              RowBox[{"pricePurch", " ", "EAEPurch"}]}], ")"}], "/", 
            RowBox[{"10", "^", "4"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fFuncOPSA", "=", 
          RowBox[{
           RowBox[{"periodDispatch", "/", "3600"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"priceNH3", " ", "ConstG2L", " ", "nH2"}], "-", 
              RowBox[{"priceInner", " ", "ESAInner"}], "-", 
              RowBox[{"pricePurch", " ", "ESAPurch"}], "-", 
              RowBox[{"priceH2Inner", " ", "nH2"}]}], ")"}], "/", 
            RowBox[{"10", "^", "4"}]}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fFuncOPRen", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"periodDispatch", "/", "3600"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"priceInner", 
              RowBox[{"(", 
               RowBox[{"ERenFinal", "-", "EwCurt"}], ")"}]}], "+", 
             RowBox[{"Total", "[", 
              RowBox[{"TOUHYearMeanVal", "*", "pwCurtDispValAll"}], "]"}]}], 
            RowBox[{"(*", 
             RowBox[{"priceFIT", " ", "EwCurt"}], "*)"}], ")"}], "/", 
           RowBox[{"10", "^", "4"}]}]}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ISOM", " ", "varsCapaSolar"}], "+", 
            RowBox[{"IWOM", " ", "varsCapaWind"}]}], "/.", "cRuleStage1"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fFuncOPAEHS", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"periodDispatch", "/", "3600"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"priceH2Inner", " ", "nH2"}], "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"boundarypriceInner", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "EAEInner"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"boundarypriceInner", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"boundarypriceInner", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
                 "nDiscret"}], " ", 
                RowBox[{"Total", "[", "boolsepIXEAEInnerA", "]"}]}]}], ")"}], 
             "-", 
             RowBox[{"Total", "[", 
              RowBox[{"TOUHYearPurchMeanVal", "*", "pAEPurchDisp"}], "]"}]}], 
            RowBox[{"(*", 
             RowBox[{"pricePurch", " ", "EAEPurch"}], "*)"}], ")"}], "/", 
           RowBox[{"10", "^", "4"}]}]}], "-", 
         RowBox[{"priceH2O", " ", "CoeffmH2TomH2O", " ", 
          RowBox[{"mH2Max", "/", 
           RowBox[{"10", "^", "4"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"-", "645"}], "*)"}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"IAEOM", " ", "varsCapaAE"}], "+", 
            RowBox[{"IHSOM", " ", "varsCapaHS"}]}], "/.", "cRuleStage1"}], 
          ")"}], "-", 
         RowBox[{"rateCapaCostAE", " ", "CapaCostVal"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fFuncOPSA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"periodDispatch", "/", "3600"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"priceNH3", " ", "ConstG2L", " ", "nH2"}], "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"boundarypriceInner", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "ESAInner"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"boundarypriceInner", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"boundarypriceInner", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
                 "nDiscret"}], " ", 
                RowBox[{"Total", "[", "boolsepIXESAInnerA", "]"}]}]}], ")"}], 
             "-", 
             RowBox[{"Total", "[", 
              RowBox[{"TOUHYearPurchMeanVal", "*", "pSAPurchDisp"}], "]"}], 
             RowBox[{"(*", 
              RowBox[{"pricePurch", " ", "ESAPurch"}], "*)"}], "-", 
             RowBox[{"priceH2Inner", " ", "nH2"}]}], ")"}], "/", 
           RowBox[{"10", "^", "4"}]}]}], "-", 
         RowBox[{"priceH2O", " ", "CoeffmNH3TomH2O", " ", 
          RowBox[{"mNH3Max", "/", 
           RowBox[{"10", "^", "4"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"-", "1275"}], "*)"}], "-", "ISAOM", "-", 
         RowBox[{"rateCapaCostSA", " ", "CapaCostVal"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"earn", " ", "rate", " ", "of", " ", "each", " ", "agents"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsERA", "=", 
        RowBox[{"{", 
         RowBox[{"ERRen", ",", "ERAEHS", ",", "ERSA"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsObjNormA", "=", 
        RowBox[{"{", 
         RowBox[{"varsObjNorm1", ",", "varsObjNorm2"}], 
         RowBox[{"(*", 
          RowBox[{",", "varsObjNorm3"}], "*)"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncStage2Norm", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "varsObjNorm1"}], "-", 
           RowBox[{"(", 
            RowBox[{"ERRen", "-", "ERAEHS"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ERRen", "-", "ERAEHS"}], ")"}], "-", "varsObjNorm1"}], 
          ",", 
          RowBox[{
           RowBox[{"-", "varsObjNorm2"}], "-", 
           RowBox[{"(", 
            RowBox[{"ERAEHS", "-", "ERSA"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ERAEHS", "-", "ERSA"}], ")"}], "-", "varsObjNorm2"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{
            RowBox[{"-", "varsObjNorm3"}], "-", 
            RowBox[{"(", 
             RowBox[{"ERSA", "-", "ERRen"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ERSA", "-", "ERRen"}], ")"}], "-", "varsObjNorm3"}]}], 
          "*)"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gFuncStage2ER", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"IRRLower", "-", "varsERA"}], ",", 
          RowBox[{"varsERA", "-", "IRRUpper"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncER", "=", 
        RowBox[{"varsERA", "-", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fFuncOPRen", "-", "InvestRen"}], ")"}], "/", 
            "InvestRen"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fFuncOPAEHS", "-", "InvestAEHS"}], ")"}], "/", 
            "InvestAEHS"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fFuncOPSA", "-", "InvestSA"}], ")"}], "/", 
            "InvestSA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ERRen", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"fFuncOPRen", "-", "InvestRen"}], ")"}], "/", 
           "InvestRen"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ERAEHS", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"fFuncOPAEHS", "-", "InvestAEHS"}], ")"}], "/", 
           "InvestAEHS"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ERSA", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"fFuncOPSA", "-", "InvestSA"}], ")"}], "/", 
           "InvestSA"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "Objective", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fFuncStage2", "=", 
        RowBox[{"Total", "[", "varsObjNormA", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"equality", " ", "constraints"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"hFuncStage2", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
          "hFuncStage2Part1", ",", "hFuncprice", ",", "hFuncER", ",", 
           "hFuncStage2Part2", ",", "hFuncCapaCost"}], "]"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"inequality", " ", "constraints"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"gFuncStage2", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
          "gFuncStage2Part1", ",", "gFuncBigMPart1", ",", "gFuncBigMPart2", 
           ",", "gFuncStage2Norm", ",", "gFuncStage2ER", ",", "gFuncprice", 
           RowBox[{"(*", 
            RowBox[{",", "gFuncCapacityCostStage2"}], "*)"}], ",", 
           "gFuncCapaCost"}], "]"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"continue", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varsRealStage2", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
          "priceInnerA", ",", "priceH2InnerA", ",", "varsEAEA", ",", 
           "varsESAA", ",", "boolsepIXEAEInnerA", ",", "boolsepIXESAInnerA", 
           ",", "varsERA", ",", "varsObjNormA", ",", "pAEInnerDisp", ",", 
           "pAEPurchDisp", ",", "pSAInnerDisp", ",", "pSAPurchDisp", ",", 
           "rateCapaCostAEA", ",", "rateCapaCostSAA"}], 
          RowBox[{"(*", 
           RowBox[{",", "MaxpAEPurchA", ",", "MaxpSAPurchA"}], "*)"}], "]"}], 
         "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"0", "-", 
         RowBox[{"1", " ", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boolsStage2", "=", 
        RowBox[{
         RowBox[{"Join", "[", "boolsepIA", 
          RowBox[{"(*", 
           RowBox[{",", "boolspH2IA"}], "*)"}], "]"}], "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"solve", " ", "dispatch", " ", "problem"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"bSolved", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagRepeat", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"using", " ", "gurobi"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"!", "bSolved"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"fFunc", "=", 
            RowBox[{"fFuncStage2", "//", "Chop"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"hFunc", "=", 
            RowBox[{"hFuncStage2", "//", "Chop"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gFunc", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"gFuncStage2", ",", 
                RowBox[{"0", "-", "boolsStage2"}], ",", 
                RowBox[{"boolsStage2", "-", "1"}]}], "]"}], "//", "Flatten"}],
              "//", "Chop"}]}], ";"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"gFunc", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"hFunc", ",", 
                RowBox[{"gFuncDisp", "/.", 
                 RowBox[{"LoadNH3Min", "\[Rule]", "relaxVal"}]}], ",", 
                "boolsDisp"}], "]"}], "//", "Chop"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gLower", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"hFunc", "//", "Length"}], "}"}]}], "]"}], ",", 
                "gLowerDisp", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"boolsDisp", "//", "Length"}], "}"}]}], "]"}]}], 
               "]"}], "//", "Chop"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"gUpper", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"hFunc", "//", "Length"}], "}"}]}], "]"}], ",", 
                "gUpperDisp", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"{", 
                   RowBox[{"boolsDisp", "//", "Length"}], "}"}]}], "]"}]}], 
               "]"}], "//", "Chop"}]}]}], "*)"}], ";", "\[IndentingNewLine]", 
          RowBox[{"vars", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"varsRealStage2", ",", "boolsStage2"}], "]"}], "//", 
            "Flatten"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"varsDef", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Element", "[", 
                RowBox[{
                 RowBox[{"varsRealStage2", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "Reals"}], "]"}], 
               "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"varsRealStage2", "//", "Length"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Element", "[", 
                RowBox[{
                 RowBox[{"boolsStage2", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "Integers"}], "]"}], 
               "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"boolsStage2", "//", "Length"}], "]"}]}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<Stage 2:\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tsGurobi", "=", 
           RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cRuleStage2", "=", 
           RowBox[{
            RowBox[{"LinearOptimization", "[", 
             RowBox[{"fFunc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"hFunc", "==", "0"}], ",", 
                RowBox[{"gFunc", "\[VectorLessEqual]", "0"}]}], "}"}], ",", 
              "varsDef", ",", 
              RowBox[{"Method", "\[Rule]", "\"\<Gurobi\>\""}]}], "]"}], "//", 
            "Dispatch"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<All time used in optimization by gurobi: \>\"", ",", 
            RowBox[{
             RowBox[{"AbsoluteTime", "[", "]"}], "-", "tsGurobi"}], ",", 
            "Red"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"First", "[", "varsRealStage2", "]"}], ")"}], "/.", 
              "cRuleStage2"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bSolved", "=", "True"}], ";", 
             RowBox[{"Break", "[", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"flagRepeat", "+=", "1"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"flagRepeat", ">", "1"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Optimal Inner electricity price is: \>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"priceInner", "/.", "cRuleStage2"}], ")"}], "/", "1000"}], 
         ",", "\"\< \:ffe5/kWh\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Optimal Inner hydrogen price is: \>\"", ",", 
         RowBox[{"(", 
          RowBox[{"priceH2Inner", "/.", "cRuleStage2"}], ")"}], ",", 
         "\"\< \:ffe5/Nm3\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<earning ratio of each agents: \>\"", ",", 
         RowBox[{"varsERA", "/.", "cRuleStage2"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pAEInnerDispValAll", "=", 
        RowBox[{"pAEInnerDisp", "/.", "cRuleStage2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pAEPurchDispValAll", "=", 
        RowBox[{"pAEPurchDisp", "/.", "cRuleStage2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pSAInnerDispValAll", "=", 
        RowBox[{"pSAInnerDisp", "/.", "cRuleStage2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pSAPurchDispValAll", "=", 
        RowBox[{"pSAPurchDisp", "/.", "cRuleStage2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CostH2Inner", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"priceInner", " ", "EAEInner"}], "/.", "cRuleStage2"}], 
           ")"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CostH2Purch", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"TOUHYearPurchMeanVal", "*", "pAEPurchDisp"}], "]"}], "/.",
             "cRuleStage2"}], ")"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CostNH3Inner", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"priceInner", " ", "ESAInner"}], "/.", "cRuleStage2"}], 
           ")"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CostNH3Purch", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"TOUHYearPurchMeanVal", "*", "pSAPurchDisp"}], "]"}], "/.",
             "cRuleStage2"}], ")"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"profitRenInner", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ERenFinal", "-", 
            RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}], ")"}], "/", 
          RowBox[{"10", "^", "5"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"priceInner", " ", "/.", "cRuleStage2"}], ")"}], "/", 
          "1000"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"profitRenPurch", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"TOUHYearMeanVal", "*", "pwCurtDispValAll"}], "]"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"profitH2", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{"Total", "[", "qH2InDispValAll", "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"priceH2Inner", "/.", "cRuleStage2"}], ")"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"costH2", "=", 
        RowBox[{
         RowBox[{"periodDispatch", "/", "3600"}], 
         RowBox[{"Total", "[", "qH2OutDispValAll", "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"priceH2Inner", "/.", "cRuleStage2"}], ")"}], "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ProfitNH3", "=", 
        RowBox[{"mNH3Max", " ", 
         RowBox[{"priceNH3", "/", 
          RowBox[{"10", "^", "8"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LCOE", "=", 
        RowBox[{"10", 
         RowBox[{"InvestRen", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"periodDispatchIn", "/", "3600"}], " ", "ERenFinal"}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LCOH", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"10", "^", "4"}], "InvestAEHS"}], "+", 
           RowBox[{
            RowBox[{"10", "^", "8"}], 
            RowBox[{"(", 
             RowBox[{"CostH2Inner", "+", "CostH2Purch"}], ")"}]}]}], ")"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"periodDispatchIn", "/", "3600"}], " ", 
           RowBox[{"Total", "[", "qH2InDispValAll", "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LCOA", "=", 
        RowBox[{
         RowBox[{"10", "^", "4"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"InvestSA", "+", 
            RowBox[{
             RowBox[{"10", "^", "4"}], 
             RowBox[{"(", 
              RowBox[{"CostNH3Inner", "+", "CostNH3Purch", "+", "costH2"}], 
              ")"}]}]}], ")"}], "/", "mNH3Max"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<LCOE of Renewable Energy Generation is: \>\"", ",", "LCOE", ",", 
         "\"\< \:ffe5/kWh\>\""}], "]"}], ";", "\n", "     ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<LCOH of AEHS is: \>\"", ",", "LCOH", ",", 
         "\"\< \:ffe5/Nm3\>\""}], "]"}], ";", "\n", "     ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<LCOA of SA is: \>\"", ",", "LCOA", ",", "\"\< \:ffe5/t\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"flagPrint", "=", 
        RowBox[{"flagCapa", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flagPrint", "==", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:53ef\:518d\:751f\:80fd\:6e90\:5236\:6c22\:5408\:6210\:6c28\
\:7cfb\:7edf\:ff1a\>\"", ",", "Red"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:603b\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\
\:5e74\:ff09\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "fFuncRenInvest", "+", "fFuncAEHSInvest", "+", 
                "fFuncSAInvest"}], "/.", "cRuleStage1"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:8fd0\:884c\:6536\:76ca\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fFuncOPRen", "+", "fFuncOPAEHS", "+", "fFuncOPSA"}], 
               "/.", "cRuleStage2"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:51c0\:6536\:76ca\:ff1a \>\"", ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"fFuncDispSingle", "/.", "cRuleStage1"}], ")"}]}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", 
            "\"\< \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\>\"", ",", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fFuncDispSingle", "/", 
                RowBox[{"(", 
                 RowBox[{
                 "fFuncRenInvest", "+", "fFuncAEHSInvest", "+", 
                  "fFuncSAInvest"}], ")"}]}], "/.", "cRuleStage1"}], 
              ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5bb9\:91cf\:8d39\:ff08\:6309\:6700\:5927\:9700\:91cf\:ff09\>\
\"", ",", 
            RowBox[{"10", "ConstCapacityMonth"}], ",", 
            "\"\< \:5143/kW/\:6708\:ff1b\:6bcf\:6708\:6700\:5927\:7f51\:7535\
\:9700\:91cf\:ff1a\>\"", ",", 
            RowBox[{"MaxpPurchA", "/.", "cRuleStage1"}], ",", 
            "\"\< MW\:ff1b\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"CapaCostVal", "/", 
              RowBox[{"10", "^", "4"}]}], "/.", "cRuleStage1"}], ",", 
            "\"\< \:4ebf\:5143\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:53ef\:518d\:751f\:80fd\:6e90\:53d1\:7535\:5de5\:6bb5:\>\"", 
            ",", "Red"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\
\:ff09\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fFuncRenInvest", "/.", "cRuleStage1"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:8fd0\:884c\:6536\:76ca\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fFuncOPRen", "/.", "cRuleStage2"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:51c0\:6536\:76ca\:ff1a \>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fFuncOPRen", "-", "InvestRen"}], "/.", 
               "cRuleStage2"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", 
            "\"\< \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\>\"", ",", 
            RowBox[{"ERRen", "/.", "cRuleStage2"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:5185\:90e8\:4f9b\:7535\:4ef7\:ff1a\>\"", ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"priceInner", " ", "/.", "cRuleStage2"}], ")"}], "/", 
             "1000"}], ",", 
            "\"\< \:5143/\:5ea6\:ff0c\:5185\:90e8\:4f9b\:7535\:91cf\:ff1a \
\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ERenFinal", "-", 
                RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}], ")"}], "/", 
              RowBox[{"10", "^", "5"}]}]}], ",", 
            "\"\< \:4ebf\:5ea6\:ff0c\:5185\:90e8\:4f9b\:7535\:6536\:76ca\:ff1a\
 \>\"", ",", "profitRenInner", ",", "\"\< \:4ebf\:5143\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:65b0\:80fd\:6e90\:4e0a\:7f51\:7535\:4ef7\:ff1a\>\"", ",", 
            RowBox[{"If", "[", 
             RowBox[{"flagTOUH", ",", "\"\<\:5206\:65f6\:7535\:4ef7\>\"", ",", 
              RowBox[{"priceFITGVal", "/", "1000"}]}], "]"}], ",", 
            "\"\< \:5143/\:5ea6\:ff0c\:4e0a\:7f51\:7535\:91cf\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], " ", 
             RowBox[{
              RowBox[{"Total", "[", "pwCurtDispValAll", "]"}], "/", 
              RowBox[{"10", "^", "5"}]}]}], ",", 
            "\"\< \:4ebf\:5ea6\:ff0c\:4e0a\:7f51\:6536\:76ca\:ff1a \>\"", ",",
             "profitRenPurch", ",", "\"\< \:4ebf\:5143\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5236\:6c22+\:50a8\:6c22\:5de5\:6bb5:\>\"", ",", "Red"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\
\:ff09\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fFuncAEHSInvest", "/.", "cRuleStage1"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:8fd0\:884c\:6536\:76ca\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fFuncOPAEHS", "/.", "cRuleStage2"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:51c0\:6536\:76ca\:ff1a \>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fFuncOPAEHS", "-", "InvestAEHS"}], "/.", 
               "cRuleStage2"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", 
            "\"\< \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\>\"", ",", 
            RowBox[{"ERAEHS", "/.", "cRuleStage2"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5bb9\:91cf\:8d39\:5206\:914d\:7cfb\:6570\:ff1a\>\"", ",", 
            RowBox[{"rateCapaCostAE", "/.", "cRuleStage2"}], ",", 
            "\"\< \:5bf9\:5e94\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rateCapaCostAE", "/.", "cRuleStage2"}], ")"}], 
             RowBox[{"CapaCostVal", "/", 
              RowBox[{"10", "^", "4"}]}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5236\:6c22\:5185\:90e8\:7528\:7535\:4ef7\:ff1a\>\"", ",", 
            " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"priceInner", " ", "/.", "cRuleStage2"}], ")"}], "/", 
             "1000"}], ",", 
            "\"\< \:5143/\:5ea6\:ff0c\:5236\:6c22\:5185\:90e8\:7528\:7535\
\:91cf\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"EAEInner", "/.", "cRuleStage2"}], ")"}], "/", 
              RowBox[{"10", "^", "5"}]}]}], ",", 
            "\"\< \:4ebf\:5ea6\:ff0c\:5185\:90e8\:7528\:7535\:5236\:6c22\:6210\
\:672c\:ff1a \>\"", ",", "CostH2Inner", ",", "\"\< \:4ebf\:5143\>\""}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:5236\:6c22\:5916\:8d2d\:7535\:4ef7\:ff1a\>\"", ",", 
            RowBox[{"If", "[", 
             RowBox[{
             "flagTOUHPurch", ",", "\"\<\:5206\:65f6\:7535\:4ef7\>\"", ",", 
              RowBox[{"pricePurchGVal", "/", "1000"}]}], "]"}], ",", 
            "\"\< \:5143/\:5ea6\:ff0c\:5236\:6c22\:5916\:8d2d\:7528\:7535\
\:91cf\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"EAEPurch", "/.", "cRuleStage2"}], ")"}], "/", 
              RowBox[{"10", "^", "5"}]}]}], ",", 
            "\"\< \:4ebf\:5ea6\:ff0c\:5916\:8d2d\:7f51\:7535\:5236\:6c22\:6210\
\:672c\:ff1a \>\"", ",", "CostH2Purch", ",", "\"\< \:4ebf\:5143\>\""}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:6c34\:4ef7\:ff1a\>\"", ",", " ", "priceH2O", ",", 
            "\"\< \:5143/\:5428\:ff0c\:5236\:6c22\:91cf\:ff1a\>\"", ",", 
            "mH2Max", ",", 
            "\"\< \:5428\:ff0c\:8865\:6c34\:7cfb\:6570\:ff1a \>\"", ",", 
            "CoeffmH2TomH2O", ",", 
            "\"\< ; \:5236\:6c22\:8865\:6c34\:8d39\:ff1a\>\"", ",", 
            RowBox[{"priceH2O", " ", "CoeffmH2TomH2O", " ", 
             RowBox[{"mH2Max", "/", 
              RowBox[{"10", "^", "8"}]}]}], ",", "\"\<\:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:6c22\:4ef7\:ff1a\>\"", ",", 
            RowBox[{"(", 
             RowBox[{"priceH2Inner", " ", "/.", "cRuleStage2"}], ")"}], " ", 
            ",", "\"\<\:5143/\:6807\:65b9\:ff0c\:6c22\:6c14\:5e74\:4ea7\:91cf\
\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], " ", 
             RowBox[{
              RowBox[{"Total", "[", "qH2InDispValAll", "]"}], "/", 
              RowBox[{"10", "^", "8"}]}]}], ",", 
            "\"\< \:4ebf\:6807\:65b9\:ff0c\:7ed9\:5408\:6210\:6c28\:5382\:4f9b\
\:6c22\:6536\:5165\:ff1a \>\"", ",", "profitH2", ",", 
            "\"\< \:4ebf\:5143\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:5408\:6210\:6c28\:5de5\:6bb5:\>\"", ",", "Red"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\
\:ff09\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fFuncSAInvest", "/.", "cRuleStage1"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:8fd0\:884c\:6536\:76ca\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fFuncOPSA", "/.", "cRuleStage2"}], ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:51c0\:6536\:76ca\:ff1a \>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fFuncOPSA", "-", "InvestSA"}], "/.", "cRuleStage2"}], 
              ")"}], "/", 
             RowBox[{"10", "^", "4"}]}], ",", 
            "\"\< \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\>\"", ",", 
            RowBox[{"ERSA", "/.", "cRuleStage2"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5bb9\:91cf\:8d39\:5206\:914d\:7cfb\:6570\:ff1a\>\"", ",", 
            RowBox[{"rateCapaCostSA", "/.", "cRuleStage2"}], ",", 
            "\"\< \:5bf9\:5e94\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rateCapaCostSA", "/.", "cRuleStage2"}], ")"}], 
             RowBox[{"CapaCostVal", "/", 
              RowBox[{"10", "^", "4"}]}]}], ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5236\:6c28\:5185\:90e8\:7528\:7535\:4ef7\:ff1a\>\"", ",", 
            " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"priceInner", " ", "/.", "cRuleStage2"}], ")"}], "/", 
             "1000"}], ",", 
            "\"\< \:5143/\:5ea6\:ff0c\:5236\:6c28\:5185\:90e8\:7528\:7535\
\:91cf\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ESAInner", "/.", "cRuleStage2"}], ")"}], "/", 
              RowBox[{"10", "^", "5"}]}]}], ",", 
            "\"\< \:4ebf\:5ea6\:ff0c\:5185\:90e8\:7528\:7535\:5236\:6c28\:6210\
\:672c\:ff1a \>\"", ",", "CostNH3Inner", ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:5236\:6c28\:5916\:8d2d\:7535\:4ef7\:ff1a\>\"", ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
             "flagTOUHPurch", ",", "\"\<\:5206\:65f6\:7535\:4ef7\>\"", ",", 
              RowBox[{"pricePurchGVal", "/", "1000"}]}], "]"}], ",", 
            "\"\< \:5143/\:5ea6\:ff0c\:5236\:6c28\:5916\:8d2d\:7528\:7535\
\:91cf\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"periodDispatch", "/", "3600"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ESAPurch", "/.", "cRuleStage2"}], ")"}], "/", 
              RowBox[{"10", "^", "5"}]}]}], ",", 
            "\"\< \:4ebf\:5ea6\:ff0c\:5916\:8d2d\:7f51\:7535\:5236\:6c28\:6210\
\:672c\:ff1a \>\"", ",", "CostNH3Purch", ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:6c22\:4ef7\:ff1a\>\"", ",", 
            RowBox[{"(", 
             RowBox[{"priceH2Inner", " ", "/.", "cRuleStage2"}], ")"}], " ", 
            ",", "\"\<\:5143/\:6807\:65b9\:ff0c\:6c22\:6c14\:5e74\:4ea7\:91cf\
\:ff1a\>\"", ",", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"periodDispatch", "/", "3600"}], " ", 
               "qH2OutDispValAll"}], "]"}], "/", 
             RowBox[{"10", "^", "8"}]}], ",", 
            "\"\< \:4ebf\:6807\:65b9\:ff0c\:5408\:6210\:6c28\:5382\:8d2d\:6c22\
\:6210\:672c\:ff1a \>\"", ",", "costH2", ",", "\"\< \:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\:6c34\:4ef7\:ff1a\>\"", ",", " ", "priceH2O", ",", 
            "\"\< \:5143/\:5428\:ff0c\:5236\:6c28\:91cf\:ff1a\>\"", ",", 
            "mNH3Max", ",", 
            "\"\< \:5428\:ff0c\:8865\:6c34\:7cfb\:6570\:ff1a \>\"", ",", 
            "CoeffmNH3TomH2O", ",", 
            "\"\< ; \:5236\:6c28\:8865\:6c34\:8d39\:ff1a\>\"", ",", 
            RowBox[{"priceH2O", " ", "CoeffmNH3TomH2O", " ", 
             RowBox[{"mNH3Max", "/", 
              RowBox[{"10", "^", "8"}]}]}], ",", "\"\<\:4ebf\:5143\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\:6c28\:4ef7\:ff1a\>\"", ",", 
            RowBox[{"(", 
             RowBox[{"priceNH3", " ", "/.", "cRuleStage1"}], ")"}], " ", ",", 
            "\"\<\:5143/\:5428\:ff0c\:6c28\:6c14\:5e74\:4ea7\:91cf\:ff1a\>\"",
             ",", "mNH3Max", ",", 
            "\"\< \:5428\:ff0c\:51fa\:552e\:6db2\:6c28\:7684\:6536\:76ca\:ff1a\
 \>\"", ",", "ProfitNH3", ",", "\"\< \:4ebf\:5143\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\:7535\:89e3\:6c60\:8d85\:8c03\:65f6\:95f4\:6bd4\:4f8b\:ff1a\>\"\
", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"pAEDispValAll", ",", 
              RowBox[{
               RowBox[{"#", ">", 
                RowBox[{"(", 
                 RowBox[{"varsCapaAE", "/.", "cRuleStage1"}], ")"}]}], 
               "&"}]}], "]"}], "]"}], "/", 
           RowBox[{"Length", "[", "pAEDispValAll", "]"}]}], "//", "N"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"resultCapa", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"varsCapaVal", ",", 
          RowBox[{"{", "bufferTime", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resultRate", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"pwCurtDispValAll", "/", "ERenFinal"}], "]"}], "//", 
           "N"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "pPurchDispValAll", "]"}], "/", 
            "ERenFinal"}], "//", "N"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"pwCurtDispValAll", "-", "pPurchDispValAll"}], "]"}], 
            "/", "ERenFinal"}], "//", "N"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resultEconmic", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"fFuncDispSingle", "/.", "cRuleStage1"}], ")"}]}], "}"}],
           ",", 
          RowBox[{"varsERA", "/.", "cRuleStage2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resultLCO", "=", 
        RowBox[{"{", 
         RowBox[{"LCOE", ",", "LCOH", ",", "LCOA"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "resultCapa", ",", "resultRate", ",", "resultEconmic", ",", 
         "resultLCO", ",", "cRuleStage1", ",", "cRuleStage2"}], "}"}]}], 
      "*)"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.846467301872423*^9, 3.8464674525223413`*^9}, {
   3.8464674886130757`*^9, 3.8464675537667227`*^9}, {3.8464675874628954`*^9, 
   3.846467836402087*^9}, {3.84646788187087*^9, 3.846467917127136*^9}, {
   3.8464679870456457`*^9, 3.8464680609205303`*^9}, {3.846468123469226*^9, 
   3.846468233259797*^9}, {3.8464682647687593`*^9, 3.8464682929757347`*^9}, {
   3.8464683637165794`*^9, 3.8464684349064913`*^9}, {3.8464689850125475`*^9, 
   3.8464690783537235`*^9}, {3.8464691250178385`*^9, 
   3.8464691755795097`*^9}, {3.8464692445868597`*^9, 3.8464694855882845`*^9}, 
   3.846470908049328*^9, {3.846470938583954*^9, 3.8464710345324965`*^9}, {
   3.8464710951111174`*^9, 3.846471232242114*^9}, {3.846471267842351*^9, 
   3.8464713383015738`*^9}, {3.8464713793184376`*^9, 3.846471444461915*^9}, {
   3.8464714751847696`*^9, 3.84647148480781*^9}, {3.8464715737775292`*^9, 
   3.8464716826245956`*^9}, {3.846471857818309*^9, 3.846471891244138*^9}, {
   3.8464720528832765`*^9, 3.8464720677290993`*^9}, {3.8464720993693466`*^9, 
   3.8464721431158576`*^9}, {3.8464721864214582`*^9, 3.846472282990575*^9}, {
   3.8464724965429*^9, 3.8464725468137517`*^9}, {3.846472738750063*^9, 
   3.8464727497161765`*^9}, {3.846472798813838*^9, 3.8464729637302585`*^9}, {
   3.846473119674657*^9, 3.8464731473588877`*^9}, {3.846473190624273*^9, 
   3.8464733155146046`*^9}, {3.8464733545633025`*^9, 3.846473393805978*^9}, {
   3.846473424101055*^9, 3.8464734361630692`*^9}, {3.8464734966530094`*^9, 
   3.846473564427489*^9}, {3.846473604531041*^9, 3.846473751555391*^9}, {
   3.846473784570835*^9, 3.8464738784076495`*^9}, {3.84647405718718*^9, 
   3.846474087144236*^9}, {3.846474202998293*^9, 3.846474274165887*^9}, {
   3.8464743798329973`*^9, 3.846474380406149*^9}, {3.8464745354483895`*^9, 
   3.8464748452364197`*^9}, {3.8464750405648117`*^9, 3.846475049325715*^9}, {
   3.846475135608158*^9, 3.84647516420158*^9}, {3.8464752399831343`*^9, 
   3.8464753349836645`*^9}, {3.846475394313836*^9, 3.8464754575720873`*^9}, {
   3.8464754907778034`*^9, 3.8464754908748474`*^9}, {3.8464755420720787`*^9, 
   3.8464755475408845`*^9}, {3.846475603527651*^9, 3.846475605207067*^9}, {
   3.8464757195706606`*^9, 3.8464757361831264`*^9}, {3.8464758068663216`*^9, 
   3.8464760093744745`*^9}, {3.8464761525875583`*^9, 3.846476193673872*^9}, {
   3.8464762239186535`*^9, 3.8464763932426023`*^9}, {3.846476483628996*^9, 
   3.846476543194867*^9}, {3.8464765824837923`*^9, 3.8464765828577538`*^9}, {
   3.846476680874913*^9, 3.846476785805352*^9}, {3.8464768179712534`*^9, 
   3.8464768768065944`*^9}, {3.8464769201138844`*^9, 3.8464770247217703`*^9}, 
   3.8464770770968456`*^9, {3.846477161233424*^9, 3.846477171098345*^9}, {
   3.846477273461643*^9, 3.846477320516039*^9}, {3.8464774160175433`*^9, 
   3.846477444457102*^9}, {3.8464775434195614`*^9, 3.846477597475415*^9}, {
   3.8464776549488716`*^9, 3.8464776661528587`*^9}, {3.8464778771238575`*^9, 
   3.846477881959839*^9}, {3.8464779148859386`*^9, 3.8464779659088287`*^9}, {
   3.846478001943535*^9, 3.846478006013563*^9}, {3.84647805765283*^9, 
   3.846478067186221*^9}, {3.846478100633632*^9, 3.8464781085346613`*^9}, {
   3.846478267937004*^9, 3.8464782756433353`*^9}, {3.8464784585331016`*^9, 
   3.8464784686797686`*^9}, {3.846478525344432*^9, 3.846478581308591*^9}, {
   3.846478616627683*^9, 3.84647865820452*^9}, {3.8464787158195763`*^9, 
   3.846478866423704*^9}, {3.8464789001612263`*^9, 3.846478902605109*^9}, {
   3.846478980658619*^9, 3.8464790165213003`*^9}, {3.846479058686184*^9, 
   3.8464792156893835`*^9}, {3.8464792763777304`*^9, 
   3.8464793193632636`*^9}, {3.846479383252498*^9, 3.8464793838217964`*^9}, {
   3.846479433634901*^9, 3.846479435396143*^9}, {3.846479478907879*^9, 
   3.8464794928340917`*^9}, {3.846479526093534*^9, 3.8464795388276463`*^9}, {
   3.8464795731917872`*^9, 3.846479608961067*^9}, {3.8464797076284404`*^9, 
   3.846479986932666*^9}, 3.846480040189455*^9, {3.846480092457534*^9, 
   3.846480826586302*^9}, {3.8464808705201693`*^9, 3.8464809584611607`*^9}, 
   3.8464810100454407`*^9, {3.8464810556104727`*^9, 3.8464810563723593`*^9}, {
   3.8464811332422795`*^9, 3.8464811658342943`*^9}, {3.8464812822519846`*^9, 
   3.8464812826840057`*^9}, 3.8464813197558193`*^9, {3.846481395235174*^9, 
   3.8464814944870157`*^9}, {3.8464816008430305`*^9, 
   3.8464817063741946`*^9}, {3.8464823061299343`*^9, 3.846482339501505*^9}, {
   3.84648251646087*^9, 3.8464825250296164`*^9}, {3.8464825635085073`*^9, 
   3.8464826254309735`*^9}, {3.8464827357870483`*^9, 3.846482764079796*^9}, {
   3.8464828840026093`*^9, 3.8464828937211266`*^9}, {3.846483086882474*^9, 
   3.8464830911917152`*^9}, 3.846483200231271*^9, {3.846483286803013*^9, 
   3.8464832941249466`*^9}, 3.8464856960408163`*^9, 3.8464857576388245`*^9, {
   3.8464861579666667`*^9, 3.8464861733220844`*^9}, {3.8464863813955703`*^9, 
   3.8464863936099443`*^9}, {3.846488429956373*^9, 3.8464884376661673`*^9}, {
   3.8464884966069355`*^9, 3.846488499417816*^9}, 3.846488856912589*^9, 
   3.8464894860559344`*^9, {3.8464898290461445`*^9, 3.846489843393196*^9}, 
   3.846490257603136*^9, {3.8465075961394844`*^9, 3.8465075986102457`*^9}, {
   3.8465698332367706`*^9, 3.846569839759555*^9}, {3.8465704435543633`*^9, 
   3.8465704767405324`*^9}, 3.846571094480754*^9, {3.846572339354409*^9, 
   3.8465723437600408`*^9}, {3.846572809777296*^9, 3.846572820691066*^9}, {
   3.846572900385233*^9, 3.84657290119407*^9}, 3.8465729801581097`*^9, 
   3.846573180252324*^9, {3.846573461463671*^9, 3.8465734632199726`*^9}, 
   3.8465736768158846`*^9, {3.846573734780007*^9, 3.8465737349026785`*^9}, {
   3.846573818629855*^9, 3.846573818996845*^9}, {3.8465739469025803`*^9, 
   3.846573948200348*^9}, 3.846573995299254*^9, {3.8465745649465284`*^9, 
   3.84657456524872*^9}, {3.846575497356476*^9, 3.8465755456080017`*^9}, {
   3.8465755901137643`*^9, 3.8465756711632376`*^9}, {3.84657571002164*^9, 
   3.846575771921944*^9}, {3.846575820006403*^9, 3.8465758242691936`*^9}, {
   3.8465758936963234`*^9, 3.846576134993307*^9}, {3.846576203258971*^9, 
   3.8465762046381245`*^9}, {3.8465772136699977`*^9, 
   3.8465772257562523`*^9}, {3.846577269533125*^9, 3.846577313198493*^9}, {
   3.8466246381610546`*^9, 3.846624655346986*^9}, {3.846624756072934*^9, 
   3.8466247742921457`*^9}, {3.8466370176300106`*^9, 3.84663705229988*^9}, {
   3.8466370902903996`*^9, 3.846637244178523*^9}, {3.8466374427681775`*^9, 
   3.8466374592800865`*^9}, {3.846637546480532*^9, 3.8466375473450823`*^9}, {
   3.846637883991192*^9, 3.8466378889186687`*^9}, {3.846638022822323*^9, 
   3.846638027849605*^9}, {3.8466382339139833`*^9, 3.846638268676512*^9}, {
   3.8466436344490666`*^9, 3.846643667239585*^9}, {3.846643749395466*^9, 
   3.846643755909253*^9}, {3.8466608745608797`*^9, 3.846660907185351*^9}, {
   3.8466609549294147`*^9, 3.846660977504081*^9}, {3.846661036367242*^9, 
   3.846661067091663*^9}, {3.8466613116996155`*^9, 3.846661411051794*^9}, {
   3.846662088659934*^9, 3.84666208888575*^9}, {3.8466628217863517`*^9, 
   3.8466629052860327`*^9}, {3.8468843918277097`*^9, 3.846884396212982*^9}, {
   3.846884450773116*^9, 3.846884457092334*^9}, {3.846894269626425*^9, 
   3.8468942836634274`*^9}, {3.846894381986316*^9, 3.846894384949187*^9}, {
   3.84689466637389*^9, 3.8468948402300134`*^9}, {3.8468948934369507`*^9, 
   3.846894919079918*^9}, {3.8469012139855537`*^9, 3.84690123581449*^9}, {
   3.8469012663115077`*^9, 3.846901271320897*^9}, 3.8469015622742176`*^9, {
   3.8469017792096233`*^9, 3.846901812997383*^9}, {3.84690184314804*^9, 
   3.846902053375317*^9}, 3.8469021307542353`*^9, {3.846902162286234*^9, 
   3.84690222931266*^9}, {3.8469022735410833`*^9, 3.846902387902743*^9}, {
   3.8469024873279915`*^9, 3.8469025225621257`*^9}, {3.8469026092932773`*^9, 
   3.8469026273078747`*^9}, {3.8469027135216045`*^9, 3.846902755548747*^9}, {
   3.8469028108527255`*^9, 3.8469032565173244`*^9}, {3.846903298527236*^9, 
   3.846903359829813*^9}, {3.8469033976204023`*^9, 3.846903564553689*^9}, {
   3.8469037641965623`*^9, 3.846903795616417*^9}, {3.846903939765379*^9, 
   3.8469039503996763`*^9}, {3.8469046874239397`*^9, 
   3.8469047092872763`*^9}, {3.8469049719724073`*^9, 
   3.8469051281715517`*^9}, {3.8469051695623765`*^9, 
   3.8469051712317724`*^9}, {3.8469052326247716`*^9, 
   3.8469052497639155`*^9}, {3.84690533200966*^9, 3.8469053380406227`*^9}, {
   3.846905425821621*^9, 3.846905431339573*^9}, {3.8469054695240345`*^9, 
   3.8469056112254944`*^9}, {3.8469056857745667`*^9, 3.846905723091398*^9}, {
   3.846905755144716*^9, 3.8469057767404175`*^9}, {3.846905817460992*^9, 
   3.8469058703589478`*^9}, 3.8469059966947594`*^9, {3.8469060925747385`*^9, 
   3.8469061612217565`*^9}, {3.8469062016495447`*^9, 3.84690627789655*^9}, {
   3.8469063080865364`*^9, 3.8469064613783875`*^9}, {3.8469065111430373`*^9, 
   3.8469066771800976`*^9}, {3.8469067090521727`*^9, 
   3.8469067501998825`*^9}, {3.846906784116549*^9, 3.8469069667511168`*^9}, {
   3.8469069982244816`*^9, 3.846907099199602*^9}, {3.8469071698622923`*^9, 
   3.8469071733532195`*^9}, {3.846907228680087*^9, 3.8469072365724196`*^9}, {
   3.846907283649086*^9, 3.846907377518057*^9}, {3.846907485598712*^9, 
   3.846907526471865*^9}, {3.846907565800017*^9, 3.8469075908698344`*^9}, {
   3.8469076245564837`*^9, 3.846907652697344*^9}, {3.8469077531711593`*^9, 
   3.8469078122977934`*^9}, {3.8469080559799175`*^9, 3.846908070098894*^9}, {
   3.846908451707896*^9, 3.846908513346629*^9}, 3.8469087450792103`*^9, {
   3.846908832010564*^9, 3.8469088616395283`*^9}, {3.8469093468538647`*^9, 
   3.846909348232707*^9}, {3.8469094961667404`*^9, 3.846909588990178*^9}, {
   3.846910594540989*^9, 3.846910603972827*^9}, {3.8469108164501905`*^9, 
   3.8469108506461563`*^9}, {3.8469108990732045`*^9, 3.846910912747096*^9}, {
   3.8469110880710635`*^9, 3.84691130670658*^9}, {3.846912713014407*^9, 
   3.846912748749829*^9}, {3.8469209129908743`*^9, 3.846921180617955*^9}, {
   3.8469212245029745`*^9, 3.846921396006711*^9}, {3.846921464148883*^9, 
   3.846921464577845*^9}, {3.846921501624707*^9, 3.8469215315533457`*^9}, {
   3.846921759687214*^9, 3.846921786171692*^9}, 3.8469223736583734`*^9, {
   3.84692691320819*^9, 3.846927020080984*^9}, 3.8470675907136483`*^9, {
   3.8471483230063553`*^9, 3.8471483776585994`*^9}, {3.8471497825928726`*^9, 
   3.8471498221965857`*^9}, {3.847150541993676*^9, 3.8471505575838356`*^9}, {
   3.847154098782934*^9, 3.847154111134507*^9}, {3.847154446506678*^9, 
   3.8471545152272825`*^9}, {3.8471554722087135`*^9, 
   3.8471554911538506`*^9}, {3.8471556273743696`*^9, 
   3.8471557560738754`*^9}, {3.8471557953214836`*^9, 
   3.8471558866787677`*^9}, {3.8471560136710653`*^9, 
   3.8471560227683725`*^9}, {3.847162421790949*^9, 3.8471624910846715`*^9}, {
   3.84727101377571*^9, 3.847271158678565*^9}, {3.847271233562605*^9, 
   3.847271238141361*^9}, {3.8472727253041253`*^9, 3.847272734199383*^9}, 
   3.847272896801427*^9, {3.847345470167583*^9, 3.847345474991253*^9}, {
   3.847345524384418*^9, 3.8473455417832937`*^9}, {3.8473461998198333`*^9, 
   3.8473462337430573`*^9}, 3.8473467894886265`*^9, {3.847346989902158*^9, 
   3.8473469906521463`*^9}, {3.8473477706901817`*^9, 
   3.8473477926955934`*^9}, {3.847348187343906*^9, 3.847348203822386*^9}, {
   3.8473517011352854`*^9, 3.8473517175383925`*^9}, {3.8474125684968185`*^9, 
   3.8474126160050306`*^9}, {3.847413193958384*^9, 3.847413270249305*^9}, {
   3.8474133043243217`*^9, 3.8474133212917395`*^9}, {3.847416067569743*^9, 
   3.847416126186696*^9}, 3.847416209202967*^9, {3.8474183916015215`*^9, 
   3.8474184371545486`*^9}, {3.8474184673110533`*^9, 3.847418488937068*^9}, {
   3.8474185291607523`*^9, 3.8474185674598255`*^9}, {3.847418602455335*^9, 
   3.847418658940772*^9}, {3.847418751990383*^9, 3.84741881340057*^9}, {
   3.847418870178912*^9, 3.8474190024095182`*^9}, {3.8474192364472823`*^9, 
   3.847419266542593*^9}, {3.8474195910959187`*^9, 3.84741974345772*^9}, {
   3.8474221251342134`*^9, 3.8474221338351173`*^9}, {3.847422164070989*^9, 
   3.847422204391198*^9}, {3.847422255995016*^9, 3.847422287858979*^9}, {
   3.8474286215970716`*^9, 3.847428626681918*^9}, {3.847428728947898*^9, 
   3.8474287324556875`*^9}, {3.8474288875211096`*^9, 
   3.8474289563621573`*^9}, {3.847429007864915*^9, 3.8474290348315597`*^9}, {
   3.847429132362197*^9, 3.8474291355169067`*^9}, 3.8474299130470805`*^9, {
   3.8474301931434*^9, 3.847430203711751*^9}, {3.847430294946331*^9, 
   3.8474302967645793`*^9}, {3.847430381607442*^9, 3.8474304007949667`*^9}, {
   3.8474310458138433`*^9, 3.847431051971548*^9}, {3.847431300987263*^9, 
   3.8474313063591967`*^9}, {3.8474374882122855`*^9, 
   3.8474374926132526`*^9}, {3.847437666717792*^9, 3.8474376714977703`*^9}, {
   3.847437739764072*^9, 3.8474377452064805`*^9}, {3.847437924287406*^9, 
   3.8474379265797276`*^9}, {3.847437982647521*^9, 3.8474379843931*^9}, {
   3.8474386347929335`*^9, 3.8474386349298697`*^9}, {3.847439097086689*^9, 
   3.8474391537403803`*^9}, 3.8474406404917183`*^9, 3.8474406711268997`*^9, {
   3.847440708972979*^9, 3.84744071367861*^9}, {3.8474407439481387`*^9, 
   3.847440752262498*^9}, {3.8474412902327433`*^9, 3.8474413737416162`*^9}, 
   3.847441405433642*^9, {3.847492442456509*^9, 3.84749246776589*^9}, {
   3.8474925132788467`*^9, 3.8474925616242065`*^9}, {3.847492804160713*^9, 
   3.8474928050268536`*^9}, {3.8474929154903507`*^9, 
   3.8474929156665545`*^9}, {3.8474930706327567`*^9, 
   3.8474931676381936`*^9}, {3.847494583280979*^9, 3.847494601126281*^9}, 
   3.847500149182875*^9, {3.8475035003921623`*^9, 3.8475035256845675`*^9}, {
   3.847520121327857*^9, 3.8475201352157316`*^9}, {3.847520180720806*^9, 
   3.847520363962047*^9}, {3.84752041897334*^9, 3.847520656737609*^9}, {
   3.8475207021364903`*^9, 3.847520735974282*^9}, {3.847520778064844*^9, 
   3.8475208864291673`*^9}, {3.8475209956517515`*^9, 3.847521275586414*^9}, {
   3.847521315812171*^9, 3.847521382563336*^9}, {3.8475214827872005`*^9, 
   3.8475214955543733`*^9}, {3.8475215881123333`*^9, 3.847521605037524*^9}, {
   3.847521640416074*^9, 3.8475218475110145`*^9}, {3.8475227469957457`*^9, 
   3.8475227677032537`*^9}, {3.847523207058222*^9, 3.8475232097778645`*^9}, {
   3.847525206739131*^9, 3.8475252107093983`*^9}, 3.8475254407587976`*^9, {
   3.8475259070255284`*^9, 3.8475259097014785`*^9}, {3.847526750342512*^9, 
   3.8475267551820307`*^9}, 3.8475268397921157`*^9, {3.847527655276453*^9, 
   3.8475276704490633`*^9}, 3.847527764358358*^9, {3.8475278176759567`*^9, 
   3.8475278182823334`*^9}, {3.8475280690423355`*^9, 3.847528070334469*^9}, {
   3.8475282977846746`*^9, 3.8475283112150283`*^9}, {3.8475283430988455`*^9, 
   3.847528347442235*^9}, {3.8475283826733875`*^9, 3.8475284238024907`*^9}, {
   3.847528806482546*^9, 3.8475288121318007`*^9}, {3.8475290318425655`*^9, 
   3.8475290449241533`*^9}, {3.8475292365036345`*^9, 3.84752923663092*^9}, {
   3.8475293333422346`*^9, 3.847529336610747*^9}, {3.8475293767483845`*^9, 
   3.847529389311451*^9}, {3.8475295400229006`*^9, 3.8475296124613905`*^9}, {
   3.8475296504693537`*^9, 3.847529653069133*^9}, 3.847529687024888*^9, 
   3.8475302354021044`*^9, {3.847530320519174*^9, 3.847530380594798*^9}, 
   3.8475305571425714`*^9, {3.847530591695325*^9, 3.8475306310006695`*^9}, {
   3.8475307780026264`*^9, 3.8475307789304514`*^9}, {3.847531146152506*^9, 
   3.8475311990765224`*^9}, {3.847750116658121*^9, 3.847750194066403*^9}, {
   3.8477604224429026`*^9, 3.847760424391247*^9}, 3.8479511967292814`*^9, {
   3.8479514684665227`*^9, 3.8479515251373076`*^9}, 3.848183143301163*^9, {
   3.8481839064135695`*^9, 3.848184037220603*^9}, {3.8481874887016773`*^9, 
   3.8481874990743685`*^9}, 3.8482200279036903`*^9, {3.848275257707796*^9, 
   3.8482752612619524`*^9}, {3.8482759356546564`*^9, 
   3.8482759845050845`*^9}, {3.848370898779986*^9, 3.8483709232021856`*^9}, {
   3.8483715373356934`*^9, 3.848371540034198*^9}, {3.848371828452159*^9, 
   3.8483718406151533`*^9}, 3.848372682832653*^9, 3.8483745184842215`*^9, 
   3.8483850062902875`*^9, {3.848385048811482*^9, 3.8483852515058117`*^9}, {
   3.848385289962596*^9, 3.848385305479067*^9}, {3.848385341233374*^9, 
   3.8483854775912604`*^9}, {3.848385525692091*^9, 3.8483856076228085`*^9}, {
   3.848389081267135*^9, 3.848389085674369*^9}, {3.8484706178446007`*^9, 
   3.848470690780473*^9}, {3.848470744868769*^9, 3.8484708061795053`*^9}, {
   3.848470853597737*^9, 3.8484709213562293`*^9}, {3.848471261505375*^9, 
   3.848471282254611*^9}, {3.8484713286939645`*^9, 3.848471347636524*^9}, {
   3.8484713867021713`*^9, 3.848471432751426*^9}, 3.8484716365672197`*^9, {
   3.8486198148042545`*^9, 3.848619815127391*^9}, {3.848705058099018*^9, 
   3.8487050904927063`*^9}, {3.8487051288580713`*^9, 3.848705164358638*^9}, {
   3.8487052550831633`*^9, 3.848705283611058*^9}, {3.848705356955858*^9, 
   3.848705394369963*^9}, {3.8487147178339806`*^9, 3.8487147288839417`*^9}, {
   3.8487147974109545`*^9, 3.848715009951895*^9}, {3.848717194478407*^9, 
   3.848717229379981*^9}, {3.84871726438387*^9, 3.8487172788654823`*^9}, {
   3.848717340273527*^9, 3.848717404791221*^9}, {3.8487182256858444`*^9, 
   3.848718268360757*^9}, {3.8487184028285108`*^9, 3.8487184381480136`*^9}, {
   3.8487184862569323`*^9, 3.8487185080614843`*^9}, {3.8487185821291733`*^9, 
   3.8487187302952533`*^9}, {3.848718771610458*^9, 3.848719007816798*^9}, {
   3.8487197090035124`*^9, 3.848719973905158*^9}, 3.8487203587008524`*^9, {
   3.848729152552781*^9, 3.8487292038267994`*^9}, {3.8487293385842896`*^9, 
   3.8487293399668846`*^9}, {3.848729394895098*^9, 3.8487294461109295`*^9}, {
   3.8487309634764123`*^9, 3.8487309660298724`*^9}, 3.8487311120935125`*^9, 
   3.848731437211598*^9, {3.848731838253783*^9, 3.848731929493487*^9}, {
   3.848731961135312*^9, 3.848732164996931*^9}, {3.8487323369353743`*^9, 
   3.8487323417222424`*^9}, {3.8487324148091927`*^9, 3.848732418900227*^9}, {
   3.848732506947925*^9, 3.8487326035725317`*^9}, {3.8487330808065605`*^9, 
   3.8487330924022408`*^9}, {3.848743863438205*^9, 3.8487438983605237`*^9}, {
   3.848887779432912*^9, 3.8488877801145205`*^9}, {3.8489660226110573`*^9, 
   3.848966172055558*^9}, {3.848966222972285*^9, 3.848966465380205*^9}, {
   3.8489665162650123`*^9, 3.8489665934399843`*^9}, {3.8489668429323063`*^9, 
   3.8489668556868925`*^9}, {3.848966977693286*^9, 3.848966988256384*^9}, 
   3.848967099480118*^9, {3.8489723225749006`*^9, 3.8489723235952063`*^9}, {
   3.8489764703318105`*^9, 3.84897649628535*^9}, {3.8489765414965796`*^9, 
   3.8489765458639708`*^9}, {3.8489765913569984`*^9, 3.848976670972721*^9}, {
   3.84897671930052*^9, 3.8489767469190383`*^9}, {3.8489767882880735`*^9, 
   3.848976799002405*^9}, {3.848976885116541*^9, 3.8489769015035934`*^9}, {
   3.8489769745158677`*^9, 3.848976992085043*^9}, {3.848977030733135*^9, 
   3.8489770448753605`*^9}, {3.8489771519442587`*^9, 
   3.8489772690630856`*^9}, {3.848977341484968*^9, 3.8489774263415375`*^9}, 
   3.848977487243083*^9, {3.848977536795213*^9, 3.8489776569652195`*^9}, {
   3.8489777047729387`*^9, 3.8489777226287374`*^9}, {3.848977831517852*^9, 
   3.8489778332289667`*^9}, {3.848977927914733*^9, 3.848977937137712*^9}, {
   3.8489780070347476`*^9, 3.8489782051485715`*^9}, {3.8489784833274927`*^9, 
   3.8489784852449036`*^9}, {3.848984202288309*^9, 3.848984215265619*^9}, {
   3.848984248840041*^9, 3.848984332290362*^9}, {3.848985575870658*^9, 
   3.84898565292515*^9}, {3.8489859966549215`*^9, 3.848986134019388*^9}, {
   3.84898616486558*^9, 3.848986167989642*^9}, {3.8489862707628393`*^9, 
   3.8489862725886717`*^9}, 3.8489868515292015`*^9, {3.8489874250179973`*^9, 
   3.8489874283444624`*^9}, 3.848988000736933*^9, {3.848988152037321*^9, 
   3.848988152527144*^9}, 3.84898818393297*^9, {3.848988539048053*^9, 
   3.8489885605745697`*^9}, 3.8489886162303324`*^9, 3.848988651436458*^9, {
   3.8489888473132463`*^9, 3.848988847685636*^9}, 3.848989154661358*^9, 
   3.84898925940378*^9, {3.8489893721194286`*^9, 3.8489893731538286`*^9}, {
   3.8489937217729435`*^9, 3.8489937265271163`*^9}, {3.8491484787750444`*^9, 
   3.8491485588087177`*^9}, 3.849148591595047*^9, {3.849148681428873*^9, 
   3.849148681759853*^9}, {3.8491570389543033`*^9, 3.8491570430287986`*^9}, {
   3.8495819684728346`*^9, 3.849581985157521*^9}, {3.849582026393175*^9, 
   3.849582030372391*^9}, {3.849582151358512*^9, 3.8495821701224155`*^9}, {
   3.849582236717131*^9, 3.849582305178258*^9}, {3.8495824047912235`*^9, 
   3.849582486444994*^9}, {3.8495825993005304`*^9, 3.8495826085596952`*^9}, {
   3.849582693349523*^9, 3.8495827170334253`*^9}, {3.8495832375073156`*^9, 
   3.8495832966301146`*^9}, {3.849586543656044*^9, 3.849586583009162*^9}, {
   3.849587536740939*^9, 3.849587539513531*^9}, {3.8495895874129114`*^9, 
   3.8495897676541576`*^9}, {3.849589815606678*^9, 3.849589854283307*^9}, {
   3.8495899081473126`*^9, 3.8495899087913704`*^9}, {3.8496455911688385`*^9, 
   3.8496456415959587`*^9}, {3.8496456980531325`*^9, 
   3.8496457253627768`*^9}, {3.8502142445135818`*^9, 3.850214265999667*^9}, {
   3.850214376825267*^9, 3.8502144026938744`*^9}, 3.8507739483978415`*^9, 
   3.8507742436293573`*^9, {3.8507743102744246`*^9, 3.850774368413525*^9}, {
   3.8507782057324677`*^9, 3.850778211803881*^9}, {3.8509525038345423`*^9, 
   3.8509525081530066`*^9}, {3.850952549845419*^9, 3.8509525503686576`*^9}, {
   3.850952648752117*^9, 3.850952658660102*^9}, 3.8509528405291595`*^9, {
   3.85095317923983*^9, 3.850953208164755*^9}, 3.850953575749769*^9, {
   3.8509555614367805`*^9, 3.850955562662669*^9}, 3.850957670947115*^9, {
   3.850957913741457*^9, 3.8509579180995884`*^9}, {3.8509580379485087`*^9, 
   3.8509580513837976`*^9}, 3.850974173724807*^9, {3.850975079283733*^9, 
   3.850975109728592*^9}, {3.8509751423805914`*^9, 3.8509751579927993`*^9}, {
   3.8515048842530966`*^9, 3.8515048904724536`*^9}, {3.851504930650423*^9, 
   3.85150497149737*^9}, {3.851505806610485*^9, 3.851505838715768*^9}, 
   3.8515061637355804`*^9, 3.8515064589845467`*^9, {3.851507109194023*^9, 
   3.8515071099334664`*^9}, {3.8515073302870355`*^9, 3.851507346744049*^9}, {
   3.8542681742567153`*^9, 3.854268194027689*^9}, {3.854269097363611*^9, 
   3.8542690979914455`*^9}, {3.85822742868517*^9, 3.858227468078122*^9}, {
   3.8582357533872046`*^9, 3.858235835747944*^9}, {3.858238778286563*^9, 
   3.8582387799250946`*^9}, {3.858242970993848*^9, 3.85824300803393*^9}, {
   3.8582432625524983`*^9, 3.8582432839072933`*^9}, {3.8582433206346197`*^9, 
   3.858243349988859*^9}, 3.858243416556816*^9, {3.8582434923445253`*^9, 
   3.8582435787141953`*^9}, {3.85824363408025*^9, 3.858243721220693*^9}, {
   3.858243790280513*^9, 3.8582438088815765`*^9}, {3.8582439615708084`*^9, 
   3.8582439840521107`*^9}, 3.8582440556479063`*^9, {3.8582443995424185`*^9, 
   3.8582444061011057`*^9}, {3.858246615372435*^9, 3.8582466819586573`*^9}, {
   3.8582467187482862`*^9, 3.858246747558677*^9}, 3.858246862807901*^9, {
   3.858247240988516*^9, 3.858247241817293*^9}, {3.8582934818497252`*^9, 
   3.8582935086070476`*^9}, {3.8582935580953903`*^9, 3.858293574565981*^9}, 
   3.8582936073687277`*^9, {3.8582936830887785`*^9, 3.858293709770666*^9}, {
   3.8582938002805595`*^9, 3.85829380267179*^9}, {3.8582942963729577`*^9, 
   3.858294346703411*^9}, {3.858294404238062*^9, 3.858294406435923*^9}, {
   3.858306779334895*^9, 3.85830678285968*^9}, {3.8583068190004096`*^9, 
   3.8583068278129463`*^9}, {3.8583101018133955`*^9, 
   3.8583101324629784`*^9}, {3.8584101129449883`*^9, 3.858410130310114*^9}, {
   3.858415481789187*^9, 3.858415485549733*^9}, {3.8584157964031973`*^9, 
   3.8584158079481773`*^9}, {3.858416963841258*^9, 3.858416967455851*^9}, {
   3.8584210107023697`*^9, 3.8584210241227365`*^9}, {3.85960259303705*^9, 
   3.859602598267906*^9}, {3.860035616882843*^9, 3.8600356256741714`*^9}, {
   3.8600356763199887`*^9, 3.8600357326478653`*^9}, {3.8600358149141645`*^9, 
   3.8600358452180567`*^9}, {3.860035984753538*^9, 3.860035987185362*^9}, {
   3.8600360284209876`*^9, 3.860036028726522*^9}, {3.8600366720859127`*^9, 
   3.8600366758148303`*^9}, {3.8603080033129487`*^9, 
   3.8603080039600496`*^9}, {3.860467246782588*^9, 3.860467246930654*^9}, {
   3.8604674010351906`*^9, 3.8604674014288807`*^9}, {3.861170767190891*^9, 
   3.861170771190149*^9}, {3.8611708348217783`*^9, 3.8611708706355443`*^9}, {
   3.8611712026065674`*^9, 3.861171214682559*^9}, {3.861231344884395*^9, 
   3.861231377368759*^9}, {3.861231506519119*^9, 3.861231506766694*^9}, 
   3.8612319121789474`*^9, {3.8612319766117277`*^9, 3.8612319771750283`*^9}, {
   3.861232238090603*^9, 3.861232264157916*^9}, 3.8612323291114016`*^9, {
   3.861232676048854*^9, 3.8612326951455507`*^9}, {3.8612333666289234`*^9, 
   3.861233394540344*^9}, {3.861233457395316*^9, 3.861233495675759*^9}, {
   3.861233536273465*^9, 3.861233562534668*^9}, {3.86123367638162*^9, 
   3.8612337887095966`*^9}, {3.8612340183322215`*^9, 
   3.8612340360492487`*^9}, {3.861234071207255*^9, 3.8612340713827887`*^9}, {
   3.861234811906191*^9, 3.8612349138139477`*^9}, {3.8612355913175077`*^9, 
   3.8612356240354195`*^9}, {3.8612365621381674`*^9, 3.861236568122528*^9}, {
   3.8614059701406984`*^9, 3.861406021537346*^9}, {3.8614404849929075`*^9, 
   3.861440497027646*^9}, 3.861440528680468*^9, {3.8616897929009953`*^9, 
   3.8616898499985905`*^9}, {3.8616898979044895`*^9, 3.861689898347643*^9}, 
   3.8618343679436574`*^9, 3.861834545863921*^9, {3.861834667605131*^9, 
   3.8618346681442213`*^9}, {3.861834750662547*^9, 3.8618347805293903`*^9}, 
   3.8618353790023594`*^9, {3.8636741615948677`*^9, 3.8636741685321116`*^9}, {
   3.8636741986214533`*^9, 3.8636742151624193`*^9}, {3.8636744770160246`*^9, 
   3.863674485882823*^9}, {3.8644216756042533`*^9, 3.8644216829348707`*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"508f5722-e542-4934-a194-c98641109d0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"priceFIT", " ", "is", " ", "fixed"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"flagCapaIn", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "True"}], "}"}], ",", "True", ",", "True", ",", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False"}], "}"}], ",", "True"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"wind", ",", "pv"}], "}"}], ",", "hydrogen", ",", 
      RowBox[{"buffer", " ", "tank"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"battery", " ", "energy"}], ",", 
        RowBox[{"battery", " ", "power"}]}], "}"}], ",", "print"}], "}"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CapaGivenValIn", "=", 
     RowBox[{"{", 
      RowBox[{"800", ",", "200", ",", "100", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{"wind", ",", "pv", ",", "AE", ",", "HS", ",", 
      RowBox[{"{", 
       RowBox[{"ESOCMax", ",", " ", "PbatMax"}], "}"}]}], "}"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"horizonDispatchIn", "=", 
     RowBox[{"365", "*", "24", "*", "3600"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"periodDispatchIn", "=", 
     RowBox[{"1", "*", "4", "*", "900"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"priceNH3In", "=", "3200"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IRRLowerIn", "=", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IRRUpperIn", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"itrdaysIn", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flagGridIn", "=", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"sell", ",", "buy", ",", 
     RowBox[{
      RowBox[{"sell", "-", "buy"}], ";", " ", 
      RowBox[{"True", "-", "constrainted"}]}], ",", 
     RowBox[{"False", "-", 
      RowBox[{"Not", " ", "constrainted"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExchangeRateIn", "=", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", "0.1", ",", "0.2"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ratepAEMinIn", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LoadNH3MinIn", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boundarypriceInnerIn", "=", 
     RowBox[{
      RowBox[{"10", "^", "3"}], 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.3"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boundarypriceH2InnerIn", "=", 
     RowBox[{"{", 
      RowBox[{"1.", ",", 
       RowBox[{"priceNH3In", " ", "ConstG2L"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nDiscretIn", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rateDiscountIn", "=", "0.06"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flagPlaceIn", "=", "\"\<Xinjiang\>\""}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\"\<Normal\>\"", ",", "\"\<Gansu\>\"", ",", "\"\<Xinjiang\>\""}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Case Study: \>\"", ",", "flagPlaceIn"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"periodTOUIn", "=", "3600"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flagTOUHIn", "=", "False"}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"True", "-", 
       RowBox[{"priceFIT", " ", "is", " ", "time"}], "-", "of", "-", 
       RowBox[{"use", " ", "hourly"}]}], ";", 
      RowBox[{"Flase", "-", "fixed"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"priceFITGValIn", "=", 
     RowBox[{"0", "*", "0.25", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Xinjiang", "-", "0.25"}], ";", 
      RowBox[{"Gansu", "-", "0.3087"}], ";", 
      RowBox[{"Neimeng", "-", "0.2829"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "time", " ", "of", " ", "use", " ", "electricity", " ", "price"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"flagPlaceIn", "==", "\"\<Xinjiang\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Xinjiang", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pricePeak", "=", 
        RowBox[{"0.25", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceValley", "=", 
        RowBox[{"0", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceFlat", "=", 
        RowBox[{"0.5", "*", "0.25", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TOUHday", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"priceValley", ",", 
            RowBox[{"{", "8", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "5", "}"}]}], "]"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pricePeak", "=", 
        RowBox[{"0.3087", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceValley", "=", 
        RowBox[{"0", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceFlat", "=", 
        RowBox[{"0.5", "*", "0.3087", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TOUHday", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceValley", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceValley", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"TOUHYearIn", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"TOUHday", ",", 
         RowBox[{"{", "365", "}"}]}], "]"}], "//", "Flatten"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BarChart", "[", 
      RowBox[{"TOUHday", ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\:65f6\:95f4\>\"", ",", 
          "\"\<\:7535\:4ef7\:ff08\:5143/MWh\:ff09\>\""}], "}"}]}], ",", 
       RowBox[{"ChartLabels", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "24", "]"}]}], ")"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.3"}]}], "]"}], "//", "Print"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flagTOUHPurchIn", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pricePurchGVal", "=", 
     RowBox[{"0.35", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"flagPlaceIn", "==", "\"\<Xinjiang\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Xinjiang", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pricePeak", "=", 
        RowBox[{"0.5505", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceValley", "=", 
        RowBox[{"0.1215", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceFlat", "=", 
        RowBox[{"0.3360", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TOUHday", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"priceValley", ",", 
            RowBox[{"{", "8", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "5", "}"}]}], "]"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", "GanSu", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pricePeak", "=", 
        RowBox[{"0.8650", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceValley", "=", 
        RowBox[{"0.3036", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"priceFlat", "=", 
        RowBox[{"0.5843", "*", 
         RowBox[{"10", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TOUHday", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceValley", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceValley", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"priceFlat", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"pricePeak", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"TOUHYearPurchIn", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"TOUHday", ",", 
         RowBox[{"{", "365", "}"}]}], "]"}], "//", "Flatten"}]}], ";"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BarChart", "[", 
      RowBox[{"TOUHday", ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\:65f6\:95f4\>\"", ",", 
          "\"\<\:7535\:4ef7\:ff08\:5143/MWh\:ff09\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "->", 
        "\"\<\:5cf0\:8c37\:5e73\:5206\:65f6\:7535\:4ef7\>\""}], ",", 
       RowBox[{"ChartLabels", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "24", "]"}]}], ")"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.3"}]}], "]"}], "//", "Print"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flagOverShootLimitIn", "=", "False"}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"True", "-", 
       RowBox[{
       "limit", " ", "the", " ", "total", " ", "time", " ", "of", " ", 
        "overshoot"}]}], ";", " ", 
      RowBox[{"False", "-", 
       RowBox[{"not", " ", "limit"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"RateTimeOverShootIn", "=", "0.15"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffPunishIn", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flagMMAIn", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConstCapacityMonthIn", "=", 
     RowBox[{"33", "*", 
      RowBox[{
       RowBox[{"10", "^", "3"}], "/", 
       RowBox[{"10", "^", "4"}]}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\:5bb9\:91cf\:8d39\:6309\:7167\:6700\:5927\:9700\:91cf", "-", 
       RowBox[{"\:53ef\:4f18\:5316", ":", 
        RowBox[{
         RowBox[{"W\:ffe5", "/", "MW"}], "/", "year"}]}]}], ",", " ", 
      RowBox[{"or", " ", "33", 
       RowBox[{
        RowBox[{"\:ffe5", "/", "kW"}], "/", "month"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"flagConnectedIn", "=", "True"}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"True", "-", 
       RowBox[{"connected", " ", "to", " ", "grid"}]}], ";", " ", 
      RowBox[{"False", "-", "off", "-", "grid"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"flagBatExistIn", "=", "True"}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"True", "-", "battery"}], ";", " ", 
      RowBox[{"False", "-", 
       RowBox[{"No", " ", "battery"}]}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{"CapaPriceDistributionProgram", "[", 
      RowBox[{
      "flagCapaIn", ",", "CapaGivenValIn", ",", "horizonDispatchIn", ",", 
       "periodDispatchIn", ",", "IRRLowerIn", ",", "IRRUpperIn", ",", 
       "nDiscretIn", ",", "boundarypriceInnerIn", ",", 
       "boundarypriceH2InnerIn", ",", "itrdaysIn", ",", "flagGridIn", ",", 
       "ExchangeRateIn", ",", "periodTOUIn", ",", "flagTOUHIn", ",", 
       "TOUHYearIn", ",", "priceFITGValIn", ",", "flagTOUHPurchIn", ",", 
       "TOUHYearPurchIn", ",", "pricePurchGVal", ",", "priceNH3In", ",", 
       "ratepAEMinIn", ",", "LoadNH3MinIn", ",", "rateDiscountIn", ",", 
       "flagOverShootLimitIn", ",", "RateTimeOverShootIn", ",", 
       "coeffPunishIn", ",", "flagMMAIn", ",", "ConstCapacityMonthIn", ",", 
       "flagConnectedIn", ",", "flagBatExistIn", ",", "flagPlaceIn", ",", " ",
        "WTS", ",", "flagWTS", ",", "Gridratio", ",", "flagGridratio", ",", 
       "buffer", ",", "flagbuffer"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\:53d1\:7535\:4fa7\:ff1a\>\"", ",", "Red"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\:65b0\:80fd\:6e90\:5e74\:603b\:53d1\:7535\:91cf\:ff1a\>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{"ERenFinal", "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6\:ff0c \:5176\:4e2d\:98ce\:7535\:ff1a \>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"varsCapaVal", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "pwNormMeanValAll"}], "]"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6\:ff0c\:5149\:4f0f\:53d1\:7535\:ff1a\>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"varsCapaVal", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "pvNormMeanValAll"}], "]"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6\:3002\:5e74\:603b\:5f03\:7535\:91cf\:ff1a \>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", "pwCurtDispValAll", "]"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6\:ff0c\:5f03\:7535\:7387\:ff1a \>\"", ",", 
      RowBox[{
       RowBox[{"Total", "[", "pwCurtDispValAll", "]"}], "/", "ERenFinal"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\:98ce\:7535\:672c\:5730\:6d88\:7eb3\:ff1a\>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"varsCapaVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "pwNormMeanValAll"}], "-", 
          "pwCurtDispValAll"}], "]"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6(\:7531\:98ce\:7535\:627f\:62c5\:5f03\:7535\:4efb\
\:52a1)\:ff1b\:5149\:4f0f\:672c\:5730\:6d88\:7eb3\:ff1a\>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"varsCapaVal", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "pvNormMeanValAll"}], "]"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", "\"\< \:4ebf\:5ea6\:3002\>\""}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\:8d1f\:8377\:4fa7\:ff1a\>\"", ",", "Red"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\:8d1f\:8377\:4fa7\:5e74\:603b\:7528\:7535\:91cf\:ff1a\>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"pAEDispValAll", "+", "pSADispValAll"}], "]"}], "/", 
        RowBox[{"10", "^", "5"}]}], 
       "\"\< \:4ebf\:5ea6\:ff0c\:5176\:4e2d\:65b0\:80fd\:6e90\:4f9b\:7535\
\:ff1a \>\""}], ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ERenFinal", "-", 
          RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}], ")"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6\:ff0c\:5360\:6bd4\:ff1a \>\"", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ERenFinal", "-", 
         RowBox[{"Total", "[", "pwCurtDispValAll", "]"}]}], ")"}], "/", 
       RowBox[{"Total", "[", 
        RowBox[{"pAEDispValAll", "+", "pSADispValAll"}], "]"}]}], ",", 
      "\"\<; \:4e0b\:7f51\:7535\:91cf\:ff1a\>\"", ",", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], 
       RowBox[{
        RowBox[{"Total", "[", "pPurchDispValAll", "]"}], "/", 
        RowBox[{"10", "^", "5"}]}]}], ",", 
      "\"\< \:4ebf\:5ea6\:ff0c\:5360\:6bd4\:ff1a \>\"", ",", 
      RowBox[{
       RowBox[{"Total", "[", "pPurchDispValAll", "]"}], "/", 
       RowBox[{"Total", "[", 
        RowBox[{"pAEDispValAll", "+", "pSADispValAll"}], "]"}]}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"periodDispatchIn", "==", "3600"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Analysis", " ", "of", " ", "Peak"}], "-", "Valley", "-", 
        "Flat"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"flagPlaceIn", "==", "\"\<Normal\>\""}], "||", 
          RowBox[{"flagPlaceIn", "==", "\"\<Gansu\>\""}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "Gansu", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPeak", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"8", ",", "9"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"19", ",", "24"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListValley", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"12", ",", "17"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"ListPeak", ",", "ListValley"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp1", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListFlat", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "24"}], "]"}], ",", "temp1"}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "Xinjiang", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPeak", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"11", ",", "13"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"20", ",", "24"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListValley", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "8"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"ListPeak", ",", "ListValley"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp1", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListFlat", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "24"}], "]"}], ",", "temp1"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispPeak", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pwCurtDisp", "[", 
            RowBox[{"[", 
             RowBox[{"ListPeak", "+", 
              RowBox[{"24", "#"}]}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"365", "-", "1"}]}], "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispValley", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pwCurtDisp", "[", 
            RowBox[{"[", 
             RowBox[{"ListValley", "+", 
              RowBox[{"24", "#"}]}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"365", "-", "1"}]}], "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispFlat", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pwCurtDisp", "[", 
            RowBox[{"[", 
             RowBox[{"ListFlat", "+", 
              RowBox[{"24", "#"}]}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"365", "-", "1"}]}], "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispPeakValAll", "=", 
        RowBox[{"pwCurtDispPeak", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispValleyValAll", "=", 
        RowBox[{"pwCurtDispValley", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pwCurtDispFlatValAll", "=", 
        RowBox[{"pwCurtDispFlat", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispPeak", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pPurchDisp", "[", 
            RowBox[{"[", 
             RowBox[{"ListPeak", "+", 
              RowBox[{"24", "#"}]}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"365", "-", "1"}]}], "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispValley", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pPurchDisp", "[", 
            RowBox[{"[", 
             RowBox[{"ListValley", "+", 
              RowBox[{"24", "#"}]}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"365", "-", "1"}]}], "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispFlat", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pPurchDisp", "[", 
            RowBox[{"[", 
             RowBox[{"ListFlat", "+", 
              RowBox[{"24", "#"}]}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"365", "-", "1"}]}], "]"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispPeakValAll", "=", 
        RowBox[{"pPurchDispPeak", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispValleyValAll", "=", 
        RowBox[{"pPurchDispValley", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pPurchDispFlatValAll", "=", 
        RowBox[{"pPurchDispFlat", "/.", "cRuleStage1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\:5cf0\:8c37\:5e73\:65f6\:6bb5\:4e0a\:7f51\:7535\:91cf\:ff1a\>\"\
", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"periodDispatchIn", "/", "3600"}], "/", 
           RowBox[{"10", "^", "5"}]}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispPeakValAll", "//", "Total"}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"pwCurtDispValleyValAll", "//", "Total"}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"pwCurtDispFlatValAll", "//", "Total"}], ")"}]}], 
           "}"}]}], ",", 
         "\"\< \:4ebf\:5ea6\:ff0c\:5360\:5168\:5e74\:53d1\:7535\:91cf\:7684\
\:6bd4\:4f8b\:ff1a\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispPeakValAll", "//", "Total"}], ")"}], "/", 
            "ERenFinal"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispValleyValAll", "//", "Total"}], ")"}], "/", 
            "ERenFinal"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispFlatValAll", "//", "Total"}], ")"}], "/", 
            "ERenFinal"}]}], "}"}], ",", 
         "\"\< \:5360\:4e0a\:7f51\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a\>\"", 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispPeakValAll", "//", "Total"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"pwCurtDispValAll", "//", "Total"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispValleyValAll", "//", "Total"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"pwCurtDispValAll", "//", "Total"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pwCurtDispFlatValAll", "//", "Total"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"pwCurtDispValAll", "//", "Total"}], ")"}]}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\:5cf0\:8c37\:5e73\:65f6\:6bb5\:4e0b\:7f51\:7535\:91cf\:ff1a\>\"\
", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"periodDispatchIn", "/", "3600"}], "/", 
           RowBox[{"10", "^", "5"}]}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispPeakValAll", "//", "Total"}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"pPurchDispValleyValAll", "//", "Total"}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"pPurchDispFlatValAll", "//", "Total"}], ")"}]}], 
           "}"}]}], ",", 
         "\"\< \:4ebf\:5ea6\:ff0c\:5360\:5168\:5e74\:53d1\:7535\:91cf\:7684\
\:6bd4\:4f8b\:ff1a\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispPeakValAll", "//", "Total"}], ")"}], "/", 
            "ERenFinal"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispValleyValAll", "//", "Total"}], ")"}], "/", 
            "ERenFinal"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispFlatValAll", "//", "Total"}], ")"}], "/", 
            "ERenFinal"}]}], "}"}], ",", 
         "\"\< \:5360\:4e0b\:7f51\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a\>\"", 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispPeakValAll", "//", "Total"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"pPurchDispValAll", "//", "Total"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispValleyValAll", "//", "Total"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"pPurchDispValAll", "//", "Total"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pPurchDispFlatValAll", "//", "Total"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"pPurchDispValAll", "//", "Total"}], ")"}]}]}], "}"}]}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.8484718549733486`*^9, {3.848471968384198*^9, 3.8484719686534777`*^9}, {
   3.8484720683224363`*^9, 3.8484720696159735`*^9}, {3.848472355557639*^9, 
   3.848472366854848*^9}, 3.848472750303319*^9, {3.8495867401128273`*^9, 
   3.8495867799941435`*^9}, {3.849586853726356*^9, 3.849586953121654*^9}, {
   3.8495869954876924`*^9, 3.8495870296947765`*^9}, {3.8495893440026855`*^9, 
   3.849589360236662*^9}, {3.849589417525016*^9, 3.8495894361191597`*^9}, 
   3.8495894892515154`*^9, {3.8495899263325768`*^9, 3.849590041289075*^9}, {
   3.849590215702413*^9, 3.8495902310255623`*^9}, {3.849590289540254*^9, 
   3.849590329936427*^9}, {3.849591420909858*^9, 3.8495914844280357`*^9}, {
   3.8495915462895055`*^9, 3.8495915649400873`*^9}, {3.8495916217990975`*^9, 
   3.849591815277745*^9}, {3.849591867444623*^9, 3.8495919098697968`*^9}, {
   3.8495930559129753`*^9, 3.849593084511125*^9}, {3.849593615094945*^9, 
   3.8495936649518256`*^9}, 3.849593714178344*^9, 3.858247891619478*^9, {
   3.8600207030990744`*^9, 3.860020724523997*^9}, {3.8637492231408553`*^9, 
   3.8637492261256523`*^9}, {3.863749770599204*^9, 3.863749773802625*^9}, 
   3.863750477291792*^9},
 FontFamily->
  "Consolas",ExpressionUUID->"689b0edd-c431-4c06-8d43-137034ac9227"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Case Study: \"\>", "\[InvisibleSpace]", "\<\"Xinjiang\"\>"}],
  SequenceForm["Case Study: ", "Xinjiang"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495937153742323`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"f30dd8bd-f20b-466d-88af-\
8d0edda9b2da"],

Cell[BoxData[
 GraphicsBox[{
   {Opacity[0], 
    PointBox[{{0.13506261180679785`, 0.}, {24.389362873262694`, 0.}}]}, {{}, 
    {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
     0.5319999999999999], Thickness[Small]}], 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{0.6106371267373056, 0.}, {1.3893628732626944`, 0.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{53.757514590992635`, 65.25588912026399}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{1.6106371267373056`, 0.}, {2.3893628732626944`, 0.},
              "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{67.81686035954094, 79.31523488881228}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{2.6106371267373056`, 0.}, {3.3893628732626944`, 0.},
              "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{81.87620612808925, 93.3745806573606}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{3.6106371267373056`, 0.}, {4.389362873262694, 0.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{95.93555189663755, 107.4339264259089}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{4.610637126737306, 0.}, {5.389362873262694, 0.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{109.99489766518586`, 121.49327219445719`}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{5.610637126737306, 0.}, {6.389362873262694, 0.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{124.05424343373416`, 135.55261796300553`}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{6.610637126737306, 0.}, {7.389362873262694, 0.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{138.11358920228247`, 149.6119637315538}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{7.610637126737306, 0.}, {8.389362873262694, 0.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{152.17293497083077`, 163.67130950010213`}, {
            35.546874999999986`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{8.610637126737306, 0.}, {9.389362873262694, 125.}, 
             "RoundingRadius" -> 0]},
           ImageSizeCache->{{166.2322807393791, 
            177.73065526865042`}, {-15.070252197265638`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{9.610637126737306, 0.}, {10.389362873262694`, 125.},
              "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{180.2916265079274, 
            191.79000103719872`}, {-15.070252197265638`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{10.610637126737306`, 0.}, {11.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{194.3509722764757, 
            205.84934680574705`}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{11.610637126737306`, 0.}, {12.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{208.41031804502398`, 
            219.90869257429534`}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{12.610637126737306`, 0.}, {13.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{222.46966381357228`, 
            233.96803834284364`}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{13.610637126737306`, 0.}, {14.389362873262694`, 
             125.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{236.5290095821206, 
            248.02738411139194`}, {-15.070252197265638`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{14.610637126737306`, 0.}, {15.389362873262694`, 
             125.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{250.5883553506689, 
            262.0867298799402}, {-15.070252197265638`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{15.610637126737306`, 0.}, {16.389362873262694`, 
             125.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{264.64770111921723`, 
            276.14607564848865`}, {-15.070252197265631`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{16.610637126737306`, 0.}, {17.389362873262694`, 
             125.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{278.7070468877655, 
            290.205421417037}, {-15.070252197265631`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{17.610637126737306`, 0.}, {18.389362873262694`, 
             125.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{292.7663926563139, 
            304.26476718558524`}, {-15.070252197265631`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{18.610637126737306`, 0.}, {19.389362873262694`, 
             125.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{306.82573842486215`, 
            318.3241129541335}, {-15.070252197265631`, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 125.]& ,
         TagBoxNote->"125."],
        StyleBox["125.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[125., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{19.610637126737306`, 0.}, {20.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{320.8850841934104, 
            332.3834587226819}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{20.610637126737306`, 0.}, {21.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{334.9444299619588, 
            346.44280449123016`}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{21.610637126737306`, 0.}, {22.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{349.0037757305071, 
            360.50215025977843`}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{22.610637126737306`, 0.}, {23.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{363.06312149905534`, 
            374.5614960283268}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{23.610637126737306`, 0.}, {24.389362873262694`, 
             250.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{377.1224672676037, 
            388.6208417968751}, {-65.68737939453126, 36.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 250.]& ,
         TagBoxNote->"250."],
        StyleBox["250.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[250., {}], "Tooltip"]& ]}}, {}, {}}, {}, {}, {}, {}, {}},
  AspectRatio->0.3,
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0.13506261180679785`, 0.},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{
     FormBox["\"\:7535\:4ef7\:ff08\:5143/MWh\:ff09\"", TraditionalForm], 
     None}, {
     FormBox["\"\:65f6\:95f4\"", TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {{{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {1., 
       FormBox["1", TraditionalForm], 0}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox["2", TraditionalForm], 0}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox["3", TraditionalForm], 0}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox["4", TraditionalForm], 0}, {5., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {5., 
       FormBox["5", TraditionalForm], 0}, {6., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {6., 
       FormBox["6", TraditionalForm], 0}, {7., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {7., 
       FormBox["7", TraditionalForm], 0}, {8., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {8., 
       FormBox["8", TraditionalForm], 0}, {9., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {9., 
       FormBox["9", TraditionalForm], 0}, {10., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {10., 
       FormBox["10", TraditionalForm], 0}, {11., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {11., 
       FormBox["11", TraditionalForm], 0}, {12., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {12., 
       FormBox["12", TraditionalForm], 0}, {13., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {13., 
       FormBox["13", TraditionalForm], 0}, {14., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {14., 
       FormBox["14", TraditionalForm], 0}, {15., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {15., 
       FormBox["15", TraditionalForm], 0}, {16., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {16., 
       FormBox["16", TraditionalForm], 0}, {17., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {17., 
       FormBox["17", TraditionalForm], 0}, {18., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {18., 
       FormBox["18", TraditionalForm], 0}, {19., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {19., 
       FormBox["19", TraditionalForm], 0}, {20., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {20., 
       FormBox["20", TraditionalForm], 0}, {21., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {21., 
       FormBox["21", TraditionalForm], 0}, {22., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {22., 
       FormBox["22", TraditionalForm], 0}, {23., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {23., 
       FormBox["23", TraditionalForm], 0}, {24., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {24., 
       FormBox["24", TraditionalForm], 0}}, {{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {5., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {6., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {7., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {8., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {9., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {10., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {11., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {12., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {13., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {14., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {15., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {16., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {17., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {18., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {19., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {20., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {21., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {22., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {23., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {24., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{All, All}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {None, 
     Scaled[0.05]}},
  Ticks->{None, Automatic}]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495937154720836`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"a567bfa4-392d-42c8-bbb1-\
e591982a9f66"],

Cell[BoxData[
 GraphicsBox[{
   {Opacity[0], 
    PointBox[{{0.13506261180679785`, 0.}, {24.389362873262694`, 0.}}]}, {{}, 
    {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
     0.5319999999999999], Thickness[Small]}], 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{0.6106371267373056, 0.}, {1.3893628732626944`, 
             121.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{53.757514590992635`, 65.25588912026399}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{1.6106371267373056`, 0.}, {2.3893628732626944`, 
             121.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{67.81686035954094, 79.31523488881227}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{2.6106371267373056`, 0.}, {3.3893628732626944`, 
             121.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{81.87620612808925, 93.37458065736058}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{3.6106371267373056`, 0.}, {4.389362873262694, 
             121.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{95.93555189663755, 107.4339264259089}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{4.610637126737306, 0.}, {5.389362873262694, 121.5}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{109.99489766518585`, 121.49327219445719`}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{5.610637126737306, 0.}, {6.389362873262694, 121.5}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{124.05424343373414`, 135.5526179630055}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{6.610637126737306, 0.}, {7.389362873262694, 121.5}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{138.11358920228244`, 149.6119637315538}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{7.610637126737306, 0.}, {8.389362873262694, 121.5}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{152.17293497083077`, 163.67130950010213`}, {
            20.203619942896367`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 121.5]& ,
         TagBoxNote->"121.5"],
        StyleBox["121.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[121.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{8.610637126737306, 0.}, {9.389362873262694, 336.}, 
             "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{166.23228073937906`, 
            177.73065526865042`}, {-19.241879725817434`, 
            43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{9.610637126737306, 0.}, {10.389362873262694`, 336.},
              "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{180.29162650792736`, 
            191.79000103719872`}, {-19.241879725817434`, 
            43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{10.610637126737306`, 0.}, {11.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{194.35097227647566`, 
            205.84934680574702`}, {-58.68737939453124, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{11.610637126737306`, 0.}, {12.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{208.41031804502396`, 
            219.90869257429532`}, {-58.68737939453124, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{12.610637126737306`, 0.}, {13.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{222.46966381357228`, 
            233.9680383428436}, {-58.68737939453124, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{13.610637126737306`, 0.}, {14.389362873262694`, 
             336.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{236.52900958212058`, 
            248.02738411139194`}, {-19.241879725817434`, 
            43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{14.610637126737306`, 0.}, {15.389362873262694`, 
             336.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{250.58835535066888`, 
            262.0867298799402}, {-19.241879725817434`, 43.096875000000004`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{15.610637126737306`, 0.}, {16.389362873262694`, 
             336.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{264.64770111921723`, 
            276.1460756484886}, {-19.241879725817427`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{16.610637126737306`, 0.}, {17.389362873262694`, 
             336.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{278.7070468877655, 
            290.2054214170369}, {-19.241879725817427`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{17.610637126737306`, 0.}, {18.389362873262694`, 
             336.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{292.76639265631377`, 
            304.26476718558524`}, {-19.241879725817427`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{18.610637126737306`, 0.}, {19.389362873262694`, 
             336.}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{306.82573842486215`, 
            318.3241129541335}, {-19.241879725817427`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 336.]& ,
         TagBoxNote->"336."],
        StyleBox["336.`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[336., {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{19.610637126737306`, 0.}, {20.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{320.8850841934104, 
            332.3834587226818}, {-58.687379394531234`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{20.610637126737306`, 0.}, {21.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{334.9444299619587, 
            346.44280449123016`}, {-58.687379394531234`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{21.610637126737306`, 0.}, {22.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{349.0037757305071, 
            360.50215025977843`}, {-58.687379394531234`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{22.610637126737306`, 0.}, {23.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{363.06312149905534`, 
            374.5614960283267}, {-58.687379394531234`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.5319999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{23.610637126737306`, 0.}, {24.389362873262694`, 
             550.5}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{377.1224672676036, 
            388.6208417968751}, {-58.687379394531234`, 43.096875}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 550.5]& ,
         TagBoxNote->"550.5"],
        StyleBox["550.5`", {}, StripOnInput -> False]],
       Annotation[#, 
        Style[550.5, {}], "Tooltip"]& ]}}, {}, {}}, {}, {}, {}, {}, {}},
  AspectRatio->0.3,
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0.13506261180679785`, 0.},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{
     FormBox["\"\:7535\:4ef7\:ff08\:5143/MWh\:ff09\"", TraditionalForm], 
     None}, {
     FormBox["\"\:65f6\:95f4\"", TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {{{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {1., 
       FormBox["1", TraditionalForm], 0}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox["2", TraditionalForm], 0}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox["3", TraditionalForm], 0}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox["4", TraditionalForm], 0}, {5., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {5., 
       FormBox["5", TraditionalForm], 0}, {6., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {6., 
       FormBox["6", TraditionalForm], 0}, {7., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {7., 
       FormBox["7", TraditionalForm], 0}, {8., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {8., 
       FormBox["8", TraditionalForm], 0}, {9., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {9., 
       FormBox["9", TraditionalForm], 0}, {10., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {10., 
       FormBox["10", TraditionalForm], 0}, {11., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {11., 
       FormBox["11", TraditionalForm], 0}, {12., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {12., 
       FormBox["12", TraditionalForm], 0}, {13., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {13., 
       FormBox["13", TraditionalForm], 0}, {14., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {14., 
       FormBox["14", TraditionalForm], 0}, {15., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {15., 
       FormBox["15", TraditionalForm], 0}, {16., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {16., 
       FormBox["16", TraditionalForm], 0}, {17., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {17., 
       FormBox["17", TraditionalForm], 0}, {18., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {18., 
       FormBox["18", TraditionalForm], 0}, {19., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {19., 
       FormBox["19", TraditionalForm], 0}, {20., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {20., 
       FormBox["20", TraditionalForm], 0}, {21., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {21., 
       FormBox["21", TraditionalForm], 0}, {22., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {22., 
       FormBox["22", TraditionalForm], 0}, {23., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {23., 
       FormBox["23", TraditionalForm], 0}, {24., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {24., 
       FormBox["24", TraditionalForm], 0}}, {{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {5., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {6., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {7., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {8., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {9., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {10., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {11., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {12., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {13., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {14., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {15., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {16., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {17., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {18., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {19., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {20., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {21., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {22., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {23., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {24., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotLabel->FormBox[
   "\"\:5cf0\:8c37\:5e73\:5206\:65f6\:7535\:4ef7\"", TraditionalForm],
  PlotRange->{{All, All}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {None, 
     Scaled[0.05]}},
  Ticks->{None, Automatic}]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849593715648611*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"fd67f569-d32f-40f5-928b-\
b65dd49b61cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Max generation of Wind power is: \"\>", "\[InvisibleSpace]", 
   "0.974601426272374`", "\[InvisibleSpace]", "\<\" p.u.\"\>"}],
  SequenceForm[
  "Max generation of Wind power is: ", 0.974601426272374, " p.u."],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849593715763316*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7c567b60-2df5-42d2-bc6a-\
1bda2f4f5629"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Annual ultilization hours of Wind power is: \"\>", 
   "\[InvisibleSpace]", "1700.0526369895936`", 
   "\[InvisibleSpace]", "\<\" h\"\>"}],
  SequenceForm[
  "Annual ultilization hours of Wind power is: ", 1700.0526369895936`, " h"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495937157653*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"d4c86458-f520-43b0-84a7-\
42befbff2b64"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Max generation of PV is: \"\>", "\[InvisibleSpace]", "1.`", 
   "\[InvisibleSpace]", "\<\" p.u.\"\>"}],
  SequenceForm["Max generation of PV is: ", 1., " p.u."],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849593715860046*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"816b6c12-1b0d-465f-9234-\
189a9c705e78"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Annual ultilization hours of PV is: \"\>", "\[InvisibleSpace]",
    "3300.0420710932276`", "\[InvisibleSpace]", "\<\" h\"\>"}],
  SequenceForm[
  "Annual ultilization hours of PV is: ", 3300.0420710932276`, " h"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495937158620405`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"b22777c0-a114-41dd-b212-\
3a0ed05fe6db"],

Cell[BoxData["\<\"Solving\"\>"], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495937236542478`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"690cfa6b-9e1c-4a4b-9183-\
dc2fe4545a57"],

Cell[BoxData["\<\"Start!\"\>"], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849593724330414*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"e8a93fa8-e45d-4577-9b76-\
0f04ac920b66"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849593724333406*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"e104c177-aef7-4426-b904-\
95b87e37d58e"],

Cell[BoxData["\<\"Stage 1:\"\>"], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495937243353996`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"2c26ce37-4595-461c-b511-\
b3f7ee402cc7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"All time used in optimization by gurobi: \"\>", 
   "\[InvisibleSpace]", "628.8001561`10.250057634341188", "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm[
  "All time used in optimization by gurobi: ", 628.8001561`10.250057634341188, 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943531325607`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"8593e0fc-a096-46ea-a228-\
25835dcb07c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total power generation in a year is:\"\>", "\[InvisibleSpace]",
    "3.148288529991146`*^6", "\[InvisibleSpace]", "\<\" MWh\"\>"}],
  SequenceForm[
  "Total power generation in a year is:", 3.148288529991146*^6, " MWh"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594353250223*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"c4053a55-0cbb-4d05-8bbd-\
c5877a7d537b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"year ahead dispatch finished! \"\>", 
   "\[InvisibleSpace]", "\<\"The maximum production of NH3 in a year is: \
\"\>", "\[InvisibleSpace]", "3.952941176470972`*^8", 
   "\[InvisibleSpace]", "\<\" Nm3 = \"\>", "\[InvisibleSpace]", 
   "300000.0000000291`", "\[InvisibleSpace]", "\<\" t\"\>"}],
  SequenceForm[
  "year ahead dispatch finished! ", 
   "The maximum production of NH3 in a year is: ", 3.952941176470972*^8, 
   " Nm3 = ", 300000.0000000291, " t"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943532522173`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"35cdeb11-a5d6-4c37-a105-\
68087f4b3408"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total H2 production in a year is: \"\>", "\[InvisibleSpace]", 
   "5.929411764706458`*^8", "\[InvisibleSpace]", "\<\" Nm3, i.e. \"\>", 
   "\[InvisibleSpace]", "52941.176470593375`", 
   "\[InvisibleSpace]", "\<\" t\"\>"}],
  SequenceForm[
  "Total H2 production in a year is: ", 5.929411764706458*^8, " Nm3, i.e. ", 
   52941.176470593375`, " t"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594353254212*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"738aa1c3-3221-4e6a-ab6f-\
49753517af80"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Optimal Capacity of Wind power is: \"\>", "\[InvisibleSpace]", 
   "818.5454764986988`", "\[InvisibleSpace]", "\<\" MW\"\>"}],
  SequenceForm[
  "Optimal Capacity of Wind power is: ", 818.5454764986988, " MW"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943532562075`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"9d0e8282-e3eb-4d44-9e6d-\
3b2f2fffa621"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Optimal Capacity of Solar power is: \"\>", "\[InvisibleSpace]",
    "262.9648110390383`", "\[InvisibleSpace]", "\<\" MW\"\>"}],
  SequenceForm[
  "Optimal Capacity of Solar power is: ", 262.9648110390383, " MW"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943532582006`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"85b3dae2-ae10-4fc8-8d1b-\
fce3a7a723f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Optimal Capacity of Alkaline Electrolyzers is: \"\>", 
   "\[InvisibleSpace]", "540.`", "\[InvisibleSpace]", "\<\" MW\"\>"}],
  SequenceForm["Optimal Capacity of Alkaline Electrolyzers is: ", 540., " MW"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943532601967`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"4bfed99e-d885-4f1b-b404-\
5a6af821998a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Optimal Capacity of Buffer Tank is: \"\>", "\[InvisibleSpace]",
    "1.0531010626022143`*^6", 
   "\[InvisibleSpace]", "\<\" Nm3, i.e. buffer time is: \"\>", 
   "\[InvisibleSpace]", "9.750935764835317`", 
   "\[InvisibleSpace]", "\<\" h\"\>"}],
  SequenceForm[
  "Optimal Capacity of Buffer Tank is: ", 1.0531010626022143`*^6, 
   " Nm3, i.e. buffer time is: ", 9.750935764835317, " h"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594353262191*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"3b80d349-1329-43b6-b160-\
20f73ba7bd68"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Given Capacity of Battery is: \"\>", "\[InvisibleSpace]", 
   "0.`", "\[InvisibleSpace]", "\<\" MWh\"\>"}],
  SequenceForm["Given Capacity of Battery is: ", 0., " MWh"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594353264186*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"876f68e7-ed4f-4a46-917c-\
86096214b95c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total curtailment of wind power in a year is: \"\>", 
   "\[InvisibleSpace]", "131380.3918338841`", 
   "\[InvisibleSpace]", "\<\" MWh. Rate: \"\>", "\[InvisibleSpace]", 
   "0.04173073420124348`"}],
  SequenceForm[
  "Total curtailment of wind power in a year is: ", 131380.3918338841, 
   " MWh. Rate: ", 0.04173073420124348],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943532651825`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"cbb5c44e-bb28-4889-9809-\
aab0d5f6df22"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total Power purchase from grid in a year is: \"\>", 
   "\[InvisibleSpace]", "139329.60301951045`", 
   "\[InvisibleSpace]", "\<\" MWh. Rate: \"\>", "\[InvisibleSpace]", 
   "0.044255665162907507`"}],
  SequenceForm[
  "Total Power purchase from grid in a year is: ", 139329.60301951045`, 
   " MWh. Rate: ", 0.044255665162907507`],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943532671776`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"3aabade5-01e0-4c11-9074-\
42168dcaef3e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Net Profit of the whole system\:ff1a \"\>", 
   "\[InvisibleSpace]", "0.04552644076313227`", 
   "\[InvisibleSpace]", "\<\" *10^8 \:ffe5\"\>"}],
  SequenceForm[
  "Net Profit of the whole system\:ff1a ", 0.04552644076313227, 
   " *10^8 \:ffe5"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943533050766`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"48028b9e-2570-4c66-a316-\
015a640d9ec3"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943536381855`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"2c29962b-83d9-4108-82ee-\
b85f72eb2bf4"],

Cell[BoxData["\<\"Stage 2:\"\>"], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.84959435364018*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7d332542-503c-43a5-9df3-\
7f127e1f1528"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"All time used in optimization by gurobi: \"\>", 
   "\[InvisibleSpace]", "23.9933558`8.831635987753861", "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm[
  "All time used in optimization by gurobi: ", 23.9933558`8.831635987753861, 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377632539*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"0088be3b-af78-40f0-b9cd-\
e120e845f51d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Optimal Inner electricity price is: \"\>", "\[InvisibleSpace]",
    "0.207600000000001`", "\[InvisibleSpace]", "\<\" \:ffe5/kWh\"\>"}],
  SequenceForm[
  "Optimal Inner electricity price is: ", 0.207600000000001, " \:ffe5/kWh"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943776365232`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"ff39aaef-004d-4a45-a2df-\
02034fe52b4f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Optimal Inner hydrogen price is: \"\>", "\[InvisibleSpace]", 
   "1.3736070355674699`", "\[InvisibleSpace]", "\<\" \:ffe5/Nm3\"\>"}],
  SequenceForm[
  "Optimal Inner hydrogen price is: ", 1.3736070355674699`, " \:ffe5/Nm3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377637521*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"e1cd9088-ccb4-4589-9979-\
11381dc3d929"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"earning ratio of each agents: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005667404815286103`", ",", "0.007376834973533031`", ",", 
     "0.007376834973533031`"}], "}"}]}],
  SequenceForm[
  "earning ratio of each agents: ", {0.005667404815286103, 
   0.007376834973533031, 0.007376834973533031}],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377641486*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"a4ab301a-8dba-4936-a190-\
8cb8b7458fc9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOCE of Renewable Energy Generation is: \"\>", 
   "\[InvisibleSpace]", "0.17898147000441506`", 
   "\[InvisibleSpace]", "\<\" \:ffe5/kWh\"\>"}],
  SequenceForm[
  "LOCE of Renewable Energy Generation is: ", 0.17898147000441506`, 
   " \:ffe5/kWh"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943776893578`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"51105a96-3032-48ba-9a0e-\
a0fb50411d14"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOCH of AEHS is: \"\>", "\[InvisibleSpace]", 
   "1.3029675996864445`", "\[InvisibleSpace]", "\<\" \:ffe5/Nm3\"\>"}],
  SequenceForm["LOCH of AEHS is: ", 1.3029675996864445`, " \:ffe5/Nm3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943776923513`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"1aafa015-ecdb-4ef7-8483-\
a9a4fe3702f3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOCA of SA is: \"\>", "\[InvisibleSpace]", 
   "3004.0182952019773`", "\[InvisibleSpace]", "\<\" \:ffe5/t\"\>"}],
  SequenceForm["LOCA of SA is: ", 3004.0182952019773`, " \:ffe5/t"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943776943455`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"b650edae-62fc-4ece-8efb-\
a5a76958fe92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:53ef\:518d\:751f\:80fd\:6e90\:5236\:6c22\:5408\:6210\:6c28\
\:7cfb\:7edf\:ff1a\"\>", "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm[
  "\:53ef\:518d\:751f\:80fd\:6e90\:5236\:6c22\:5408\:6210\:6c28\:7cfb\:7edf\
\:ff1a", 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377697361*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7c295cbd-136c-452a-bcf0-\
52c57b1f8ebb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:603b\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\
\:5e74\:ff09\:ff1a\"\>", "\[InvisibleSpace]", "7.477302769017356`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:603b\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\:ff09\
\:ff1a", 7.477302769017356, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943777003574`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"9a03c9d1-2286-4f43-b7bf-\
1f88b4ec1866"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:8fd0\:884c\:6536\:76ca\:ff1a\"\>", "\[InvisibleSpace]", 
   "7.522829209780485`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:8fd0\:884c\:6536\:76ca\:ff1a", 7.522829209780485, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943777262836`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"8035a1ae-caf7-492c-8c47-\
c140db5ddd8c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:51c0\:6536\:76ca\:ff1a \"\>", "\[InvisibleSpace]", 
   "0.04552644076313227`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.006088618071181195`"}],
  SequenceForm[
  "\:51c0\:6536\:76ca\:ff1a ", 0.04552644076313227, 
   " \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a", 0.006088618071181195],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.84959437782001*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7001bbe0-271b-4112-ae32-\
a8636f928b1e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5bb9\:91cf\:8d39\:ff08\:6309\:6700\:5927\:9700\:91cf\:ff09\"\
\>", "\[InvisibleSpace]", "33", 
   "\[InvisibleSpace]", "\<\" \:5143/kW/\:6708\:ff1b\:6bcf\:6708\:6700\:5927\
\:7f51\:7535\:9700\:91cf\:ff1a\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "247.24826720248555`", ",", "45.83572673771652`", ",", 
     "38.36482025076529`", ",", "38.02351291241515`", ",", 
     "13.014995282587638`", ",", "32.77478219026047`", ",", 
     "32.31377749904021`", ",", "35.88842514753956`", ",", 
     "41.461688558954584`", ",", "66.29005891252905`", ",", 
     "91.19418633623346`", ",", "84.95152851107282`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \
MW\:ff1b\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a\"\>", "\[InvisibleSpace]", 
   "0.25322938394872807`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5bb9\:91cf\:8d39\:ff08\:6309\:6700\:5927\:9700\:91cf\:ff09", 33, 
   " \:5143/kW/\:6708\:ff1b\:6bcf\:6708\:6700\:5927\:7f51\:7535\:9700\:91cf\
\:ff1a", {247.24826720248555`, 45.83572673771652, 38.36482025076529, 
   38.02351291241515, 13.014995282587638`, 32.77478219026047, 
   32.31377749904021, 35.88842514753956, 41.461688558954584`, 
   66.29005891252905, 91.19418633623346, 84.95152851107282}, 
   " MW\:ff1b\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a", 0.25322938394872807`, 
   " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377823041*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"abca2a25-b7f1-48b0-afeb-\
dae22447b59f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:53ef\:518d\:751f\:80fd\:6e90\:53d1\:7535\:5de5\:6bb5:\"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm["\:53ef\:518d\:751f\:80fd\:6e90\:53d1\:7535\:5de5\:6bb5:", 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377824998*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"aeb9b599-7c1d-4293-8df4-\
4161eb9020da"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\
\:ff09\:ff1a\"\>", "\[InvisibleSpace]", "5.634853090958543`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\:ff09\:ff1a", 
   5.634853090958543, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778280168`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"435d5f41-f073-4bc2-9f05-\
199635d8162b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:8fd0\:884c\:6536\:76ca\:ff1a\"\>", "\[InvisibleSpace]", 
   "5.666788084499672`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:8fd0\:884c\:6536\:76ca\:ff1a", 5.666788084499672, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377829983*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7699110f-db67-4b24-a3d5-\
7dbbcc034909"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:51c0\:6536\:76ca\:ff1a \"\>", "\[InvisibleSpace]", 
   "0.031934993541128644`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.005667404815286103`"}],
  SequenceForm[
  "\:51c0\:6536\:76ca\:ff1a ", 0.031934993541128644`, 
   " \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a", 0.005667404815286103],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377831978*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"14c5d18a-908e-4f86-9ab4-\
cd69cb5fad48"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5185\:90e8\:4f9b\:7535\:4ef7\:ff1a\"\>", "\[InvisibleSpace]",
    "0.207600000000001`", 
   "\[InvisibleSpace]", "\<\" \:5143/\:5ea6\:ff0c\:5185\:90e8\:4f9b\:7535\
\:91cf\:ff1a \"\>", "\[InvisibleSpace]", "30.16908138157262`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5185\:90e8\:4f9b\:7535\:6536\:76ca\:ff1a \"\>", 
   "\[InvisibleSpace]", "6.263101294814507`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5185\:90e8\:4f9b\:7535\:4ef7\:ff1a", 0.207600000000001, 
   " \:5143/\:5ea6\:ff0c\:5185\:90e8\:4f9b\:7535\:91cf\:ff1a ", 
   30.16908138157262, 
   " \:4ebf\:5ea6\:ff0c\:5185\:90e8\:4f9b\:7535\:6536\:76ca\:ff1a ", 
   6.263101294814507, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377833973*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"1b05a8fd-e465-4513-83b9-\
2d85c59e0190"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:65b0\:80fd\:6e90\:4e0a\:7f51\:7535\:4ef7\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" \:5143/\:5ea6\:ff0c\:4e0a\:7f51\:7535\:91cf\
\:ff1a\"\>", "\[InvisibleSpace]", "1.313803918338841`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:4e0a\:7f51\:6536\:76ca\:ff1a \"\>", "\[InvisibleSpace]", 
   "0.`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:65b0\:80fd\:6e90\:4e0a\:7f51\:7535\:4ef7\:ff1a", 0., 
   " \:5143/\:5ea6\:ff0c\:4e0a\:7f51\:7535\:91cf\:ff1a", 1.313803918338841, 
   " \:4ebf\:5ea6\:ff0c\:4e0a\:7f51\:6536\:76ca\:ff1a ", 0., " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778359675`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"ff2f5e61-03c8-4ea2-9b81-\
178901b88f31"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5236\:6c22+\:50a8\:6c22\:5de5\:6bb5:\"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm["\:5236\:6c22+\:50a8\:6c22\:5de5\:6bb5:", 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377837961*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"090bb8a3-c06a-4286-b2de-\
40617a334872"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\
\:ff09\:ff1a\"\>", "\[InvisibleSpace]", "1.4065268931745574`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\:ff09\:ff1a", 
   1.4065268931745574`, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377840953*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"5b8342fc-7f32-4afe-b94c-\
3b9550b84ad0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:8fd0\:884c\:6536\:76ca\:ff1a\"\>", "\[InvisibleSpace]", 
   "1.4169026099511643`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:8fd0\:884c\:6536\:76ca\:ff1a", 1.4169026099511643`, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778419504`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"545c4b42-795a-485b-8431-\
4286e7a3310b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:51c0\:6536\:76ca\:ff1a \"\>", "\[InvisibleSpace]", 
   "0.010375716776606715`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.007376834973533031`"}],
  SequenceForm[
  "\:51c0\:6536\:76ca\:ff1a ", 0.010375716776606715`, 
   " \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a", 0.007376834973533031],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377866884*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"4fb09131-176c-4d36-b855-\
2ec6bd51c0a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5bb9\:91cf\:8d39\:5206\:914d\:7cfb\:6570\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" \
\:5bf9\:5e94\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a\"\>", "\[InvisibleSpace]", 
   "0.`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5bb9\:91cf\:8d39\:5206\:914d\:7cfb\:6570\:ff1a", 0., 
   " \:5bf9\:5e94\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a", 0., " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.84959437786988*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"b59fd521-0239-4e78-94d0-\
c495c6f5d1b8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5236\:6c22\:5185\:90e8\:7528\:7535\:4ef7\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.207600000000001`", 
   "\[InvisibleSpace]", "\<\" \:5143/\:5ea6\:ff0c\:5236\:6c22\:5185\:90e8\
\:7528\:7535\:91cf\:ff1a\"\>", "\[InvisibleSpace]", "28.491334738755416`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5185\:90e8\:7528\:7535\:5236\:6c22\:6210\:672c\:ff1a \
\"\>", "\[InvisibleSpace]", "5.914801091765652`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5236\:6c22\:5185\:90e8\:7528\:7535\:4ef7\:ff1a", 0.207600000000001, 
   " \:5143/\:5ea6\:ff0c\:5236\:6c22\:5185\:90e8\:7528\:7535\:91cf\:ff1a", 
   28.491334738755416`, 
   " \:4ebf\:5ea6\:ff0c\:5185\:90e8\:7528\:7535\:5236\:6c22\:6210\:672c\:ff1a \
", 5.914801091765652, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377871871*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"f5767e8c-498e-455f-b306-\
006872d1407c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5236\:6c22\:5916\:8d2d\:7535\:4ef7\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.35000000000000003`", 
   "\[InvisibleSpace]", "\<\" \:5143/\:5ea6\:ff0c\:5236\:6c22\:5916\:8d2d\
\:7528\:7535\:91cf\:ff1a\"\>", "\[InvisibleSpace]", "1.1557240847769614`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5916\:8d2d\:7f51\:7535\:5236\:6c22\:6210\:672c\:ff1a \
\"\>", "\[InvisibleSpace]", "0.40450342967193664`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5236\:6c22\:5916\:8d2d\:7535\:4ef7\:ff1a", 0.35000000000000003`, 
   " \:5143/\:5ea6\:ff0c\:5236\:6c22\:5916\:8d2d\:7528\:7535\:91cf\:ff1a", 
   1.1557240847769614`, 
   " \:4ebf\:5ea6\:ff0c\:5916\:8d2d\:7f51\:7535\:5236\:6c22\:6210\:672c\:ff1a \
", 0.40450342967193664`, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377873865*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"d23bf0f9-b2ed-4873-9fc4-\
62e31134bda8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6c34\:4ef7\:ff1a\"\>", "\[InvisibleSpace]", "9.`", 
   "\[InvisibleSpace]", "\<\" \
\:5143/\:5428\:ff0c\:5236\:6c22\:91cf\:ff1a\"\>", "\[InvisibleSpace]", 
   "52941.176470593375`", 
   "\[InvisibleSpace]", "\<\" \:5428\:ff0c\:8865\:6c34\:7cfb\:6570\:ff1a \
\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\" ; \:5236\:6c22\:8865\:6c34\:8d39\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.047647058823534046`", 
   "\[InvisibleSpace]", "\<\"\:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6c34\:4ef7\:ff1a", 9., " \:5143/\:5428\:ff0c\:5236\:6c22\:91cf\:ff1a", 
   52941.176470593375`, " \:5428\:ff0c\:8865\:6c34\:7cfb\:6570\:ff1a ", 10, 
   " ; \:5236\:6c22\:8865\:6c34\:8d39\:ff1a", 0.047647058823534046`, 
   "\:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.84959437787586*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"f58ad7d5-c94d-4fd4-98fc-\
92cfac629d15"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6c22\:4ef7\:ff1a\"\>", "\[InvisibleSpace]", 
   "1.3736070355674699`", 
   "\[InvisibleSpace]", \
"\<\"\:5143/\:6807\:65b9\:ff0c\:6c22\:6c14\:5e74\:4ea7\:91cf\:ff1a\"\>", 
   "\[InvisibleSpace]", "5.929411764706464`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:6807\:65b9\:ff0c\:7ed9\:5408\:6210\:6c28\:5382\:4f9b\:6c22\:6536\:5165\
\:ff1a \"\>", "\[InvisibleSpace]", "8.144681716777326`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6c22\:4ef7\:ff1a", 1.3736070355674699`, 
   "\:5143/\:6807\:65b9\:ff0c\:6c22\:6c14\:5e74\:4ea7\:91cf\:ff1a", 
   5.929411764706464, 
   " \:4ebf\:6807\:65b9\:ff0c\:7ed9\:5408\:6210\:6c28\:5382\:4f9b\:6c22\:6536\
\:5165\:ff1a ", 8.144681716777326, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377877855*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"0caf98a8-aafa-429d-8e80-\
d0af1a1f7bf1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5408\:6210\:6c28\:5de5\:6bb5:\"\>", "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm["\:5408\:6210\:6c28\:5de5\:6bb5:", 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778798494`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"6171a8c4-596f-4824-b47b-\
cd929c02087b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\
\:ff09\:ff1a\"\>", "\[InvisibleSpace]", "0.43592278488425695`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6295\:8d44\:6210\:672c\:ff08\:6298\:7b97\:5230\:9996\:5e74\:ff09\:ff1a", 
   0.43592278488425695`, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778838396`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"d9ba9236-d8a7-4dea-9e97-\
56d9a7861f77"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:8fd0\:884c\:6536\:76ca\:ff1a\"\>", "\[InvisibleSpace]", 
   "0.43913851532965004`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:8fd0\:884c\:6536\:76ca\:ff1a", 0.43913851532965004`, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778858643`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"576ae9a6-2de3-40cc-9bf9-\
dbb6d71b359f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:51c0\:6536\:76ca\:ff1a \"\>", "\[InvisibleSpace]", 
   "0.0032157304453930466`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.007376834973533031`"}],
  SequenceForm[
  "\:51c0\:6536\:76ca\:ff1a ", 0.0032157304453930466`, 
   " \:4ebf\:5143, \:6536\:76ca\:7387\:ff1a", 0.007376834973533031],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778868628`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"cc6ce0e1-874e-4e03-ab15-\
938bad4d1e62"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5bb9\:91cf\:8d39\:5206\:914d\:7cfb\:6570\:ff1a\"\>", 
   "\[InvisibleSpace]", "1.`", 
   "\[InvisibleSpace]", "\<\" \
\:5bf9\:5e94\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a\"\>", "\[InvisibleSpace]", 
   "0.25322938394872807`", "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5bb9\:91cf\:8d39\:5206\:914d\:7cfb\:6570\:ff1a", 1., 
   " \:5bf9\:5e94\:5e74\:603b\:5bb9\:91cf\:8d39\:ff1a", 0.25322938394872807`, 
   " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377888856*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"759469bc-1675-4ab9-a055-\
c8759e8af557"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5236\:6c28\:5185\:90e8\:7528\:7535\:4ef7\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.207600000000001`", 
   "\[InvisibleSpace]", "\<\" \:5143/\:5ea6\:ff0c\:5236\:6c28\:5185\:90e8\
\:7528\:7535\:91cf\:ff1a\"\>", "\[InvisibleSpace]", "1.6777466428173429`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5185\:90e8\:7528\:7535\:5236\:6c28\:6210\:672c\:ff1a \
\"\>", "\[InvisibleSpace]", "0.348300203048882`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5236\:6c28\:5185\:90e8\:7528\:7535\:4ef7\:ff1a", 0.207600000000001, 
   " \:5143/\:5ea6\:ff0c\:5236\:6c28\:5185\:90e8\:7528\:7535\:91cf\:ff1a", 
   1.6777466428173429`, 
   " \:4ebf\:5ea6\:ff0c\:5185\:90e8\:7528\:7535\:5236\:6c28\:6210\:672c\:ff1a \
", 0.348300203048882, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778908205`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"85fa9e16-f4ab-45ea-b5e9-\
00f5477afe8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5236\:6c28\:5916\:8d2d\:7535\:4ef7\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.35000000000000003`", 
   "\[InvisibleSpace]", "\<\" \:5143/\:5ea6\:ff0c\:5236\:6c28\:5916\:8d2d\
\:7528\:7535\:91cf\:ff1a\"\>", "\[InvisibleSpace]", "0.23757194541814225`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5916\:8d2d\:7f51\:7535\:5236\:6c28\:6210\:672c\:ff1a \
\"\>", "\[InvisibleSpace]", "0.08315018089634994`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:5236\:6c28\:5916\:8d2d\:7535\:4ef7\:ff1a", 0.35000000000000003`, 
   " \:5143/\:5ea6\:ff0c\:5236\:6c28\:5916\:8d2d\:7528\:7535\:91cf\:ff1a", 
   0.23757194541814225`, 
   " \:4ebf\:5ea6\:ff0c\:5916\:8d2d\:7f51\:7535\:5236\:6c28\:6210\:672c\:ff1a \
", 0.08315018089634994, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778928146`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7a80c17a-a1d5-49e4-b2b1-\
b4da23281658"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6c22\:4ef7\:ff1a\"\>", "\[InvisibleSpace]", 
   "1.3736070355674699`", 
   "\[InvisibleSpace]", \
"\<\"\:5143/\:6807\:65b9\:ff0c\:6c22\:6c14\:5e74\:4ea7\:91cf\:ff1a\"\>", 
   "\[InvisibleSpace]", "5.929411764706458`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:6807\:65b9\:ff0c\:5408\:6210\:6c28\:5382\:8d2d\:6c22\:6210\:672c\:ff1a\
 \"\>", "\[InvisibleSpace]", "8.144681716777317`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6c22\:4ef7\:ff1a", 1.3736070355674699`, 
   "\:5143/\:6807\:65b9\:ff0c\:6c22\:6c14\:5e74\:4ea7\:91cf\:ff1a", 
   5.929411764706458, 
   " \:4ebf\:6807\:65b9\:ff0c\:5408\:6210\:6c28\:5382\:8d2d\:6c22\:6210\:672c\
\:ff1a ", 8.144681716777317, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943778948092`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"f8fec0e9-630d-462e-9304-\
6cc69378f2c6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6c34\:4ef7\:ff1a\"\>", "\[InvisibleSpace]", "9.`", 
   "\[InvisibleSpace]", "\<\" \
\:5143/\:5428\:ff0c\:5236\:6c28\:91cf\:ff1a\"\>", "\[InvisibleSpace]", 
   "300000.0000000291`", 
   "\[InvisibleSpace]", "\<\" \:5428\:ff0c\:8865\:6c34\:7cfb\:6570\:ff1a \
\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" ; \:5236\:6c28\:8865\:6c34\:8d39\:ff1a\"\>", 
   "\[InvisibleSpace]", "0.05400000000000524`", 
   "\[InvisibleSpace]", "\<\"\:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6c34\:4ef7\:ff1a", 9., " \:5143/\:5428\:ff0c\:5236\:6c28\:91cf\:ff1a", 
   300000.0000000291, " \:5428\:ff0c\:8865\:6c34\:7cfb\:6570\:ff1a ", 2, 
   " ; \:5236\:6c28\:8865\:6c34\:8d39\:ff1a", 0.05400000000000524, 
   "\:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377896804*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"6c7ec75d-7d41-4f08-95dc-\
5a4733e1ca8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6c28\:4ef7\:ff1a\"\>", "\[InvisibleSpace]", "3200", 
   "\[InvisibleSpace]", \
"\<\"\:5143/\:5428\:ff0c\:6c28\:6c14\:5e74\:4ea7\:91cf\:ff1a\"\>", 
   "\[InvisibleSpace]", "300000.0000000291`", 
   "\[InvisibleSpace]", "\<\" \
\:5428\:ff0c\:51fa\:552e\:6db2\:6c28\:7684\:6536\:76ca\:ff1a \"\>", 
   "\[InvisibleSpace]", "9.60000000000093`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5143\"\>"}],
  SequenceForm[
  "\:6c28\:4ef7\:ff1a", 3200, 
   "\:5143/\:5428\:ff0c\:6c28\:6c14\:5e74\:4ea7\:91cf\:ff1a", 
   300000.0000000291, 
   " \:5428\:ff0c\:51fa\:552e\:6db2\:6c28\:7684\:6536\:76ca\:ff1a ", 
   9.60000000000093, " \:4ebf\:5143"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377897801*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"ef588bae-e27b-4178-a9f3-\
7fc3a0d826ef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:7535\:89e3\:6c60\:8d85\:8c03\:65f6\:95f4\:6bd4\:4f8b\:ff1a\"\
\>", "\[InvisibleSpace]", "0.26095890410958905`"}],
  SequenceForm[
  "\:7535\:89e3\:6c60\:8d85\:8c03\:65f6\:95f4\:6bd4\:4f8b\:ff1a", 
   0.26095890410958905`],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377899797*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"c056f63e-a86f-4ffa-9fa2-\
f4198f0f0d05"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:53d1\:7535\:4fa7\:ff1a\"\>", "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm["\:53d1\:7535\:4fa7\:ff1a", 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943779366975`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"5a7991a1-9aed-43dc-ba2c-\
18b3155860a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:65b0\:80fd\:6e90\:5e74\:603b\:53d1\:7535\:91cf\:ff1a\"\>", 
   "\[InvisibleSpace]", "31.482885299911466`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5ea6\:ff0c \:5176\:4e2d\:98ce\:7535\
\:ff1a \"\>", "\[InvisibleSpace]", "27.012345095487603`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5149\:4f0f\:53d1\:7535\:ff1a\"\>", "\[InvisibleSpace]", 
   "4.470540204423873`", 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:3002\:5e74\:603b\:5f03\:7535\:91cf\:ff1a \"\>", 
   "\[InvisibleSpace]", "1.313803918338841`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5ea6\:ff0c\:5f03\:7535\:7387\:ff1a \
\"\>", "\[InvisibleSpace]", "0.04173073420124348`"}],
  SequenceForm[
  "\:65b0\:80fd\:6e90\:5e74\:603b\:53d1\:7535\:91cf\:ff1a", 
   31.482885299911466`, " \:4ebf\:5ea6\:ff0c \:5176\:4e2d\:98ce\:7535\:ff1a ",
    27.012345095487603`, " \:4ebf\:5ea6\:ff0c\:5149\:4f0f\:53d1\:7535\:ff1a", 
   4.470540204423873, 
   " \:4ebf\:5ea6\:3002\:5e74\:603b\:5f03\:7535\:91cf\:ff1a ", 
   1.313803918338841, " \:4ebf\:5ea6\:ff0c\:5f03\:7535\:7387\:ff1a ", 
   0.04173073420124348],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943779406877`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"74d05caf-a667-434a-ad9c-\
22d64a8930b1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:98ce\:7535\:672c\:5730\:6d88\:7eb3\:ff1a\"\>", 
   "\[InvisibleSpace]", "25.698541177148755`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5ea6(\:7531\:98ce\:7535\:627f\:62c5\
\:5f03\:7535\:4efb\:52a1)\:ff1b\:5149\:4f0f\:672c\:5730\:6d88\:7eb3\:ff1a\"\>\
", "\[InvisibleSpace]", "4.470540204423873`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5ea6\:3002\"\>"}],
  SequenceForm[
  "\:98ce\:7535\:672c\:5730\:6d88\:7eb3\:ff1a", 25.698541177148755`, 
   " \:4ebf\:5ea6(\:7531\:98ce\:7535\:627f\:62c5\:5f03\:7535\:4efb\:52a1)\
\:ff1b\:5149\:4f0f\:672c\:5730\:6d88\:7eb3\:ff1a", 4.470540204423873, 
   " \:4ebf\:5ea6\:3002"],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943779426823`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"c288d6df-919d-4435-a4ba-\
9b0cb35f8d84"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:8d1f\:8377\:4fa7\:ff1a\"\>", "\[InvisibleSpace]", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False]}],
  SequenceForm["\:8d1f\:8377\:4fa7\:ff1a", 
   RGBColor[1, 0, 0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377944677*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"39bec923-621f-4dcb-ad9c-\
c0d0402607f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:8d1f\:8377\:4fa7\:5e74\:603b\:7528\:7535\:91cf\:ff1a\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
   "31.5623774117678`", 
    " ", "\<\" \:4ebf\:5ea6\:ff0c\:5176\:4e2d\:65b0\:80fd\:6e90\:4f9b\:7535\
\:ff1a \"\>"}], "\[InvisibleSpace]", "30.16908138157262`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5ea6\:ff0c\:5360\:6bd4\:ff1a \"\>", 
   "\[InvisibleSpace]", "0.9558557959047883`", 
   "\[InvisibleSpace]", "\<\"; \:4e0b\:7f51\:7535\:91cf\:ff1a\"\>", 
   "\[InvisibleSpace]", "1.3932960301951047`", 
   "\[InvisibleSpace]", "\<\" \:4ebf\:5ea6\:ff0c\:5360\:6bd4\:ff1a \"\>", 
   "\[InvisibleSpace]", "0.044144204095209395`"}],
  SequenceForm[
  "\:8d1f\:8377\:4fa7\:5e74\:603b\:7528\:7535\:91cf\:ff1a", 31.5623774117678 
   " \:4ebf\:5ea6\:ff0c\:5176\:4e2d\:65b0\:80fd\:6e90\:4f9b\:7535\:ff1a ", 
   30.16908138157262, " \:4ebf\:5ea6\:ff0c\:5360\:6bd4\:ff1a ", 
   0.9558557959047883, "; \:4e0b\:7f51\:7535\:91cf\:ff1a", 
   1.3932960301951047`, " \:4ebf\:5ea6\:ff0c\:5360\:6bd4\:ff1a ", 
   0.044144204095209395`],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377947669*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"13db1ce2-d45d-4182-bee8-\
a80d9effe49d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5cf0\:8c37\:5e73\:65f6\:6bb5\:4e0a\:7f51\:7535\:91cf\:ff1a\"\
\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.466531318964672`", ",", "0.15502179156941007`", ",", 
     "0.6922508078047589`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5360\:5168\:5e74\:53d1\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a\
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.014818569343959842`", ",", "0.004924002044051725`", ",", 
     "0.02198816281323191`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \
\:5360\:4e0a\:7f51\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.3550996556278725`", ",", "0.11799461807468034`", ",", 
     "0.526905726297447`"}], "}"}]}],
  SequenceForm[
  "\:5cf0\:8c37\:5e73\:65f6\:6bb5\:4e0a\:7f51\:7535\:91cf\:ff1a", {
   0.466531318964672, 0.15502179156941007`, 0.6922508078047589}, 
   " \:4ebf\:5ea6\:ff0c\:5360\:5168\:5e74\:53d1\:7535\:91cf\:7684\:6bd4\:4f8b\
\:ff1a", {0.014818569343959842`, 0.004924002044051725, 0.02198816281323191}, 
   " \:5360\:4e0a\:7f51\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a", {
   0.3550996556278725, 0.11799461807468034`, 0.526905726297447}],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.849594377972602*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"7d36a8f0-5db4-4532-b4af-\
b086070eb476"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:5cf0\:8c37\:5e73\:65f6\:6bb5\:4e0b\:7f51\:7535\:91cf\:ff1a\"\
\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.4781731188953749`", ",", "0.502197622155473`", ",", 
     "0.4129252891442568`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \
\:4ebf\:5ea6\:ff0c\:5360\:5168\:5e74\:53d1\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a\
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.015188351205431593`", ",", "0.015951448457517496`", ",", 
     "0.013115865499958418`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \
\:5360\:4e0b\:7f51\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.3431956372031117`", ",", "0.3604385652955243`", ",", 
     "0.29636579750136405`"}], "}"}]}],
  SequenceForm[
  "\:5cf0\:8c37\:5e73\:65f6\:6bb5\:4e0b\:7f51\:7535\:91cf\:ff1a", {
   0.4781731188953749, 0.502197622155473, 0.4129252891442568}, 
   " \:4ebf\:5ea6\:ff0c\:5360\:5168\:5e74\:53d1\:7535\:91cf\:7684\:6bd4\:4f8b\
\:ff1a", {0.015188351205431593`, 0.015951448457517496`, 
   0.013115865499958418`}, 
   " \:5360\:4e0b\:7f51\:7535\:91cf\:7684\:6bd4\:4f8b\:ff1a", {
   0.3431956372031117, 0.3604385652955243, 0.29636579750136405`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.848471864611577*^9, 3.848471970152467*^9, 
  3.8484720714177322`*^9, 3.8484723673704605`*^9, 3.8484725175730715`*^9, 
  3.848472751485129*^9, 3.8495920244546785`*^9, 3.849593190080228*^9, 
  3.8495936662479706`*^9, 3.8495943779775887`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[53]:=",ExpressionUUID->"23bad553-38e7-48b6-8abc-\
9cd339b06ea1"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"using", " ", "matlab"}], "&"}], "gurobi", " ", "in", " ", 
    "stage1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Export", " ", "matrix", " ", "of", " ", "opt", " ", "problem"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"varsAll", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"varsDisp", ",", "boolsDisp", ",", "varsInteger"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsLen", "=", 
     RowBox[{"varsDisp", "//", "Length"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boolsLen", "=", 
     RowBox[{"boolsDisp", "//", "Length"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegerLen", "=", 
     RowBox[{"varsInteger", "//", "Length"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hLen", "=", 
     RowBox[{"hFuncDisp", "//", "Length"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gLen", "=", 
     RowBox[{"gFuncDisp", "//", "Length"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"{", 
      RowBox[{
      "varsLen", ",", "boolsLen", ",", "IntegerLen", ",", "hLen", ",", 
       "gLen"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ntemp", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Dynamic", "[", 
      RowBox[{"\"\<jtr: \>\"", "<>", 
       RowBox[{"ToString", "[", "jtr", "]"}]}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hJacob", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jtr", "=", "1"}], ",", 
       RowBox[{"jtr", "<=", 
        RowBox[{"Floor", "[", 
         RowBox[{"hLen", "/", "Ntemp"}], "]"}]}], ",", 
       RowBox[{"jtr", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hFuncDisp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"Ntemp", 
                 RowBox[{"(", 
                  RowBox[{"jtr", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"Ntemp", " ", "jtr"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", "varsAll", "}"}]}], "]"}], "//", "SparseArray"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"hJacob", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"hJacob", ",", "temp"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"hLen", ">", 
        RowBox[{"Ntemp", " ", 
         RowBox[{"Floor", "[", 
          RowBox[{"hLen", "/", "Ntemp"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hFuncDisp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"Ntemp", " ", 
                 RowBox[{"Floor", "[", 
                  RowBox[{"hLen", "/", "Ntemp"}], "]"}]}], "+", "1"}], ";;", 
               "hLen"}], "]"}], "]"}], ",", 
            RowBox[{"{", "varsAll", "}"}]}], "]"}], "//", "SparseArray"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"hJacob", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"hJacob", ",", "temp"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gJacob", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jtr", "=", "1"}], ",", 
       RowBox[{"jtr", "<=", 
        RowBox[{"Floor", "[", 
         RowBox[{"gLen", "/", "Ntemp"}], "]"}]}], ",", 
       RowBox[{"jtr", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gFuncDisp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"Ntemp", 
                 RowBox[{"(", 
                  RowBox[{"jtr", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"Ntemp", " ", "jtr"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", "varsAll", "}"}]}], "]"}], "//", "SparseArray"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"gJacob", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"gJacob", ",", "temp"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"gLen", ">", 
        RowBox[{"Ntemp", " ", 
         RowBox[{"Floor", "[", 
          RowBox[{"gLen", "/", "Ntemp"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gFuncDisp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"Ntemp", " ", 
                 RowBox[{"Floor", "[", 
                  RowBox[{"gLen", "/", "Ntemp"}], "]"}]}], "+", "1"}], ";;", 
               "gLen"}], "]"}], "]"}], ",", 
            RowBox[{"{", "varsAll", "}"}]}], "]"}], "//", "SparseArray"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"gJacob", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"gJacob", ",", "temp"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fJacob", "=", 
     RowBox[{"D", "[", 
      RowBox[{"fFuncDispSingle", ",", 
       RowBox[{"{", "varsAll", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hRhs", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"hFuncDisp", "/.", 
        RowBox[{"Dispatch", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{"varsAll", "->", "0"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gRhs", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"gFuncDisp", "/.", 
        RowBox[{"Dispatch", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{"varsAll", "->", "0"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matObj", "=", "fJacob"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matCons", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"hJacob", ",", "gJacob"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhsCons", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"hRhs", ",", "gRhs"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{"\"\<auxInfo.mat\>\"", ",", "aux"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<matObj.mat\>\"", ",", "matObj"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<matCons.mat\>\"", ",", "matCons"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<rhsCons.mat\>\"", ",", 
        RowBox[{"rhsCons", "//", "SparseArray"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.849587358784048*^9, 3.849587441181883*^9}, {
  3.8495893013587456`*^9, 
  3.8495893020914245`*^9}},ExpressionUUID->"9190ed02-8ca2-4bff-94ac-\
50ed2cdff7df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"time", " ", "of", " ", "use", " ", "electricity", " ", "price"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "GanSu", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pricePeak", "=", 
     RowBox[{"0.8650", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"priceValley", "=", 
     RowBox[{"0.3036", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"priceFlat", "=", 
     RowBox[{"0.5843", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TOUHday", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"priceFlat", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceValley", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceFlat", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"pricePeak", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceFlat", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceValley", ",", 
         RowBox[{"{", "6", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceFlat", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"pricePeak", ",", 
         RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Xinjiang", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pricePurchGVal", "=", 
     RowBox[{"0.35", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pricePeak", "=", 
     RowBox[{"0.5505", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"priceValley", "=", 
     RowBox[{"0.1215", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"priceFlat", "=", 
     RowBox[{"0.3360", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TOUHday", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"priceValley", ",", 
         RowBox[{"{", "8", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceFlat", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"pricePeak", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"priceFlat", ",", 
         RowBox[{"{", "6", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"pricePeak", ",", 
         RowBox[{"{", "5", "}"}]}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8495880720746846`*^9, 3.8495881178504686`*^9}, {
   3.849588148021856*^9, 3.849588148208125*^9}, {3.8495891556541433`*^9, 
   3.849589183353237*^9}, 
   3.849589238507597*^9},ExpressionUUID->"7190b57a-6fc0-4230-9e95-\
45a0e6de18d1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cRuleEPIMin", "=", 
   RowBox[{
    RowBox[{"LinearOptimization", "[", 
     RowBox[{"priceInner", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hFunc", "==", "0"}], ",", 
        RowBox[{"gFunc", "\[VectorLessEqual]", "0"}]}], "}"}], ",", "varsDef",
       ",", 
      RowBox[{"Method", "->", "\"\<Gurobi\>\""}]}], "]"}], "//", 
    "Dispatch"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cRuleEPIMax", "=", 
   RowBox[{
    RowBox[{"LinearOptimization", "[", 
     RowBox[{
      RowBox[{"-", "priceInner"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hFunc", "==", "0"}], ",", 
        RowBox[{"gFunc", "\[VectorLessEqual]", "0"}]}], "}"}], ",", "varsDef",
       ",", 
      RowBox[{"Method", "->", "\"\<Gurobi\>\""}]}], "]"}], "//", 
    "Dispatch"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cRulePH2IMin", "=", 
   RowBox[{
    RowBox[{"LinearOptimization", "[", 
     RowBox[{"priceH2Inner", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hFunc", "==", "0"}], ",", 
        RowBox[{"gFunc", "\[VectorLessEqual]", "0"}]}], "}"}], ",", "varsDef",
       ",", 
      RowBox[{"Method", "->", "\"\<Gurobi\>\""}]}], "]"}], "//", 
    "Dispatch"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cRulePH2IMax", "=", 
   RowBox[{
    RowBox[{"LinearOptimization", "[", 
     RowBox[{
      RowBox[{"-", "priceH2Inner"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hFunc", "==", "0"}], ",", 
        RowBox[{"gFunc", "\[VectorLessEqual]", "0"}]}], "}"}], ",", "varsDef",
       ",", 
      RowBox[{"Method", "->", "\"\<Gurobi\>\""}]}], "]"}], "//", 
    "Dispatch"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Min-Max Value of electricity price is: \>\"", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"priceInner", "/.", "cRuleEPIMin"}], ",", 
       RowBox[{"priceInner", "/.", "cRuleEPIMax"}]}], "}"}], "/", "1000"}], 
    ",", "\"\< \:ffe5/kWh\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Min-Max Value of hydrogen price is: \>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"priceH2Inner", "/.", "cRulePH2IMin"}], ",", 
      RowBox[{"priceH2Inner", "/.", "cRulePH2IMax"}]}], "}"}], ",", 
    "\"\< \:ffe5/Nm3\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8470661296547327`*^9, 3.8470661296557035`*^9}},
 FontFamily->"Consolas",
 CellLabel->
  "In[129]:=",ExpressionUUID->"a28d93a6-05d3-4770-a05a-276cd5cf622d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Min-Max Value of electricity price is: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.11400000000000003`", ",", "0.28579999999999994`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \:ffe5/kWh\"\>"}],
  SequenceForm[
  "Min-Max Value of electricity price is: ", {0.11400000000000003`, 
   0.28579999999999994`}, " \:ffe5/kWh"],
  Editable->False]], "Print",
 CellChangeTimes->{3.847077287480119*^9, 3.847083887160737*^9, 
  3.847264660455496*^9, 3.847273983365811*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[129]:=",ExpressionUUID->"33e80c4f-3b2a-43da-\
b6b9-1802d395536d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Min-Max Value of hydrogen price is: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1.1081788244278397`", ",", "1.4844699981904306`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \:ffe5/Nm3\"\>"}],
  SequenceForm[
  "Min-Max Value of hydrogen price is: ", {1.1081788244278397`, 
   1.4844699981904306`}, " \:ffe5/Nm3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.847077287480119*^9, 3.847083887160737*^9, 
  3.847264660455496*^9, 3.847273983367804*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[129]:=",ExpressionUUID->"aa07042b-359c-4574-\
a504-8864b7d1864b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<LCOE of Renewable Energy Generation is: \>\"", ",", 
    RowBox[{"10", 
     RowBox[{"InvestRen", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"periodDispatchIn", "/", "3600"}], " ", "ERenFinal"}], 
       ")"}]}]}], ",", "\"\< \:ffe5/kWh\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<LCOH of AEHS is: \>\"", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"10", "^", "4"}], "InvestAEHS"}], "+", 
       RowBox[{
        RowBox[{"10", "^", "8"}], 
        RowBox[{"(", 
         RowBox[{"CostH2Inner", "+", "CostH2Purch"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"periodDispatchIn", "/", "3600"}], " ", 
       RowBox[{"Total", "[", "qH2InDispValAll", "]"}]}], ")"}]}], ",", 
    "\"\< \:ffe5/Nm3\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<LCOA of SA is: \>\"", ",", 
    RowBox[{
     RowBox[{"10", "^", "4"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"InvestSA", "+", 
        RowBox[{
         RowBox[{"10", "^", "4"}], 
         RowBox[{"(", 
          RowBox[{"CostNH3Inner", "+", "CostNH3Purch", "+", "costH2"}], 
          ")"}]}]}], ")"}], "/", "mNH3Max"}]}], ",", "\"\< \:ffe5/t\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8470661486706767`*^9, 3.8470661486716757`*^9}, {
  3.8470663540885305`*^9, 3.847066361533331*^9}, {3.847066544302807*^9, 
  3.847066557110699*^9}, {3.8515050917292233`*^9, 3.8515050953940096`*^9}, {
  3.851505138703328*^9, 3.8515051390775275`*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"66b76026-111b-46fe-ac13-4eb6b5d4765c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOCE of Renewable Energy Generation is: \"\>", 
   "\[InvisibleSpace]", "0.18301618852983687`", 
   "\[InvisibleSpace]", "\<\" \:ffe5/kWh\"\>"}],
  SequenceForm[
  "LOCE of Renewable Energy Generation is: ", 0.18301618852983687`, 
   " \:ffe5/kWh"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8470839043240023`*^9, 3.8472739874158764`*^9, 
  3.8473484059526567`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[550]:=",ExpressionUUID->"b55d3837-aa2c-4b45-\
a857-91bbb6f5851f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOCH of AEHS is: \"\>", "\[InvisibleSpace]", 
   "1.4067714868629486`", "\[InvisibleSpace]", "\<\" \:ffe5/Nm3\"\>"}],
  SequenceForm["LOCH of AEHS is: ", 1.4067714868629486`, " \:ffe5/Nm3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8470839043240023`*^9, 3.8472739874158764`*^9, 
  3.847348405970628*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[550]:=",ExpressionUUID->"fba24467-8d96-4327-\
b87d-e6dfc219986f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOCA of SA is: \"\>", "\[InvisibleSpace]", 
   "3161.006179086638`", "\[InvisibleSpace]", "\<\" \:ffe5/t\"\>"}],
  SequenceForm["LOCA of SA is: ", 3161.006179086638, " \:ffe5/t"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8470839043240023`*^9, 3.8472739874158764`*^9, 
  3.8473484059955063`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[550]:=",ExpressionUUID->"8ea96b67-dfc8-4ade-\
ba3f-5b495c523532"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (2021\:5e747\:670823\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f4bd0493-292b-4783-9e7b-b74e6043bc74"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2433, 59, 486, "Input",ExpressionUUID->"a0609b4a-ef88-470a-b985-c9e50793f85a"],
Cell[2994, 81, 226057, 5047, 24105, "Input",ExpressionUUID->"508f5722-e542-4934-a194-c98641109d0a"],
Cell[CellGroupData[{
Cell[229076, 5132, 32546, 808, 4510, "Input",ExpressionUUID->"689b0edd-c431-4c06-8d43-137034ac9227"],
Cell[CellGroupData[{
Cell[261647, 5944, 578, 12, 24, "Print",ExpressionUUID->"f30dd8bd-f20b-466d-88af-8d0edda9b2da"],
Cell[262228, 5958, 28279, 760, 152, "Print",ExpressionUUID->"a567bfa4-392d-42c8-bbb1-e591982a9f66"],
Cell[290510, 6720, 28789, 766, 167, "Print",ExpressionUUID->"fd67f569-d32f-40f5-928b-b65dd49b61cf"],
Cell[319302, 7488, 681, 14, 24, "Print",ExpressionUUID->"7c567b60-2df5-42d2-bc6a-1bda2f4f5629"],
Cell[319986, 7504, 702, 15, 24, "Print",ExpressionUUID->"d4c86458-f520-43b0-84a7-42befbff2b64"],
Cell[320691, 7521, 632, 13, 24, "Print",ExpressionUUID->"816b6c12-1b0d-465f-9234-189a9c705e78"],
Cell[321326, 7536, 686, 14, 24, "Print",ExpressionUUID->"b22777c0-a114-41dd-b212-3a0ed05fe6db"],
Cell[322015, 7552, 435, 8, 24, "Print",ExpressionUUID->"690cfa6b-9e1c-4a4b-9183-dc2fe4545a57"],
Cell[322453, 7562, 432, 8, 24, "Print",ExpressionUUID->"e8a93fa8-e45d-4577-9b76-0f04ac920b66"],
Cell[322888, 7572, 426, 8, 24, "Print",ExpressionUUID->"e104c177-aef7-4426-b904-95b87e37d58e"],
Cell[323317, 7582, 436, 8, 24, "Print",ExpressionUUID->"2c26ce37-4595-461c-b511-b3f7ee402cc7"],
Cell[323756, 7592, 2324, 59, 24, "Print",ExpressionUUID->"8593e0fc-a096-46ea-a228-25835dcb07c5"],
Cell[326083, 7653, 691, 14, 25, "Print",ExpressionUUID->"c4053a55-0cbb-4d05-8bbd-c5877a7d537b"],
Cell[326777, 7669, 933, 19, 25, "Print",ExpressionUUID->"35cdeb11-a5d6-4c37-a105-68087f4b3408"],
Cell[327713, 7690, 819, 17, 25, "Print",ExpressionUUID->"738aa1c3-3221-4e6a-ab6f-49753517af80"],
Cell[328535, 7709, 683, 14, 24, "Print",ExpressionUUID->"9d0e8282-e3eb-4d44-9e6d-3b2f2fffa621"],
Cell[329221, 7725, 685, 14, 24, "Print",ExpressionUUID->"85b3dae2-ae10-4fc8-8d1b-fce3a7a723f9"],
Cell[329909, 7741, 678, 13, 24, "Print",ExpressionUUID->"4bfed99e-d885-4f1b-b404-5a6af821998a"],
Cell[330590, 7756, 859, 18, 25, "Print",ExpressionUUID->"3b80d349-1329-43b6-b160-20f73ba7bd68"],
Cell[331452, 7776, 640, 13, 24, "Print",ExpressionUUID->"876f68e7-ed4f-4a46-917c-86096214b95c"],
Cell[332095, 7791, 801, 17, 24, "Print",ExpressionUUID->"cbb5c44e-bb28-4889-9809-aab0d5f6df22"],
Cell[332899, 7810, 805, 17, 24, "Print",ExpressionUUID->"3aabade5-01e0-4c11-9074-42168dcaef3e"],
Cell[333707, 7829, 719, 16, 24, "Print",ExpressionUUID->"48028b9e-2570-4c66-a316-015a640d9ec3"],
Cell[334429, 7847, 428, 8, 24, "Print",ExpressionUUID->"2c29962b-83d9-4108-82ee-b85f72eb2bf4"],
Cell[334860, 7857, 433, 8, 24, "Print",ExpressionUUID->"7d332542-503c-43a5-9df3-7f127e1f1528"],
Cell[335296, 7867, 2318, 59, 24, "Print",ExpressionUUID->"0088be3b-af78-40f0-b9cd-e120e845f51d"],
Cell[337617, 7928, 701, 14, 24, "Print",ExpressionUUID->"ff39aaef-004d-4a45-a2df-02034fe52b4f"],
Cell[338321, 7944, 696, 14, 24, "Print",ExpressionUUID->"e1cd9088-ccb4-4589-9979-11381dc3d929"],
Cell[339020, 7960, 790, 18, 24, "Print",ExpressionUUID->"a4ab301a-8dba-4936-a190-8cb8b7458fc9"],
Cell[339813, 7980, 722, 16, 24, "Print",ExpressionUUID->"51105a96-3032-48ba-9a0e-a0fb50411d14"],
Cell[340538, 7998, 663, 13, 24, "Print",ExpressionUUID->"1aafa015-ecdb-4ef7-8483-a9a4fe3702f3"],
Cell[341204, 8013, 655, 13, 24, "Print",ExpressionUUID->"b650edae-62fc-4ece-8efb-a5a76958fe92"],
Cell[341862, 8028, 2309, 60, 24, "Print",ExpressionUUID->"7c295cbd-136c-452a-bcf0-52c57b1f8ebb"],
Cell[344174, 8090, 793, 16, 24, "Print",ExpressionUUID->"9a03c9d1-2286-4f43-b7bf-1f88b4ec1866"],
Cell[344970, 8108, 693, 14, 24, "Print",ExpressionUUID->"8035a1ae-caf7-492c-8c47-c140db5ddd8c"],
Cell[345666, 8124, 816, 17, 24, "Print",ExpressionUUID->"7001bbe0-271b-4112-ae32-a8636f928b1e"],
Cell[346485, 8143, 1798, 34, 63, "Print",ExpressionUUID->"abca2a25-b7f1-48b0-afeb-dae22447b59f"],
Cell[348286, 8179, 2260, 58, 24, "Print",ExpressionUUID->"aeb9b599-7c1d-4293-8df4-4161eb9020da"],
Cell[350549, 8239, 783, 16, 24, "Print",ExpressionUUID->"435d5f41-f073-4bc2-9f05-199635d8162b"],
Cell[351335, 8257, 691, 14, 24, "Print",ExpressionUUID->"7699110f-db67-4b24-a3d5-7dbbcc034909"],
Cell[352029, 8273, 820, 17, 24, "Print",ExpressionUUID->"14c5d18a-908e-4f86-9ab4-cd69cb5fad48"],
Cell[352852, 8292, 1175, 24, 24, "Print",ExpressionUUID->"1b05a8fd-e465-4513-83b9-2d85c59e0190"],
Cell[354030, 8318, 1091, 21, 24, "Print",ExpressionUUID->"ff2f5e61-03c8-4ea2-9b81-178901b88f31"],
Cell[355124, 8341, 2226, 58, 24, "Print",ExpressionUUID->"090bb8a3-c06a-4286-b2de-40617a334872"],
Cell[357353, 8401, 784, 16, 24, "Print",ExpressionUUID->"5b8342fc-7f32-4afe-b94c-3b9550b84ad0"],
Cell[358140, 8419, 696, 14, 24, "Print",ExpressionUUID->"545c4b42-795a-485b-8431-4286e7a3310b"],
Cell[358839, 8435, 820, 17, 24, "Print",ExpressionUUID->"4fb09131-176c-4d36-b855-2ec6bd51c0a3"],
Cell[359662, 8454, 877, 18, 24, "Print",ExpressionUUID->"b59fd521-0239-4e78-94d0-c495c6f5d1b8"],
Cell[360542, 8474, 1244, 24, 24, "Print",ExpressionUUID->"f5767e8c-498e-455f-b306-006872d1407c"],
Cell[361789, 8500, 1242, 24, 24, "Print",ExpressionUUID->"d23bf0f9-b2ed-4873-9fc4-62e31134bda8"],
Cell[363034, 8526, 1200, 24, 24, "Print",ExpressionUUID->"f58ad7d5-c94d-4fd4-98fc-92cfac629d15"],
Cell[364237, 8552, 1198, 25, 24, "Print",ExpressionUUID->"0caf98a8-aafa-429d-8e80-d0af1a1f7bf1"],
Cell[365438, 8579, 2210, 57, 24, "Print",ExpressionUUID->"6171a8c4-596f-4824-b47b-cd929c02087b"],
Cell[367651, 8638, 788, 16, 24, "Print",ExpressionUUID->"d9ba9236-d8a7-4dea-9e97-56d9a7861f77"],
Cell[368442, 8656, 698, 14, 24, "Print",ExpressionUUID->"576ae9a6-2de3-40cc-9bf9-dbb6d71b359f"],
Cell[369143, 8672, 824, 17, 24, "Print",ExpressionUUID->"cc6ce0e1-874e-4e03-ab15-938bad4d1e62"],
Cell[369970, 8691, 917, 19, 24, "Print",ExpressionUUID->"759469bc-1675-4ab9-a055-c8759e8af557"],
Cell[370890, 8712, 1246, 24, 24, "Print",ExpressionUUID->"85fa9e16-f4ab-45ea-b5e9-00f5477afe8b"],
Cell[372139, 8738, 1245, 24, 24, "Print",ExpressionUUID->"7a80c17a-a1d5-49e4-b2b1-b4da23281658"],
Cell[373387, 8764, 1188, 25, 24, "Print",ExpressionUUID->"f8fec0e9-630d-462e-9304-6cc69378f2c6"],
Cell[374578, 8791, 1193, 24, 24, "Print",ExpressionUUID->"6c7ec75d-7d41-4f08-95dc-5a4733e1ca8e"],
Cell[375774, 8817, 1106, 24, 24, "Print",ExpressionUUID->"ef588bae-e27b-4178-a9f3-7fc3a0d826ef"],
Cell[376883, 8843, 695, 15, 24, "Print",ExpressionUUID->"c056f63e-a86f-4ffa-9fa2-f4198f0f0d05"],
Cell[377581, 8860, 2196, 57, 24, "Print",ExpressionUUID->"5a7991a1-9aed-43dc-ba2c-18b3155860a9"],
Cell[379780, 8919, 1540, 30, 44, "Print",ExpressionUUID->"74d05caf-a667-434a-ad9c-22d64a8930b1"],
Cell[381323, 8951, 1087, 21, 24, "Print",ExpressionUUID->"c288d6df-919d-4435-a4ba-9b0cb35f8d84"],
Cell[382413, 8974, 2194, 57, 24, "Print",ExpressionUUID->"39bec923-621f-4dcb-ad9c-c0d0402607f9"],
Cell[384610, 9033, 1486, 29, 24, "Print",ExpressionUUID->"13db1ce2-d45d-4182-bee8-a80d9effe49d"],
Cell[386099, 9064, 1651, 37, 44, "Print",ExpressionUUID->"7d36a8f0-5db4-4532-b4af-b086070eb476"],
Cell[387753, 9103, 1660, 38, 44, "Print",ExpressionUUID->"23bad553-38e7-48b6-8abc-9cd339b06ea1"]
}, Open  ]]
}, Open  ]],
Cell[389440, 9145, 7901, 212, 1571, "Input",ExpressionUUID->"9190ed02-8ca2-4bff-94ac-50ed2cdff7df"],
Cell[397344, 9359, 3238, 88, 412, "Input",ExpressionUUID->"7190b57a-6fc0-4230-9e95-45a0e6de18d1"],
Cell[CellGroupData[{
Cell[400607, 9451, 2489, 71, 363, "Input",ExpressionUUID->"a28d93a6-05d3-4770-a05a-276cd5cf622d"],
Cell[CellGroupData[{
Cell[403121, 9526, 663, 16, 24, "Print",ExpressionUUID->"33e80c4f-3b2a-43da-b6b9-1802d395536d"],
Cell[403787, 9544, 649, 15, 24, "Print",ExpressionUUID->"aa07042b-359c-4574-a504-8864b7d1864b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[404485, 9565, 1708, 46, 185, "Input",ExpressionUUID->"66b76026-111b-46fe-ac13-4eb6b5d4765c"],
Cell[CellGroupData[{
Cell[406218, 9615, 557, 14, 24, "Print",ExpressionUUID->"b55d3837-aa2c-4b45-a857-91bbb6f5851f"],
Cell[406778, 9631, 496, 11, 24, "Print",ExpressionUUID->"fba24467-8d96-4327-b87d-e6dfc219986f"],
Cell[407277, 9644, 487, 11, 24, "Print",ExpressionUUID->"8ea96b67-dfc8-4ade-ba3f-5b495c523532"]
}, Open  ]]
}, Open  ]]
}
]
*)

